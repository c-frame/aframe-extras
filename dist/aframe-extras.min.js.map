{"version":3,"file":"aframe-extras.min.js","mappings":"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","sources":["webpack://aframe-extras/webpack/universalModuleDefinition","webpack://aframe-extras/./lib/ColladaLoader.js","webpack://aframe-extras/./lib/GamepadButton.js","webpack://aframe-extras/./lib/GamepadButtonEvent.js","webpack://aframe-extras/./lib/fetch-script.js","webpack://aframe-extras/./lib/keyboard.polyfill.js","webpack://aframe-extras/./node_modules/nipplejs/dist/nipplejs.js","webpack://aframe-extras/./node_modules/three-pathfinding/dist/three-pathfinding.module.js","webpack://aframe-extras/./src/controls/checkpoint-controls.js","webpack://aframe-extras/./src/controls/gamepad-controls.js","webpack://aframe-extras/./src/controls/index.js","webpack://aframe-extras/./src/controls/keyboard-controls.js","webpack://aframe-extras/./src/controls/movement-controls.js","webpack://aframe-extras/./src/controls/nipple-controls.js","webpack://aframe-extras/./src/controls/touch-controls.js","webpack://aframe-extras/./src/controls/trackpad-controls.js","webpack://aframe-extras/./src/loaders/animation-mixer.js","webpack://aframe-extras/./src/loaders/collada-model-legacy.js","webpack://aframe-extras/./node_modules/three/examples/jsm/libs/fflate.module.js","webpack://aframe-extras/./node_modules/three/examples/jsm/curves/NURBSUtils.js","webpack://aframe-extras/./node_modules/three/examples/jsm/curves/NURBSCurve.js","webpack://aframe-extras/./node_modules/three/examples/jsm/loaders/FBXLoader.js","webpack://aframe-extras/./src/loaders/fbx-model.js","webpack://aframe-extras/./src/loaders/gltf-model-legacy.js","webpack://aframe-extras/./src/loaders/index.js","webpack://aframe-extras/./src/loaders/object-model.js","webpack://aframe-extras/./src/misc/checkpoint.js","webpack://aframe-extras/./src/misc/cube-env-map.js","webpack://aframe-extras/./src/misc/grab.js","webpack://aframe-extras/./src/misc/index.js","webpack://aframe-extras/./src/misc/normal-material.js","webpack://aframe-extras/./src/misc/sphere-collider.js","webpack://aframe-extras/./src/pathfinding/index.js","webpack://aframe-extras/./src/pathfinding/nav-agent.js","webpack://aframe-extras/./src/pathfinding/nav-mesh.js","webpack://aframe-extras/./src/pathfinding/system.js","webpack://aframe-extras/./src/primitives/a-grid.js","webpack://aframe-extras/./src/primitives/a-ocean.js","webpack://aframe-extras/./src/primitives/a-tube.js","webpack://aframe-extras/./src/primitives/index.js","webpack://aframe-extras/external umd \"THREE\"","webpack://aframe-extras/webpack/bootstrap","webpack://aframe-extras/webpack/runtime/compat get default export","webpack://aframe-extras/webpack/runtime/define property getters","webpack://aframe-extras/webpack/runtime/hasOwnProperty shorthand","webpack://aframe-extras/webpack/runtime/make namespace object","webpack://aframe-extras/./index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"THREE\")) : factory(root[\"THREE\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__824__) => {\nreturn ","/**\n * @author mrdoob / http://mrdoob.com/\n * @author Mugen87 / https://github.com/Mugen87\n */\n\nmodule.exports = THREE.ColladaLoader = function ( manager ) {\n\n  this.manager = ( manager !== undefined ) ? manager : THREE.DefaultLoadingManager;\n\n};\n\nTHREE.ColladaLoader.prototype = {\n\n  constructor: THREE.ColladaLoader,\n\n  crossOrigin: 'anonymous',\n\n  load: function ( url, onLoad, onProgress, onError ) {\n\n    var scope = this;\n\n    var path = ( scope.path === undefined ) ? THREE.LoaderUtils.extractUrlBase( url ) : scope.path;\n\n    var loader = new THREE.FileLoader( scope.manager );\n    loader.setPath( scope.path );\n    loader.load( url, function ( text ) {\n\n      onLoad( scope.parse( text, path ) );\n\n    }, onProgress, onError );\n\n  },\n\n  setPath: function ( value ) {\n\n    this.path = value;\n    return this;\n\n  },\n\n  setResourcePath: function ( value ) {\n\n    this.resourcePath = value;\n    return this;\n\n  },\n\n  options: {\n\n    set convertUpAxis( value ) {\n\n      console.warn( 'THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.' );\n\n    }\n\n  },\n\n  setCrossOrigin: function ( value ) {\n\n    this.crossOrigin = value;\n    return this;\n\n  },\n\n  parse: function ( text, path ) {\n\n    function getElementsByTagName( xml, name ) {\n\n      // Non recursive xml.getElementsByTagName() ...\n\n      var array = [];\n      var childNodes = xml.childNodes;\n\n      for ( var i = 0, l = childNodes.length; i < l; i ++ ) {\n\n        var child = childNodes[ i ];\n\n        if ( child.nodeName === name ) {\n\n          array.push( child );\n\n        }\n\n      }\n\n      return array;\n\n    }\n\n    function parseStrings( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parts[ i ];\n\n      }\n\n      return array;\n\n    }\n\n    function parseFloats( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parseFloat( parts[ i ] );\n\n      }\n\n      return array;\n\n    }\n\n    function parseInts( text ) {\n\n      if ( text.length === 0 ) return [];\n\n      var parts = text.trim().split( /\\s+/ );\n      var array = new Array( parts.length );\n\n      for ( var i = 0, l = parts.length; i < l; i ++ ) {\n\n        array[ i ] = parseInt( parts[ i ] );\n\n      }\n\n      return array;\n\n    }\n\n    function parseId( text ) {\n\n      return text.substring( 1 );\n\n    }\n\n    function generateId() {\n\n      return 'three_default_' + ( count ++ );\n\n    }\n\n    function isEmpty( object ) {\n\n      return Object.keys( object ).length === 0;\n\n    }\n\n    // asset\n\n    function parseAsset( xml ) {\n\n      return {\n        unit: parseAssetUnit( getElementsByTagName( xml, 'unit' )[ 0 ] ),\n        upAxis: parseAssetUpAxis( getElementsByTagName( xml, 'up_axis' )[ 0 ] )\n      };\n\n    }\n\n    function parseAssetUnit( xml ) {\n\n      if ( ( xml !== undefined ) && ( xml.hasAttribute( 'meter' ) === true ) ) {\n\n        return parseFloat( xml.getAttribute( 'meter' ) );\n\n      } else {\n\n        return 1; // default 1 meter\n\n      }\n\n    }\n\n    function parseAssetUpAxis( xml ) {\n\n      return xml !== undefined ? xml.textContent : 'Y_UP';\n\n    }\n\n    // library\n\n    function parseLibrary( xml, libraryName, nodeName, parser ) {\n\n      var library = getElementsByTagName( xml, libraryName )[ 0 ];\n\n      if ( library !== undefined ) {\n\n        var elements = getElementsByTagName( library, nodeName );\n\n        for ( var i = 0; i < elements.length; i ++ ) {\n\n          parser( elements[ i ] );\n\n        }\n\n      }\n\n    }\n\n    function buildLibrary( data, builder ) {\n\n      for ( var name in data ) {\n\n        var object = data[ name ];\n        object.build = builder( data[ name ] );\n\n      }\n\n    }\n\n    // get\n\n    function getBuild( data, builder ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      data.build = builder( data );\n\n      return data.build;\n\n    }\n\n    // animation\n\n    function parseAnimation( xml ) {\n\n      var data = {\n        sources: {},\n        samplers: {},\n        channels: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        var id;\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            id = child.getAttribute( 'id' );\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'sampler':\n            id = child.getAttribute( 'id' );\n            data.samplers[ id ] = parseAnimationSampler( child );\n            break;\n\n          case 'channel':\n            id = child.getAttribute( 'target' );\n            data.channels[ id ] = parseAnimationChannel( child );\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      library.animations[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseAnimationSampler( xml ) {\n\n      var data = {\n        inputs: {},\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var id = parseId( child.getAttribute( 'source' ) );\n            var semantic = child.getAttribute( 'semantic' );\n            data.inputs[ semantic ] = id;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseAnimationChannel( xml ) {\n\n      var data = {};\n\n      var target = xml.getAttribute( 'target' );\n\n      // parsing SID Addressing Syntax\n\n      var parts = target.split( '/' );\n\n      var id = parts.shift();\n      var sid = parts.shift();\n\n      // check selection syntax\n\n      var arraySyntax = ( sid.indexOf( '(' ) !== - 1 );\n      var memberSyntax = ( sid.indexOf( '.' ) !== - 1 );\n\n      if ( memberSyntax ) {\n\n        //  member selection access\n\n        parts = sid.split( '.' );\n        sid = parts.shift();\n        data.member = parts.shift();\n\n      } else if ( arraySyntax ) {\n\n        // array-access syntax. can be used to express fields in one-dimensional vectors or two-dimensional matrices.\n\n        var indices = sid.split( '(' );\n        sid = indices.shift();\n\n        for ( var i = 0; i < indices.length; i ++ ) {\n\n          indices[ i ] = parseInt( indices[ i ].replace( /\\)/, '' ) );\n\n        }\n\n        data.indices = indices;\n\n      }\n\n      data.id = id;\n      data.sid = sid;\n\n      data.arraySyntax = arraySyntax;\n      data.memberSyntax = memberSyntax;\n\n      data.sampler = parseId( xml.getAttribute( 'source' ) );\n\n      return data;\n\n    }\n\n    function buildAnimation( data ) {\n\n      var tracks = [];\n\n      var channels = data.channels;\n      var samplers = data.samplers;\n      var sources = data.sources;\n\n      for ( var target in channels ) {\n\n        if ( channels.hasOwnProperty( target ) ) {\n\n          var channel = channels[ target ];\n          var sampler = samplers[ channel.sampler ];\n\n          var inputId = sampler.inputs.INPUT;\n          var outputId = sampler.inputs.OUTPUT;\n\n          var inputSource = sources[ inputId ];\n          var outputSource = sources[ outputId ];\n\n          var animation = buildAnimationChannel( channel, inputSource, outputSource );\n\n          createKeyframeTracks( animation, tracks );\n\n        }\n\n      }\n\n      return tracks;\n\n    }\n\n    function getAnimation( id ) {\n\n      return getBuild( library.animations[ id ], buildAnimation );\n\n    }\n\n    function buildAnimationChannel( channel, inputSource, outputSource ) {\n\n      var node = library.nodes[ channel.id ];\n      var object3D = getNode( node.id );\n\n      var transform = node.transforms[ channel.sid ];\n      var defaultMatrix = node.matrix.clone().transpose();\n\n      var time, stride;\n      var i, il, j, jl;\n\n      var data = {};\n\n      // the collada spec allows the animation of data in various ways.\n      // depending on the transform type (matrix, translate, rotate, scale), we execute different logic\n\n      switch ( transform ) {\n\n        case 'matrix':\n\n          for ( i = 0, il = inputSource.array.length; i < il; i ++ ) {\n\n            time = inputSource.array[ i ];\n            stride = i * outputSource.stride;\n\n            if ( data[ time ] === undefined ) data[ time ] = {};\n\n            if ( channel.arraySyntax === true ) {\n\n              var value = outputSource.array[ stride ];\n              var index = channel.indices[ 0 ] + 4 * channel.indices[ 1 ];\n\n              data[ time ][ index ] = value;\n\n            } else {\n\n              for ( j = 0, jl = outputSource.stride; j < jl; j ++ ) {\n\n                data[ time ][ j ] = outputSource.array[ stride + j ];\n\n              }\n\n            }\n\n          }\n\n          break;\n\n        case 'translate':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n        case 'rotate':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n        case 'scale':\n          console.warn( 'THREE.ColladaLoader: Animation transform type \"%s\" not yet implemented.', transform );\n          break;\n\n      }\n\n      var keyframes = prepareAnimationData( data, defaultMatrix );\n\n      var animation = {\n        name: object3D.uuid,\n        keyframes: keyframes\n      };\n\n      return animation;\n\n    }\n\n    function prepareAnimationData( data, defaultMatrix ) {\n\n      var keyframes = [];\n\n      // transfer data into a sortable array\n\n      for ( var time in data ) {\n\n        keyframes.push( { time: parseFloat( time ), value: data[ time ] } );\n\n      }\n\n      // ensure keyframes are sorted by time\n\n      keyframes.sort( ascending );\n\n      // now we clean up all animation data, so we can use them for keyframe tracks\n\n      for ( var i = 0; i < 16; i ++ ) {\n\n        transformAnimationData( keyframes, i, defaultMatrix.elements[ i ] );\n\n      }\n\n      return keyframes;\n\n      // array sort function\n\n      function ascending( a, b ) {\n\n        return a.time - b.time;\n\n      }\n\n    }\n\n    var position = new THREE.Vector3();\n    var scale = new THREE.Vector3();\n    var quaternion = new THREE.Quaternion();\n\n    function createKeyframeTracks( animation, tracks ) {\n\n      var keyframes = animation.keyframes;\n      var name = animation.name;\n\n      var times = [];\n      var positionData = [];\n      var quaternionData = [];\n      var scaleData = [];\n\n      for ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        var keyframe = keyframes[ i ];\n\n        var time = keyframe.time;\n        var value = keyframe.value;\n\n        matrix.fromArray( value ).transpose();\n        matrix.decompose( position, quaternion, scale );\n\n        times.push( time );\n        positionData.push( position.x, position.y, position.z );\n        quaternionData.push( quaternion.x, quaternion.y, quaternion.z, quaternion.w );\n        scaleData.push( scale.x, scale.y, scale.z );\n\n      }\n\n      if ( positionData.length > 0 ) tracks.push( new THREE.VectorKeyframeTrack( name + '.position', times, positionData ) );\n      if ( quaternionData.length > 0 ) tracks.push( new THREE.QuaternionKeyframeTrack( name + '.quaternion', times, quaternionData ) );\n      if ( scaleData.length > 0 ) tracks.push( new THREE.VectorKeyframeTrack( name + '.scale', times, scaleData ) );\n\n      return tracks;\n\n    }\n\n    function transformAnimationData( keyframes, property, defaultValue ) {\n\n      var keyframe;\n\n      var empty = true;\n      var i, l;\n\n      // check, if values of a property are missing in our keyframes\n\n      for ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] === undefined ) {\n\n          keyframe.value[ property ] = null; // mark as missing\n\n        } else {\n\n          empty = false;\n\n        }\n\n      }\n\n      if ( empty === true ) {\n\n        // no values at all, so we set a default value\n\n        for ( i = 0, l = keyframes.length; i < l; i ++ ) {\n\n          keyframe = keyframes[ i ];\n\n          keyframe.value[ property ] = defaultValue;\n\n        }\n\n      } else {\n\n        // filling gaps\n\n        createMissingKeyframes( keyframes, property );\n\n      }\n\n    }\n\n    function createMissingKeyframes( keyframes, property ) {\n\n      var prev, next;\n\n      for ( var i = 0, l = keyframes.length; i < l; i ++ ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] === null ) {\n\n          prev = getPrev( keyframes, i, property );\n          next = getNext( keyframes, i, property );\n\n          if ( prev === null ) {\n\n            keyframe.value[ property ] = next.value[ property ];\n            continue;\n\n          }\n\n          if ( next === null ) {\n\n            keyframe.value[ property ] = prev.value[ property ];\n            continue;\n\n          }\n\n          interpolate( keyframe, prev, next, property );\n\n        }\n\n      }\n\n    }\n\n    function getPrev( keyframes, i, property ) {\n\n      while ( i >= 0 ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] !== null ) return keyframe;\n\n        i --;\n\n      }\n\n      return null;\n\n    }\n\n    function getNext( keyframes, i, property ) {\n\n      while ( i < keyframes.length ) {\n\n        var keyframe = keyframes[ i ];\n\n        if ( keyframe.value[ property ] !== null ) return keyframe;\n\n        i ++;\n\n      }\n\n      return null;\n\n    }\n\n    function interpolate( key, prev, next, property ) {\n\n      if ( ( next.time - prev.time ) === 0 ) {\n\n        key.value[ property ] = prev.value[ property ];\n        return;\n\n      }\n\n      key.value[ property ] = ( ( key.time - prev.time ) * ( next.value[ property ] - prev.value[ property ] ) / ( next.time - prev.time ) ) + prev.value[ property ];\n\n    }\n\n    // animation clips\n\n    function parseAnimationClip( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'id' ) || 'default',\n        start: parseFloat( xml.getAttribute( 'start' ) || 0 ),\n        end: parseFloat( xml.getAttribute( 'end' ) || 0 ),\n        animations: []\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'instance_animation':\n            data.animations.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n        }\n\n      }\n\n      library.clips[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildAnimationClip( data ) {\n\n      var tracks = [];\n\n      var name = data.name;\n      var duration = ( data.end - data.start ) || - 1;\n      var animations = data.animations;\n\n      for ( var i = 0, il = animations.length; i < il; i ++ ) {\n\n        var animationTracks = getAnimation( animations[ i ] );\n\n        for ( var j = 0, jl = animationTracks.length; j < jl; j ++ ) {\n\n          tracks.push( animationTracks[ j ] );\n\n        }\n\n      }\n\n      return new THREE.AnimationClip( name, duration, tracks );\n\n    }\n\n    function getAnimationClip( id ) {\n\n      return getBuild( library.clips[ id ], buildAnimationClip );\n\n    }\n\n    // controller\n\n    function parseController( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'skin':\n            // there is exactly one skin per controller\n            data.id = parseId( child.getAttribute( 'source' ) );\n            data.skin = parseSkin( child );\n            break;\n\n          case 'morph':\n            data.id = parseId( child.getAttribute( 'source' ) );\n            console.warn( 'THREE.ColladaLoader: Morph target animation not supported yet.' );\n            break;\n\n        }\n\n      }\n\n      library.controllers[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseSkin( xml ) {\n\n      var data = {\n        sources: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'bind_shape_matrix':\n            data.bindShapeMatrix = parseFloats( child.textContent );\n            break;\n\n          case 'source':\n            var id = child.getAttribute( 'id' );\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'joints':\n            data.joints = parseJoints( child );\n            break;\n\n          case 'vertex_weights':\n            data.vertexWeights = parseVertexWeights( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseJoints( xml ) {\n\n      var data = {\n        inputs: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var semantic = child.getAttribute( 'semantic' );\n            var id = parseId( child.getAttribute( 'source' ) );\n            data.inputs[ semantic ] = id;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseVertexWeights( xml ) {\n\n      var data = {\n        inputs: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var semantic = child.getAttribute( 'semantic' );\n            var id = parseId( child.getAttribute( 'source' ) );\n            var offset = parseInt( child.getAttribute( 'offset' ) );\n            data.inputs[ semantic ] = { id: id, offset: offset };\n            break;\n\n          case 'vcount':\n            data.vcount = parseInts( child.textContent );\n            break;\n\n          case 'v':\n            data.v = parseInts( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildController( data ) {\n\n      var build = {\n        id: data.id\n      };\n\n      var geometry = library.geometries[ build.id ];\n\n      if ( data.skin !== undefined ) {\n\n        build.skin = buildSkin( data.skin );\n\n        // we enhance the 'sources' property of the corresponding geometry with our skin data\n\n        geometry.sources.skinIndices = build.skin.indices;\n        geometry.sources.skinWeights = build.skin.weights;\n\n      }\n\n      return build;\n\n    }\n\n    function buildSkin( data ) {\n\n      var BONE_LIMIT = 4;\n\n      var build = {\n        joints: [], // this must be an array to preserve the joint order\n        indices: {\n          array: [],\n          stride: BONE_LIMIT\n        },\n        weights: {\n          array: [],\n          stride: BONE_LIMIT\n        }\n      };\n\n      var sources = data.sources;\n      var vertexWeights = data.vertexWeights;\n\n      var vcount = vertexWeights.vcount;\n      var v = vertexWeights.v;\n      var jointOffset = vertexWeights.inputs.JOINT.offset;\n      var weightOffset = vertexWeights.inputs.WEIGHT.offset;\n\n      var jointSource = data.sources[ data.joints.inputs.JOINT ];\n      var inverseSource = data.sources[ data.joints.inputs.INV_BIND_MATRIX ];\n\n      var weights = sources[ vertexWeights.inputs.WEIGHT.id ].array;\n      var stride = 0;\n\n      var i, j, l;\n\n      // procces skin data for each vertex\n\n      for ( i = 0, l = vcount.length; i < l; i ++ ) {\n\n        var jointCount = vcount[ i ]; // this is the amount of joints that affect a single vertex\n        var vertexSkinData = [];\n\n        for ( j = 0; j < jointCount; j ++ ) {\n\n          var skinIndex = v[ stride + jointOffset ];\n          var weightId = v[ stride + weightOffset ];\n          var skinWeight = weights[ weightId ];\n\n          vertexSkinData.push( { index: skinIndex, weight: skinWeight } );\n\n          stride += 2;\n\n        }\n\n        // we sort the joints in descending order based on the weights.\n        // this ensures, we only procced the most important joints of the vertex\n\n        vertexSkinData.sort( descending );\n\n        // now we provide for each vertex a set of four index and weight values.\n        // the order of the skin data matches the order of vertices\n\n        for ( j = 0; j < BONE_LIMIT; j ++ ) {\n\n          var d = vertexSkinData[ j ];\n\n          if ( d !== undefined ) {\n\n            build.indices.array.push( d.index );\n            build.weights.array.push( d.weight );\n\n          } else {\n\n            build.indices.array.push( 0 );\n            build.weights.array.push( 0 );\n\n          }\n\n        }\n\n      }\n\n      // setup bind matrix\n\n      if ( data.bindShapeMatrix ) {\n\n        build.bindMatrix = new THREE.Matrix4().fromArray( data.bindShapeMatrix ).transpose();\n\n      } else {\n\n        build.bindMatrix = new THREE.Matrix4().identity();\n\n      }\n\n      // process bones and inverse bind matrix data\n\n      for ( i = 0, l = jointSource.array.length; i < l; i ++ ) {\n\n        var name = jointSource.array[ i ];\n        var boneInverse = new THREE.Matrix4().fromArray( inverseSource.array, i * inverseSource.stride ).transpose();\n\n        build.joints.push( { name: name, boneInverse: boneInverse } );\n\n      }\n\n      return build;\n\n      // array sort function\n\n      function descending( a, b ) {\n\n        return b.weight - a.weight;\n\n      }\n\n    }\n\n    function getController( id ) {\n\n      return getBuild( library.controllers[ id ], buildController );\n\n    }\n\n    // image\n\n    function parseImage( xml ) {\n\n      var data = {\n        init_from: getElementsByTagName( xml, 'init_from' )[ 0 ].textContent\n      };\n\n      library.images[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildImage( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data.init_from;\n\n    }\n\n    function getImage( id ) {\n\n      var data = library.images[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildImage );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find image with ID:', id );\n\n      return null;\n\n    }\n\n    // effect\n\n    function parseEffect( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'profile_COMMON':\n            data.profile = parseEffectProfileCOMMON( child );\n            break;\n\n        }\n\n      }\n\n      library.effects[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseEffectProfileCOMMON( xml ) {\n\n      var data = {\n        surfaces: {},\n        samplers: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'newparam':\n            parseEffectNewparam( child, data );\n            break;\n\n          case 'technique':\n            data.technique = parseEffectTechnique( child );\n            break;\n\n          case 'extra':\n            data.extra = parseEffectExtra( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectNewparam( xml, data ) {\n\n      var sid = xml.getAttribute( 'sid' );\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'surface':\n            data.surfaces[ sid ] = parseEffectSurface( child );\n            break;\n\n          case 'sampler2D':\n            data.samplers[ sid ] = parseEffectSampler( child );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectSurface( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'init_from':\n            data.init_from = child.textContent;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectSampler( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            data.source = child.textContent;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'constant':\n          case 'lambert':\n          case 'blinn':\n          case 'phong':\n            data.type = child.nodeName;\n            data.parameters = parseEffectParameters( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'emission':\n          case 'diffuse':\n          case 'specular':\n          case 'bump':\n          case 'ambient':\n          case 'shininess':\n          case 'transparency':\n            data[ child.nodeName ] = parseEffectParameter( child );\n            break;\n          case 'transparent':\n            data[ child.nodeName ] = {\n              opaque: child.getAttribute( 'opaque' ),\n              data: parseEffectParameter( child )\n            };\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameter( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'color':\n            data[ child.nodeName ] = parseFloats( child.textContent );\n            break;\n\n          case 'float':\n            data[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n          case 'texture':\n            data[ child.nodeName ] = { id: child.getAttribute( 'texture' ), extra: parseEffectParameterTexture( child ) };\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameterTexture( xml ) {\n\n      var data = {\n        technique: {}\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'extra':\n            parseEffectParameterTextureExtra( child, data );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectParameterTextureExtra( xml, data ) {\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique':\n            parseEffectParameterTextureExtraTechnique( child, data );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectParameterTextureExtraTechnique( xml, data ) {\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'repeatU':\n          case 'repeatV':\n          case 'offsetU':\n          case 'offsetV':\n            data.technique[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n          case 'wrapU':\n          case 'wrapV':\n\n            // some files have values for wrapU/wrapV which become NaN via parseInt\n\n            if ( child.textContent.toUpperCase() === 'TRUE' ) {\n\n              data.technique[ child.nodeName ] = 1;\n\n            } else if ( child.textContent.toUpperCase() === 'FALSE' ) {\n\n              data.technique[ child.nodeName ] = 0;\n\n            } else {\n\n              data.technique[ child.nodeName ] = parseInt( child.textContent );\n\n            }\n\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseEffectExtra( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique':\n            data.technique = parseEffectExtraTechnique( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseEffectExtraTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'double_sided':\n            data[ child.nodeName ] = parseInt( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildEffect( data ) {\n\n      return data;\n\n    }\n\n    function getEffect( id ) {\n\n      return getBuild( library.effects[ id ], buildEffect );\n\n    }\n\n    // material\n\n    function parseMaterial( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' )\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'instance_effect':\n            data.url = parseId( child.getAttribute( 'url' ) );\n            break;\n\n        }\n\n      }\n\n      library.materials[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function getTextureLoader( image ) {\n\n      var loader;\n\n      var extension = image.slice( ( image.lastIndexOf( '.' ) - 1 >>> 0 ) + 2 ); // http://www.jstips.co/en/javascript/get-file-extension/\n      extension = extension.toLowerCase();\n\n      switch ( extension ) {\n\n        case 'tga':\n          loader = tgaLoader;\n          break;\n\n        default:\n          loader = textureLoader;\n\n      }\n\n      return loader;\n\n    }\n\n    function buildMaterial( data ) {\n\n      var effect = getEffect( data.url );\n      var technique = effect.profile.technique;\n      var extra = effect.profile.extra;\n\n      var material;\n\n      switch ( technique.type ) {\n\n        case 'phong':\n        case 'blinn':\n          material = new THREE.MeshPhongMaterial();\n          break;\n\n        case 'lambert':\n          material = new THREE.MeshLambertMaterial();\n          break;\n\n        default:\n          material = new THREE.MeshBasicMaterial();\n          break;\n\n      }\n\n      material.name = data.name;\n\n      function getTexture( textureObject ) {\n\n        var sampler = effect.profile.samplers[ textureObject.id ];\n        var image = null;\n\n        // get image\n\n        if ( sampler !== undefined ) {\n\n          var surface = effect.profile.surfaces[ sampler.source ];\n          image = getImage( surface.init_from );\n\n        } else {\n\n          console.warn( 'THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530).' );\n          image = getImage( textureObject.id );\n\n        }\n\n        // create texture if image is avaiable\n\n        if ( image !== null ) {\n\n          var loader = getTextureLoader( image );\n\n          if ( loader !== undefined ) {\n\n            var texture = loader.load( image );\n\n            var extra = textureObject.extra;\n\n            if ( extra !== undefined && extra.technique !== undefined && isEmpty( extra.technique ) === false ) {\n\n              var technique = extra.technique;\n\n              texture.wrapS = technique.wrapU ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n              texture.wrapT = technique.wrapV ? THREE.RepeatWrapping : THREE.ClampToEdgeWrapping;\n\n              texture.offset.set( technique.offsetU || 0, technique.offsetV || 0 );\n              texture.repeat.set( technique.repeatU || 1, technique.repeatV || 1 );\n\n            } else {\n\n              texture.wrapS = THREE.RepeatWrapping;\n              texture.wrapT = THREE.RepeatWrapping;\n\n            }\n\n            return texture;\n\n          } else {\n\n            console.warn( 'THREE.ColladaLoader: Loader for texture %s not found.', image );\n\n            return null;\n\n          }\n\n        } else {\n\n          console.warn( 'THREE.ColladaLoader: Couldn\\'t create texture with ID:', textureObject.id );\n\n          return null;\n\n        }\n\n      }\n\n      var parameters = technique.parameters;\n\n      for ( var key in parameters ) {\n\n        var parameter = parameters[ key ];\n\n        switch ( key ) {\n\n          case 'diffuse':\n            if ( parameter.color ) material.color.fromArray( parameter.color );\n            if ( parameter.texture ) material.map = getTexture( parameter.texture );\n            break;\n          case 'specular':\n            if ( parameter.color && material.specular ) material.specular.fromArray( parameter.color );\n            if ( parameter.texture ) material.specularMap = getTexture( parameter.texture );\n            break;\n          case 'bump':\n            if ( parameter.texture ) material.normalMap = getTexture( parameter.texture );\n            break;\n          case 'ambient':\n            if ( parameter.texture ) material.lightMap = getTexture( parameter.texture );\n            break;\n          case 'shininess':\n            if ( parameter.float && material.shininess ) material.shininess = parameter.float;\n            break;\n          case 'emission':\n            if ( parameter.color && material.emissive ) material.emissive.fromArray( parameter.color );\n            if ( parameter.texture ) material.emissiveMap = getTexture( parameter.texture );\n            break;\n\n        }\n\n      }\n\n      //\n\n      var transparent = parameters[ 'transparent' ];\n      var transparency = parameters[ 'transparency' ];\n\n      // <transparency> does not exist but <transparent>\n\n      if ( transparency === undefined && transparent ) {\n\n        transparency = {\n          float: 1\n        };\n\n      }\n\n      // <transparent> does not exist but <transparency>\n\n      if ( transparent === undefined && transparency ) {\n\n        transparent = {\n          opaque: 'A_ONE',\n          data: {\n            color: [ 1, 1, 1, 1 ]\n          } };\n\n      }\n\n      if ( transparent && transparency ) {\n\n        // handle case if a texture exists but no color\n\n        if ( transparent.data.texture ) {\n\n          // we do not set an alpha map (see #13792)\n\n          material.transparent = true;\n\n        } else {\n\n          var color = transparent.data.color;\n\n          switch ( transparent.opaque ) {\n\n            case 'A_ONE':\n              material.opacity = color[ 3 ] * transparency.float;\n              break;\n            case 'RGB_ZERO':\n              material.opacity = 1 - ( color[ 0 ] * transparency.float );\n              break;\n            case 'A_ZERO':\n              material.opacity = 1 - ( color[ 3 ] * transparency.float );\n              break;\n            case 'RGB_ONE':\n              material.opacity = color[ 0 ] * transparency.float;\n              break;\n            default:\n              console.warn( 'THREE.ColladaLoader: Invalid opaque type \"%s\" of transparent tag.', transparent.opaque );\n\n          }\n\n          if ( material.opacity < 1 ) material.transparent = true;\n\n        }\n\n      }\n\n      //\n\n      if ( extra !== undefined && extra.technique !== undefined && extra.technique.double_sided === 1 ) {\n\n        material.side = THREE.DoubleSide;\n\n      }\n\n      return material;\n\n    }\n\n    function getMaterial( id ) {\n\n      return getBuild( library.materials[ id ], buildMaterial );\n\n    }\n\n    // camera\n\n    function parseCamera( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' )\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'optics':\n            data.optics = parseCameraOptics( child );\n            break;\n\n        }\n\n      }\n\n      library.cameras[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseCameraOptics( xml ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            return parseCameraTechnique( child );\n\n        }\n\n      }\n\n      return {};\n\n    }\n\n    function parseCameraTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'perspective':\n          case 'orthographic':\n\n            data.technique = child.nodeName;\n            data.parameters = parseCameraParameters( child );\n\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseCameraParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'xfov':\n          case 'yfov':\n          case 'xmag':\n          case 'ymag':\n          case 'znear':\n          case 'zfar':\n          case 'aspect_ratio':\n            data[ child.nodeName ] = parseFloat( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildCamera( data ) {\n\n      var camera;\n\n      switch ( data.optics.technique ) {\n\n        case 'perspective':\n          camera = new THREE.PerspectiveCamera(\n            data.optics.parameters.yfov,\n            data.optics.parameters.aspect_ratio,\n            data.optics.parameters.znear,\n            data.optics.parameters.zfar\n          );\n          break;\n\n        case 'orthographic':\n          var ymag = data.optics.parameters.ymag;\n          var xmag = data.optics.parameters.xmag;\n          var aspectRatio = data.optics.parameters.aspect_ratio;\n\n          xmag = ( xmag === undefined ) ? ( ymag * aspectRatio ) : xmag;\n          ymag = ( ymag === undefined ) ? ( xmag / aspectRatio ) : ymag;\n\n          xmag *= 0.5;\n          ymag *= 0.5;\n\n          camera = new THREE.OrthographicCamera(\n            - xmag, xmag, ymag, - ymag, // left, right, top, bottom\n            data.optics.parameters.znear,\n            data.optics.parameters.zfar\n          );\n          break;\n\n        default:\n          camera = new THREE.PerspectiveCamera();\n          break;\n\n      }\n\n      camera.name = data.name;\n\n      return camera;\n\n    }\n\n    function getCamera( id ) {\n\n      var data = library.cameras[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildCamera );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find camera with ID:', id );\n\n      return null;\n\n    }\n\n    // light\n\n    function parseLight( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            data = parseLightTechnique( child );\n            break;\n\n        }\n\n      }\n\n      library.lights[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseLightTechnique( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'directional':\n          case 'point':\n          case 'spot':\n          case 'ambient':\n\n            data.technique = child.nodeName;\n            data.parameters = parseLightParameters( child );\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseLightParameters( xml ) {\n\n      var data = {};\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'color':\n            var array = parseFloats( child.textContent );\n            data.color = new THREE.Color().fromArray( array );\n            break;\n\n          case 'falloff_angle':\n            data.falloffAngle = parseFloat( child.textContent );\n            break;\n\n          case 'quadratic_attenuation':\n            var f = parseFloat( child.textContent );\n            data.distance = f ? Math.sqrt( 1 / f ) : 0;\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildLight( data ) {\n\n      var light;\n\n      switch ( data.technique ) {\n\n        case 'directional':\n          light = new THREE.DirectionalLight();\n          break;\n\n        case 'point':\n          light = new THREE.PointLight();\n          break;\n\n        case 'spot':\n          light = new THREE.SpotLight();\n          break;\n\n        case 'ambient':\n          light = new THREE.AmbientLight();\n          break;\n\n      }\n\n      if ( data.parameters.color ) light.color.copy( data.parameters.color );\n      if ( data.parameters.distance ) light.distance = data.parameters.distance;\n\n      return light;\n\n    }\n\n    function getLight( id ) {\n\n      var data = library.lights[ id ];\n\n      if ( data !== undefined ) {\n\n        return getBuild( data, buildLight );\n\n      }\n\n      console.warn( 'THREE.ColladaLoader: Couldn\\'t find light with ID:', id );\n\n      return null;\n\n    }\n\n    // geometry\n\n    function parseGeometry( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ),\n        sources: {},\n        vertices: {},\n        primitives: []\n      };\n\n      var mesh = getElementsByTagName( xml, 'mesh' )[ 0 ];\n\n      // the following tags inside geometry are not supported yet (see https://github.com/mrdoob/three.js/pull/12606): convex_mesh, spline, brep\n      if ( mesh === undefined ) return;\n\n      for ( var i = 0; i < mesh.childNodes.length; i ++ ) {\n\n        var child = mesh.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        var id = child.getAttribute( 'id' );\n\n        switch ( child.nodeName ) {\n\n          case 'source':\n            data.sources[ id ] = parseSource( child );\n            break;\n\n          case 'vertices':\n            // data.sources[ id ] = data.sources[ parseId( getElementsByTagName( child, 'input' )[ 0 ].getAttribute( 'source' ) ) ];\n            data.vertices = parseGeometryVertices( child );\n            break;\n\n          case 'polygons':\n            console.warn( 'THREE.ColladaLoader: Unsupported primitive type: ', child.nodeName );\n            break;\n\n          case 'lines':\n          case 'linestrips':\n          case 'polylist':\n          case 'triangles':\n            data.primitives.push( parseGeometryPrimitive( child ) );\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      library.geometries[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parseSource( xml ) {\n\n      var data = {\n        array: [],\n        stride: 3\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'float_array':\n            data.array = parseFloats( child.textContent );\n            break;\n\n          case 'Name_array':\n            data.array = parseStrings( child.textContent );\n            break;\n\n          case 'technique_common':\n            var accessor = getElementsByTagName( child, 'accessor' )[ 0 ];\n\n            if ( accessor !== undefined ) {\n\n              data.stride = parseInt( accessor.getAttribute( 'stride' ) );\n\n            }\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseGeometryVertices( xml ) {\n\n      var data = {};\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        data[ child.getAttribute( 'semantic' ) ] = parseId( child.getAttribute( 'source' ) );\n\n      }\n\n      return data;\n\n    }\n\n    function parseGeometryPrimitive( xml ) {\n\n      var primitive = {\n        type: xml.nodeName,\n        material: xml.getAttribute( 'material' ),\n        count: parseInt( xml.getAttribute( 'count' ) ),\n        inputs: {},\n        stride: 0,\n        hasUV: false\n      };\n\n      for ( var i = 0, l = xml.childNodes.length; i < l; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'input':\n            var id = parseId( child.getAttribute( 'source' ) );\n            var semantic = child.getAttribute( 'semantic' );\n            var offset = parseInt( child.getAttribute( 'offset' ) );\n            var set = parseInt( child.getAttribute( 'set' ) );\n            var inputname = ( set > 0 ? semantic + set : semantic );\n            primitive.inputs[ inputname ] = { id: id, offset: offset };\n            primitive.stride = Math.max( primitive.stride, offset + 1 );\n            if ( semantic === 'TEXCOORD' ) primitive.hasUV = true;\n            break;\n\n          case 'vcount':\n            primitive.vcount = parseInts( child.textContent );\n            break;\n\n          case 'p':\n            primitive.p = parseInts( child.textContent );\n            break;\n\n        }\n\n      }\n\n      return primitive;\n\n    }\n\n    function groupPrimitives( primitives ) {\n\n      var build = {};\n\n      for ( var i = 0; i < primitives.length; i ++ ) {\n\n        var primitive = primitives[ i ];\n\n        if ( build[ primitive.type ] === undefined ) build[ primitive.type ] = [];\n\n        build[ primitive.type ].push( primitive );\n\n      }\n\n      return build;\n\n    }\n\n    function checkUVCoordinates( primitives ) {\n\n      var count = 0;\n\n      for ( var i = 0, l = primitives.length; i < l; i ++ ) {\n\n        var primitive = primitives[ i ];\n\n        if ( primitive.hasUV === true ) {\n\n          count ++;\n\n        }\n\n      }\n\n      if ( count > 0 && count < primitives.length ) {\n\n        primitives.uvsNeedsFix = true;\n\n      }\n\n    }\n\n    function buildGeometry( data ) {\n\n      var build = {};\n\n      var sources = data.sources;\n      var vertices = data.vertices;\n      var primitives = data.primitives;\n\n      if ( primitives.length === 0 ) return {};\n\n      // our goal is to create one buffer geometry for a single type of primitives\n      // first, we group all primitives by their type\n\n      var groupedPrimitives = groupPrimitives( primitives );\n\n      for ( var type in groupedPrimitives ) {\n\n        var primitiveType = groupedPrimitives[ type ];\n\n        // second, ensure consistent uv coordinates for each type of primitives (polylist,triangles or lines)\n\n        checkUVCoordinates( primitiveType );\n\n        // third, create a buffer geometry for each type of primitives\n\n        build[ type ] = buildGeometryType( primitiveType, sources, vertices );\n\n      }\n\n      return build;\n\n    }\n\n    function buildGeometryType( primitives, sources, vertices ) {\n\n      var build = {};\n\n      var position = { array: [], stride: 0 };\n      var normal = { array: [], stride: 0 };\n      var uv = { array: [], stride: 0 };\n      var uv2 = { array: [], stride: 0 };\n      var color = { array: [], stride: 0 };\n\n      var skinIndex = { array: [], stride: 4 };\n      var skinWeight = { array: [], stride: 4 };\n\n      var geometry = new THREE.BufferGeometry();\n\n      var materialKeys = [];\n\n      var start = 0;\n\n      for ( var p = 0; p < primitives.length; p ++ ) {\n\n        var primitive = primitives[ p ];\n        var inputs = primitive.inputs;\n\n        // groups\n\n        var count = 0;\n\n        switch ( primitive.type ) {\n\n          case 'lines':\n          case 'linestrips':\n            count = primitive.count * 2;\n            break;\n\n          case 'triangles':\n            count = primitive.count * 3;\n            break;\n\n          case 'polylist':\n\n            for ( var g = 0; g < primitive.count; g ++ ) {\n\n              var vc = primitive.vcount[ g ];\n\n              switch ( vc ) {\n\n                case 3:\n                  count += 3; // single triangle\n                  break;\n\n                case 4:\n                  count += 6; // quad, subdivided into two triangles\n                  break;\n\n                default:\n                  count += ( vc - 2 ) * 3; // polylist with more than four vertices\n                  break;\n\n              }\n\n            }\n\n            break;\n\n          default:\n            console.warn( 'THREE.ColladaLoader: Unknow primitive type:', primitive.type );\n\n        }\n\n        geometry.addGroup( start, count, p );\n        start += count;\n\n        // material\n\n        if ( primitive.material ) {\n\n          materialKeys.push( primitive.material );\n\n        }\n\n        // geometry data\n\n        for ( var name in inputs ) {\n\n          var input = inputs[ name ];\n\n          switch ( name ) {\n\n            case 'VERTEX':\n              for ( var key in vertices ) {\n\n                var id = vertices[ key ];\n\n                switch ( key ) {\n\n                  case 'POSITION':\n                    var prevLength = position.array.length;\n                    buildGeometryData( primitive, sources[ id ], input.offset, position.array );\n                    position.stride = sources[ id ].stride;\n\n                    if ( sources.skinWeights && sources.skinIndices ) {\n\n                      buildGeometryData( primitive, sources.skinIndices, input.offset, skinIndex.array );\n                      buildGeometryData( primitive, sources.skinWeights, input.offset, skinWeight.array );\n\n                    }\n\n                    // see #3803\n\n                    if ( primitive.hasUV === false && primitives.uvsNeedsFix === true ) {\n\n                      var count = ( position.array.length - prevLength ) / position.stride;\n\n                      for ( var i = 0; i < count; i ++ ) {\n\n                        // fill missing uv coordinates\n\n                        uv.array.push( 0, 0 );\n\n                      }\n\n                    }\n                    break;\n\n                  case 'NORMAL':\n                    buildGeometryData( primitive, sources[ id ], input.offset, normal.array );\n                    normal.stride = sources[ id ].stride;\n                    break;\n\n                  case 'COLOR':\n                    buildGeometryData( primitive, sources[ id ], input.offset, color.array );\n                    color.stride = sources[ id ].stride;\n                    break;\n\n                  case 'TEXCOORD':\n                    buildGeometryData( primitive, sources[ id ], input.offset, uv.array );\n                    uv.stride = sources[ id ].stride;\n                    break;\n\n                  case 'TEXCOORD1':\n                    buildGeometryData( primitive, sources[ id ], input.offset, uv2.array );\n                    uv.stride = sources[ id ].stride;\n                    break;\n\n                  default:\n                    console.warn( 'THREE.ColladaLoader: Semantic \"%s\" not handled in geometry build process.', key );\n\n                }\n\n              }\n              break;\n\n            case 'NORMAL':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, normal.array );\n              normal.stride = sources[ input.id ].stride;\n              break;\n\n            case 'COLOR':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, color.array );\n              color.stride = sources[ input.id ].stride;\n              break;\n\n            case 'TEXCOORD':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, uv.array );\n              uv.stride = sources[ input.id ].stride;\n              break;\n\n            case 'TEXCOORD1':\n              buildGeometryData( primitive, sources[ input.id ], input.offset, uv2.array );\n              uv2.stride = sources[ input.id ].stride;\n              break;\n\n          }\n\n        }\n\n      }\n\n      // build geometry\n\n      if ( position.array.length > 0 ) geometry.addAttribute( 'position', new THREE.Float32BufferAttribute( position.array, position.stride ) );\n      if ( normal.array.length > 0 ) geometry.addAttribute( 'normal', new THREE.Float32BufferAttribute( normal.array, normal.stride ) );\n      if ( color.array.length > 0 ) geometry.addAttribute( 'color', new THREE.Float32BufferAttribute( color.array, color.stride ) );\n      if ( uv.array.length > 0 ) geometry.addAttribute( 'uv', new THREE.Float32BufferAttribute( uv.array, uv.stride ) );\n      if ( uv2.array.length > 0 ) geometry.addAttribute( 'uv2', new THREE.Float32BufferAttribute( uv2.array, uv2.stride ) );\n\n      if ( skinIndex.array.length > 0 ) geometry.addAttribute( 'skinIndex', new THREE.Float32BufferAttribute( skinIndex.array, skinIndex.stride ) );\n      if ( skinWeight.array.length > 0 ) geometry.addAttribute( 'skinWeight', new THREE.Float32BufferAttribute( skinWeight.array, skinWeight.stride ) );\n\n      build.data = geometry;\n      build.type = primitives[ 0 ].type;\n      build.materialKeys = materialKeys;\n\n      return build;\n\n    }\n\n    function buildGeometryData( primitive, source, offset, array ) {\n\n      var indices = primitive.p;\n      var stride = primitive.stride;\n      var vcount = primitive.vcount;\n\n      function pushVector( i ) {\n\n        var index = indices[ i + offset ] * sourceStride;\n        var length = index + sourceStride;\n\n        for ( ; index < length; index ++ ) {\n\n          array.push( sourceArray[ index ] );\n\n        }\n\n      }\n\n      var sourceArray = source.array;\n      var sourceStride = source.stride;\n\n      if ( primitive.vcount !== undefined ) {\n\n        var index = 0;\n\n        for ( var i = 0, l = vcount.length; i < l; i ++ ) {\n\n          var count = vcount[ i ];\n\n          if ( count === 4 ) {\n\n            var a = index + stride * 0;\n            var b = index + stride * 1;\n            var c = index + stride * 2;\n            var d = index + stride * 3;\n\n            pushVector( a ); pushVector( b ); pushVector( d );\n            pushVector( b ); pushVector( c ); pushVector( d );\n\n          } else if ( count === 3 ) {\n\n            var a = index + stride * 0;\n            var b = index + stride * 1;\n            var c = index + stride * 2;\n\n            pushVector( a ); pushVector( b ); pushVector( c );\n\n          } else if ( count > 4 ) {\n\n            for ( var k = 1, kl = ( count - 2 ); k <= kl; k ++ ) {\n\n              var a = index + stride * 0;\n              var b = index + stride * k;\n              var c = index + stride * ( k + 1 );\n\n              pushVector( a ); pushVector( b ); pushVector( c );\n\n            }\n\n          }\n\n          index += stride * count;\n\n        }\n\n      } else {\n\n        for ( var i = 0, l = indices.length; i < l; i += stride ) {\n\n          pushVector( i );\n\n        }\n\n      }\n\n    }\n\n    function getGeometry( id ) {\n\n      return getBuild( library.geometries[ id ], buildGeometry );\n\n    }\n\n    // kinematics\n\n    function parseKinematicsModel( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        joints: {},\n        links: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            parseKinematicsTechniqueCommon( child, data );\n            break;\n\n        }\n\n      }\n\n      library.kinematicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildKinematicsModel( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data;\n\n    }\n\n    function getKinematicsModel( id ) {\n\n      return getBuild( library.kinematicsModels[ id ], buildKinematicsModel );\n\n    }\n\n    function parseKinematicsTechniqueCommon( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'joint':\n            data.joints[ child.getAttribute( 'sid' ) ] = parseKinematicsJoint( child );\n            break;\n\n          case 'link':\n            data.links.push( parseKinematicsLink( child ) );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parseKinematicsJoint( xml ) {\n\n      var data;\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'prismatic':\n          case 'revolute':\n            data = parseKinematicsJointParameter( child );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsJointParameter( xml, data ) {\n\n      var data = {\n        sid: xml.getAttribute( 'sid' ),\n        name: xml.getAttribute( 'name' ) || '',\n        axis: new THREE.Vector3(),\n        limits: {\n          min: 0,\n          max: 0\n        },\n        type: xml.nodeName,\n        static: false,\n        zeroPosition: 0,\n        middlePosition: 0\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'axis':\n            var array = parseFloats( child.textContent );\n            data.axis.fromArray( array );\n            break;\n          case 'limits':\n            var max = child.getElementsByTagName( 'max' )[ 0 ];\n            var min = child.getElementsByTagName( 'min' )[ 0 ];\n\n            data.limits.max = parseFloat( max.textContent );\n            data.limits.min = parseFloat( min.textContent );\n            break;\n\n        }\n\n      }\n\n      // if min is equal to or greater than max, consider the joint static\n\n      if ( data.limits.min >= data.limits.max ) {\n\n        data.static = true;\n\n      }\n\n      // calculate middle position\n\n      data.middlePosition = ( data.limits.min + data.limits.max ) / 2.0;\n\n      return data;\n\n    }\n\n    function parseKinematicsLink( xml ) {\n\n      var data = {\n        sid: xml.getAttribute( 'sid' ),\n        name: xml.getAttribute( 'name' ) || '',\n        attachments: [],\n        transforms: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'attachment_full':\n            data.attachments.push( parseKinematicsAttachment( child ) );\n            break;\n\n          case 'matrix':\n          case 'translate':\n          case 'rotate':\n            data.transforms.push( parseKinematicsTransform( child ) );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsAttachment( xml ) {\n\n      var data = {\n        joint: xml.getAttribute( 'joint' ).split( '/' ).pop(),\n        transforms: [],\n        links: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'link':\n            data.links.push( parseKinematicsLink( child ) );\n            break;\n\n          case 'matrix':\n          case 'translate':\n          case 'rotate':\n            data.transforms.push( parseKinematicsTransform( child ) );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function parseKinematicsTransform( xml ) {\n\n      var data = {\n        type: xml.nodeName\n      };\n\n      var array = parseFloats( xml.textContent );\n\n      switch ( data.type ) {\n\n        case 'matrix':\n          data.obj = new THREE.Matrix4();\n          data.obj.fromArray( array ).transpose();\n          break;\n\n        case 'translate':\n          data.obj = new THREE.Vector3();\n          data.obj.fromArray( array );\n          break;\n\n        case 'rotate':\n          data.obj = new THREE.Vector3();\n          data.obj.fromArray( array );\n          data.angle = THREE.MathUtils.degToRad( array[ 3 ] );\n          break;\n\n      }\n\n      return data;\n\n    }\n\n    // physics\n\n    function parsePhysicsModel( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        rigidBodies: {}\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'rigid_body':\n            data.rigidBodies[ child.getAttribute( 'name' ) ] = {};\n            parsePhysicsRigidBody( child, data.rigidBodies[ child.getAttribute( 'name' ) ] );\n            break;\n\n        }\n\n      }\n\n      library.physicsModels[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function parsePhysicsRigidBody( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'technique_common':\n            parsePhysicsTechniqueCommon( child, data );\n            break;\n\n        }\n\n      }\n\n    }\n\n    function parsePhysicsTechniqueCommon( xml, data ) {\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'inertia':\n            data.inertia = parseFloats( child.textContent );\n            break;\n\n          case 'mass':\n            data.mass = parseFloats( child.textContent )[ 0 ];\n            break;\n\n        }\n\n      }\n\n    }\n\n    // scene\n\n    function parseKinematicsScene( xml ) {\n\n      var data = {\n        bindJointAxis: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'bind_joint_axis':\n            data.bindJointAxis.push( parseKinematicsBindJointAxis( child ) );\n            break;\n\n        }\n\n      }\n\n      library.kinematicsScenes[ parseId( xml.getAttribute( 'url' ) ) ] = data;\n\n    }\n\n    function parseKinematicsBindJointAxis( xml ) {\n\n      var data = {\n        target: xml.getAttribute( 'target' ).split( '/' ).pop()\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'axis':\n            var param = child.getElementsByTagName( 'param' )[ 0 ];\n            data.axis = param.textContent;\n            var tmpJointIndex = data.axis.split( 'inst_' ).pop().split( 'axis' )[ 0 ];\n            data.jointIndex = tmpJointIndex.substr( 0, tmpJointIndex.length - 1 );\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildKinematicsScene( data ) {\n\n      if ( data.build !== undefined ) return data.build;\n\n      return data;\n\n    }\n\n    function getKinematicsScene( id ) {\n\n      return getBuild( library.kinematicsScenes[ id ], buildKinematicsScene );\n\n    }\n\n    function setupKinematics() {\n\n      var kinematicsModelId = Object.keys( library.kinematicsModels )[ 0 ];\n      var kinematicsSceneId = Object.keys( library.kinematicsScenes )[ 0 ];\n      var visualSceneId = Object.keys( library.visualScenes )[ 0 ];\n\n      if ( kinematicsModelId === undefined || kinematicsSceneId === undefined ) return;\n\n      var kinematicsModel = getKinematicsModel( kinematicsModelId );\n      var kinematicsScene = getKinematicsScene( kinematicsSceneId );\n      var visualScene = getVisualScene( visualSceneId );\n\n      var bindJointAxis = kinematicsScene.bindJointAxis;\n      var jointMap = {};\n\n      for ( var i = 0, l = bindJointAxis.length; i < l; i ++ ) {\n\n        var axis = bindJointAxis[ i ];\n\n        // the result of the following query is an element of type 'translate', 'rotate','scale' or 'matrix'\n\n        var targetElement = collada.querySelector( '[sid=\"' + axis.target + '\"]' );\n\n        if ( targetElement ) {\n\n          // get the parent of the transfrom element\n\n          var parentVisualElement = targetElement.parentElement;\n\n          // connect the joint of the kinematics model with the element in the visual scene\n\n          connect( axis.jointIndex, parentVisualElement );\n\n        }\n\n      }\n\n      function connect( jointIndex, visualElement ) {\n\n        var visualElementName = visualElement.getAttribute( 'name' );\n        var joint = kinematicsModel.joints[ jointIndex ];\n\n        visualScene.traverse( function ( object ) {\n\n          if ( object.name === visualElementName ) {\n\n            jointMap[ jointIndex ] = {\n              object: object,\n              transforms: buildTransformList( visualElement ),\n              joint: joint,\n              position: joint.zeroPosition\n            };\n\n          }\n\n        } );\n\n      }\n\n      var m0 = new THREE.Matrix4();\n\n      kinematics = {\n\n        joints: kinematicsModel && kinematicsModel.joints,\n\n        getJointValue: function ( jointIndex ) {\n\n          var jointData = jointMap[ jointIndex ];\n\n          if ( jointData ) {\n\n            return jointData.position;\n\n          } else {\n\n            console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' doesn\\'t exist.' );\n\n          }\n\n        },\n\n        setJointValue: function ( jointIndex, value ) {\n\n          var jointData = jointMap[ jointIndex ];\n\n          if ( jointData ) {\n\n            var joint = jointData.joint;\n\n            if ( value > joint.limits.max || value < joint.limits.min ) {\n\n              console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' value ' + value + ' outside of limits (min: ' + joint.limits.min + ', max: ' + joint.limits.max + ').' );\n\n            } else if ( joint.static ) {\n\n              console.warn( 'THREE.ColladaLoader: Joint ' + jointIndex + ' is static.' );\n\n            } else {\n\n              var object = jointData.object;\n              var axis = joint.axis;\n              var transforms = jointData.transforms;\n\n              matrix.identity();\n\n              // each update, we have to apply all transforms in the correct order\n\n              for ( var i = 0; i < transforms.length; i ++ ) {\n\n                var transform = transforms[ i ];\n\n                // if there is a connection of the transform node with a joint, apply the joint value\n\n                if ( transform.sid && transform.sid.indexOf( jointIndex ) !== - 1 ) {\n\n                  switch ( joint.type ) {\n\n                    case 'revolute':\n                      matrix.multiply( m0.makeRotationAxis( axis, THREE.MathUtils.degToRad( value ) ) );\n                      break;\n\n                    case 'prismatic':\n                      matrix.multiply( m0.makeTranslation( axis.x * value, axis.y * value, axis.z * value ) );\n                      break;\n\n                    default:\n                      console.warn( 'THREE.ColladaLoader: Unknown joint type: ' + joint.type );\n                      break;\n\n                  }\n\n                } else {\n\n                  switch ( transform.type ) {\n\n                    case 'matrix':\n                      matrix.multiply( transform.obj );\n                      break;\n\n                    case 'translate':\n                      matrix.multiply( m0.makeTranslation( transform.obj.x, transform.obj.y, transform.obj.z ) );\n                      break;\n\n                    case 'scale':\n                      matrix.scale( transform.obj );\n                      break;\n\n                    case 'rotate':\n                      matrix.multiply( m0.makeRotationAxis( transform.obj, transform.angle ) );\n                      break;\n\n                  }\n\n                }\n\n              }\n\n              object.matrix.copy( matrix );\n              object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n              jointMap[ jointIndex ].position = value;\n\n            }\n\n          } else {\n\n            console.log( 'THREE.ColladaLoader: ' + jointIndex + ' does not exist.' );\n\n          }\n\n        }\n\n      };\n\n    }\n\n    function buildTransformList( node ) {\n\n      var transforms = [];\n\n      var xml = collada.querySelector( '[id=\"' + node.id + '\"]' );\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'matrix':\n            var array = parseFloats( child.textContent );\n            var matrix = new THREE.Matrix4().fromArray( array ).transpose();\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: matrix\n            } );\n            break;\n\n          case 'translate':\n          case 'scale':\n            var array = parseFloats( child.textContent );\n            var vector = new THREE.Vector3().fromArray( array );\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: vector\n            } );\n            break;\n\n          case 'rotate':\n            var array = parseFloats( child.textContent );\n            var vector = new THREE.Vector3().fromArray( array );\n            var angle = THREE.MathUtils.degToRad( array[ 3 ] );\n            transforms.push( {\n              sid: child.getAttribute( 'sid' ),\n              type: child.nodeName,\n              obj: vector,\n              angle: angle\n            } );\n            break;\n\n        }\n\n      }\n\n      return transforms;\n\n    }\n\n    // nodes\n\n    function prepareNodes( xml ) {\n\n      var elements = xml.getElementsByTagName( 'node' );\n\n      // ensure all node elements have id attributes\n\n      for ( var i = 0; i < elements.length; i ++ ) {\n\n        var element = elements[ i ];\n\n        if ( element.hasAttribute( 'id' ) === false ) {\n\n          element.setAttribute( 'id', generateId() );\n\n        }\n\n      }\n\n    }\n\n    var matrix = new THREE.Matrix4();\n    var vector = new THREE.Vector3();\n\n    function parseNode( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ) || '',\n        type: xml.getAttribute( 'type' ),\n        id: xml.getAttribute( 'id' ),\n        sid: xml.getAttribute( 'sid' ),\n        matrix: new THREE.Matrix4(),\n        nodes: [],\n        instanceCameras: [],\n        instanceControllers: [],\n        instanceLights: [],\n        instanceGeometries: [],\n        instanceNodes: [],\n        transforms: {}\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        if ( child.nodeType !== 1 ) continue;\n\n        switch ( child.nodeName ) {\n\n          case 'node':\n            data.nodes.push( child.getAttribute( 'id' ) );\n            parseNode( child );\n            break;\n\n          case 'instance_camera':\n            data.instanceCameras.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'instance_controller':\n            data.instanceControllers.push( parseNodeInstance( child ) );\n            break;\n\n          case 'instance_light':\n            data.instanceLights.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'instance_geometry':\n            data.instanceGeometries.push( parseNodeInstance( child ) );\n            break;\n\n          case 'instance_node':\n            data.instanceNodes.push( parseId( child.getAttribute( 'url' ) ) );\n            break;\n\n          case 'matrix':\n            var array = parseFloats( child.textContent );\n            data.matrix.multiply( matrix.fromArray( array ).transpose() );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'translate':\n            var array = parseFloats( child.textContent );\n            vector.fromArray( array );\n            data.matrix.multiply( matrix.makeTranslation( vector.x, vector.y, vector.z ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'rotate':\n            var array = parseFloats( child.textContent );\n            var angle = THREE.MathUtils.degToRad( array[ 3 ] );\n            data.matrix.multiply( matrix.makeRotationAxis( vector.fromArray( array ), angle ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'scale':\n            var array = parseFloats( child.textContent );\n            data.matrix.scale( vector.fromArray( array ) );\n            data.transforms[ child.getAttribute( 'sid' ) ] = child.nodeName;\n            break;\n\n          case 'extra':\n            break;\n\n          default:\n            console.log( child );\n\n        }\n\n      }\n\n      if ( hasNode( data.id ) ) {\n\n        console.warn( 'THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.', data.id );\n\n      } else {\n\n        library.nodes[ data.id ] = data;\n\n      }\n\n      return data;\n\n    }\n\n    function parseNodeInstance( xml ) {\n\n      var data = {\n        id: parseId( xml.getAttribute( 'url' ) ),\n        materials: {},\n        skeletons: []\n      };\n\n      for ( var i = 0; i < xml.childNodes.length; i ++ ) {\n\n        var child = xml.childNodes[ i ];\n\n        switch ( child.nodeName ) {\n\n          case 'bind_material':\n            var instances = child.getElementsByTagName( 'instance_material' );\n\n            for ( var j = 0; j < instances.length; j ++ ) {\n\n              var instance = instances[ j ];\n              var symbol = instance.getAttribute( 'symbol' );\n              var target = instance.getAttribute( 'target' );\n\n              data.materials[ symbol ] = parseId( target );\n\n            }\n\n            break;\n\n          case 'skeleton':\n            data.skeletons.push( parseId( child.textContent ) );\n            break;\n\n          default:\n            break;\n\n        }\n\n      }\n\n      return data;\n\n    }\n\n    function buildSkeleton( skeletons, joints ) {\n\n      var boneData = [];\n      var sortedBoneData = [];\n\n      var i, j, data;\n\n      // a skeleton can have multiple root bones. collada expresses this\n      // situtation with multiple \"skeleton\" tags per controller instance\n\n      for ( i = 0; i < skeletons.length; i ++ ) {\n\n        var skeleton = skeletons[ i ];\n\n        var root;\n\n        if ( hasNode( skeleton ) ) {\n\n          root = getNode( skeleton );\n          buildBoneHierarchy( root, joints, boneData );\n\n        } else if ( hasVisualScene( skeleton ) ) {\n\n          // handle case where the skeleton refers to the visual scene (#13335)\n\n          var visualScene = library.visualScenes[ skeleton ];\n          var children = visualScene.children;\n\n          for ( var j = 0; j < children.length; j ++ ) {\n\n            var child = children[ j ];\n\n            if ( child.type === 'JOINT' ) {\n\n              var root = getNode( child.id );\n              buildBoneHierarchy( root, joints, boneData );\n\n            }\n\n          }\n\n        } else {\n\n          console.error( 'THREE.ColladaLoader: Unable to find root bone of skeleton with ID:', skeleton );\n\n        }\n\n      }\n\n      // sort bone data (the order is defined in the corresponding controller)\n\n      for ( i = 0; i < joints.length; i ++ ) {\n\n        for ( j = 0; j < boneData.length; j ++ ) {\n\n          data = boneData[ j ];\n\n          if ( data.bone.name === joints[ i ].name ) {\n\n            sortedBoneData[ i ] = data;\n            data.processed = true;\n            break;\n\n          }\n\n        }\n\n      }\n\n      // add unprocessed bone data at the end of the list\n\n      for ( i = 0; i < boneData.length; i ++ ) {\n\n        data = boneData[ i ];\n\n        if ( data.processed === false ) {\n\n          sortedBoneData.push( data );\n          data.processed = true;\n\n        }\n\n      }\n\n      // setup arrays for skeleton creation\n\n      var bones = [];\n      var boneInverses = [];\n\n      for ( i = 0; i < sortedBoneData.length; i ++ ) {\n\n        data = sortedBoneData[ i ];\n\n        bones.push( data.bone );\n        boneInverses.push( data.boneInverse );\n\n      }\n\n      return new THREE.Skeleton( bones, boneInverses );\n\n    }\n\n    function buildBoneHierarchy( root, joints, boneData ) {\n\n      // setup bone data from visual scene\n\n      root.traverse( function ( object ) {\n\n        if ( object.isBone === true ) {\n\n          var boneInverse;\n\n          // retrieve the boneInverse from the controller data\n\n          for ( var i = 0; i < joints.length; i ++ ) {\n\n            var joint = joints[ i ];\n\n            if ( joint.name === object.name ) {\n\n              boneInverse = joint.boneInverse;\n              break;\n\n            }\n\n          }\n\n          if ( boneInverse === undefined ) {\n\n            // Unfortunately, there can be joints in the visual scene that are not part of the\n            // corresponding controller. In this case, we have to create a dummy boneInverse matrix\n            // for the respective bone. This bone won't affect any vertices, because there are no skin indices\n            // and weights defined for it. But we still have to add the bone to the sorted bone list in order to\n            // ensure a correct animation of the model.\n\n            boneInverse = new THREE.Matrix4();\n\n          }\n\n          boneData.push( { bone: object, boneInverse: boneInverse, processed: false } );\n\n        }\n\n      } );\n\n    }\n\n    function buildNode( data ) {\n\n      var objects = [];\n\n      var matrix = data.matrix;\n      var nodes = data.nodes;\n      var type = data.type;\n      var instanceCameras = data.instanceCameras;\n      var instanceControllers = data.instanceControllers;\n      var instanceLights = data.instanceLights;\n      var instanceGeometries = data.instanceGeometries;\n      var instanceNodes = data.instanceNodes;\n\n      // nodes\n\n      for ( var i = 0, l = nodes.length; i < l; i ++ ) {\n\n        objects.push( getNode( nodes[ i ] ) );\n\n      }\n\n      // instance cameras\n\n      for ( var i = 0, l = instanceCameras.length; i < l; i ++ ) {\n\n        var instanceCamera = getCamera( instanceCameras[ i ] );\n\n        if ( instanceCamera !== null ) {\n\n          objects.push( instanceCamera.clone() );\n\n        }\n\n      }\n\n      // instance controllers\n\n      for ( var i = 0, l = instanceControllers.length; i < l; i ++ ) {\n\n        var instance = instanceControllers[ i ];\n        var controller = getController( instance.id );\n        var geometries = getGeometry( controller.id );\n        var newObjects = buildObjects( geometries, instance.materials );\n\n        var skeletons = instance.skeletons;\n        var joints = controller.skin.joints;\n\n        var skeleton = buildSkeleton( skeletons, joints );\n\n        for ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n          var object = newObjects[ j ];\n\n          if ( object.isSkinnedMesh ) {\n\n            object.bind( skeleton, controller.skin.bindMatrix );\n            object.normalizeSkinWeights();\n\n          }\n\n          objects.push( object );\n\n        }\n\n      }\n\n      // instance lights\n\n      for ( var i = 0, l = instanceLights.length; i < l; i ++ ) {\n\n        var instanceLight = getLight( instanceLights[ i ] );\n\n        if ( instanceLight !== null ) {\n\n          objects.push( instanceLight.clone() );\n\n        }\n\n      }\n\n      // instance geometries\n\n      for ( var i = 0, l = instanceGeometries.length; i < l; i ++ ) {\n\n        var instance = instanceGeometries[ i ];\n\n        // a single geometry instance in collada can lead to multiple object3Ds.\n        // this is the case when primitives are combined like triangles and lines\n\n        var geometries = getGeometry( instance.id );\n        var newObjects = buildObjects( geometries, instance.materials );\n\n        for ( var j = 0, jl = newObjects.length; j < jl; j ++ ) {\n\n          objects.push( newObjects[ j ] );\n\n        }\n\n      }\n\n      // instance nodes\n\n      for ( var i = 0, l = instanceNodes.length; i < l; i ++ ) {\n\n        objects.push( getNode( instanceNodes[ i ] ).clone() );\n\n      }\n\n      var object;\n\n      if ( nodes.length === 0 && objects.length === 1 ) {\n\n        object = objects[ 0 ];\n\n      } else {\n\n        object = ( type === 'JOINT' ) ? new THREE.Bone() : new THREE.Group();\n\n        for ( var i = 0; i < objects.length; i ++ ) {\n\n          object.add( objects[ i ] );\n\n        }\n\n      }\n\n      if ( object.name === '' ) {\n\n        object.name = ( type === 'JOINT' ) ? data.sid : data.name;\n\n      }\n\n      object.matrix.copy( matrix );\n      object.matrix.decompose( object.position, object.quaternion, object.scale );\n\n      return object;\n\n    }\n\n    var fallbackMaterial = new THREE.MeshBasicMaterial( { color: 0xff00ff } );\n\n    function resolveMaterialBinding( keys, instanceMaterials ) {\n\n      var materials = [];\n\n      for ( var i = 0, l = keys.length; i < l; i ++ ) {\n\n        var id = instanceMaterials[ keys[ i ] ];\n\n        if ( id === undefined ) {\n\n          console.warn( 'THREE.ColladaLoader: Material with key %s not found. Apply fallback material.', keys[ i ] );\n          materials.push( fallbackMaterial );\n\n        } else {\n\n          materials.push( getMaterial( id ) );\n\n        }\n\n      }\n\n      return materials;\n\n    }\n\n    function buildObjects( geometries, instanceMaterials ) {\n\n      var objects = [];\n\n      for ( var type in geometries ) {\n\n        var geometry = geometries[ type ];\n\n        var materials = resolveMaterialBinding( geometry.materialKeys, instanceMaterials );\n\n        // handle case if no materials are defined\n\n        if ( materials.length === 0 ) {\n\n          if ( type === 'lines' || type === 'linestrips' ) {\n\n            materials.push( new THREE.LineBasicMaterial() );\n\n          } else {\n\n            materials.push( new THREE.MeshPhongMaterial() );\n\n          }\n\n        }\n\n        // regard skinning\n\n        var skinning = ( geometry.data.attributes.skinIndex !== undefined );\n\n        if ( skinning ) {\n\n          for ( var i = 0, l = materials.length; i < l; i ++ ) {\n\n            materials[ i ].skinning = true;\n\n          }\n\n        }\n\n        // choose between a single or multi materials (material array)\n\n        var material = ( materials.length === 1 ) ? materials[ 0 ] : materials;\n\n        // now create a specific 3D object\n\n        var object;\n\n        switch ( type ) {\n\n          case 'lines':\n            object = new THREE.LineSegments( geometry.data, material );\n            break;\n\n          case 'linestrips':\n            object = new THREE.Line( geometry.data, material );\n            break;\n\n          case 'triangles':\n          case 'polylist':\n            if ( skinning ) {\n\n              object = new THREE.SkinnedMesh( geometry.data, material );\n\n            } else {\n\n              object = new THREE.Mesh( geometry.data, material );\n\n            }\n            break;\n\n        }\n\n        objects.push( object );\n\n      }\n\n      return objects;\n\n    }\n\n    function hasNode( id ) {\n\n      return library.nodes[ id ] !== undefined;\n\n    }\n\n    function getNode( id ) {\n\n      return getBuild( library.nodes[ id ], buildNode );\n\n    }\n\n    // visual scenes\n\n    function parseVisualScene( xml ) {\n\n      var data = {\n        name: xml.getAttribute( 'name' ),\n        children: []\n      };\n\n      prepareNodes( xml );\n\n      var elements = getElementsByTagName( xml, 'node' );\n\n      for ( var i = 0; i < elements.length; i ++ ) {\n\n        data.children.push( parseNode( elements[ i ] ) );\n\n      }\n\n      library.visualScenes[ xml.getAttribute( 'id' ) ] = data;\n\n    }\n\n    function buildVisualScene( data ) {\n\n      var group = new THREE.Group();\n      group.name = data.name;\n\n      var children = data.children;\n\n      for ( var i = 0; i < children.length; i ++ ) {\n\n        var child = children[ i ];\n\n        group.add( getNode( child.id ) );\n\n      }\n\n      return group;\n\n    }\n\n    function hasVisualScene( id ) {\n\n      return library.visualScenes[ id ] !== undefined;\n\n    }\n\n    function getVisualScene( id ) {\n\n      return getBuild( library.visualScenes[ id ], buildVisualScene );\n\n    }\n\n    // scenes\n\n    function parseScene( xml ) {\n\n      var instance = getElementsByTagName( xml, 'instance_visual_scene' )[ 0 ];\n      return getVisualScene( parseId( instance.getAttribute( 'url' ) ) );\n\n    }\n\n    function setupAnimations() {\n\n      var clips = library.clips;\n\n      if ( isEmpty( clips ) === true ) {\n\n        if ( isEmpty( library.animations ) === false ) {\n\n          // if there are animations but no clips, we create a default clip for playback\n\n          var tracks = [];\n\n          for ( var id in library.animations ) {\n\n            var animationTracks = getAnimation( id );\n\n            for ( var i = 0, l = animationTracks.length; i < l; i ++ ) {\n\n              tracks.push( animationTracks[ i ] );\n\n            }\n\n          }\n\n          animations.push( new THREE.AnimationClip( 'default', - 1, tracks ) );\n\n        }\n\n      } else {\n\n        for ( var id in clips ) {\n\n          animations.push( getAnimationClip( id ) );\n\n        }\n\n      }\n\n    }\n\n    if ( text.length === 0 ) {\n\n      return { scene: new THREE.Scene() };\n\n    }\n\n    var xml = new DOMParser().parseFromString( text, 'application/xml' );\n\n    var collada = getElementsByTagName( xml, 'COLLADA' )[ 0 ];\n\n    // metadata\n\n    var version = collada.getAttribute( 'version' );\n    console.log( 'THREE.ColladaLoader: File version', version );\n\n    var asset = parseAsset( getElementsByTagName( collada, 'asset' )[ 0 ] );\n    var textureLoader = new THREE.TextureLoader( this.manager );\n    textureLoader.setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n    var tgaLoader;\n\n    if ( THREE.TGALoader ) {\n\n      tgaLoader = new THREE.TGALoader( this.manager );\n      tgaLoader.setPath( this.resourcePath || path );\n\n    }\n\n    //\n\n    var animations = [];\n    var kinematics = {};\n    var count = 0;\n\n    //\n\n    var library = {\n      animations: {},\n      clips: {},\n      controllers: {},\n      images: {},\n      effects: {},\n      materials: {},\n      cameras: {},\n      lights: {},\n      geometries: {},\n      nodes: {},\n      visualScenes: {},\n      kinematicsModels: {},\n      physicsModels: {},\n      kinematicsScenes: {}\n    };\n\n    parseLibrary( collada, 'library_animations', 'animation', parseAnimation );\n    parseLibrary( collada, 'library_animation_clips', 'animation_clip', parseAnimationClip );\n    parseLibrary( collada, 'library_controllers', 'controller', parseController );\n    parseLibrary( collada, 'library_images', 'image', parseImage );\n    parseLibrary( collada, 'library_effects', 'effect', parseEffect );\n    parseLibrary( collada, 'library_materials', 'material', parseMaterial );\n    parseLibrary( collada, 'library_cameras', 'camera', parseCamera );\n    parseLibrary( collada, 'library_lights', 'light', parseLight );\n    parseLibrary( collada, 'library_geometries', 'geometry', parseGeometry );\n    parseLibrary( collada, 'library_nodes', 'node', parseNode );\n    parseLibrary( collada, 'library_visual_scenes', 'visual_scene', parseVisualScene );\n    parseLibrary( collada, 'library_kinematics_models', 'kinematics_model', parseKinematicsModel );\n    parseLibrary( collada, 'library_physics_models', 'physics_model', parsePhysicsModel );\n    parseLibrary( collada, 'scene', 'instance_kinematics_scene', parseKinematicsScene );\n\n    buildLibrary( library.animations, buildAnimation );\n    buildLibrary( library.clips, buildAnimationClip );\n    buildLibrary( library.controllers, buildController );\n    buildLibrary( library.images, buildImage );\n    buildLibrary( library.effects, buildEffect );\n    buildLibrary( library.materials, buildMaterial );\n    buildLibrary( library.cameras, buildCamera );\n    buildLibrary( library.lights, buildLight );\n    buildLibrary( library.geometries, buildGeometry );\n    buildLibrary( library.visualScenes, buildVisualScene );\n\n    setupAnimations();\n    setupKinematics();\n\n    var scene = parseScene( getElementsByTagName( collada, 'scene' )[ 0 ] );\n\n    if ( asset.upAxis === 'Z_UP' ) {\n\n      scene.quaternion.setFromEuler( new THREE.Euler( - Math.PI / 2, 0, 0 ) );\n\n    }\n\n    scene.scale.multiplyScalar( asset.unit );\n\n    return {\n      animations: animations,\n      kinematics: kinematics,\n      library: library,\n      scene: scene\n    };\n\n  }\n\n};\n","module.exports = Object.assign(function GamepadButton () {}, {\n\tFACE_1: 0,\n\tFACE_2: 1,\n\tFACE_3: 2,\n\tFACE_4: 3,\n\n\tL_SHOULDER_1: 4,\n\tR_SHOULDER_1: 5,\n\tL_SHOULDER_2: 6,\n\tR_SHOULDER_2: 7,\n\n\tSELECT: 8,\n\tSTART: 9,\n\n\tDPAD_UP: 12,\n\tDPAD_DOWN: 13,\n\tDPAD_LEFT: 14,\n\tDPAD_RIGHT: 15,\n\n\tVENDOR: 16,\n});\n","function GamepadButtonEvent (type, index, details) {\n  this.type = type;\n  this.index = index;\n  this.pressed = details.pressed;\n  this.value = details.value;\n}\n\nmodule.exports = GamepadButtonEvent;\n","/**\n * Source: https://github.com/Adobe-Marketing-Cloud/fetch-script\n */\n\nfunction getScriptId() {\n  return 'script_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n}\n\nfunction createScript(url, id) {\n  var script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.async = true;\n  script.id = id;\n  script.src = url;\n\n  return script;\n}\n\nfunction removeScript(id) {\n  const script = document.getElementById(id);\n  const parent = script.parentNode;\n\n  try {\n    parent && parent.removeChild(script);\n  } catch (e) {\n    // ignore\n  }\n}\n\nfunction appendScript(script) {\n  const firstScript = document.getElementsByTagName('script')[0];\n  firstScript.parentNode.insertBefore(script, firstScript);\n}\n\nfunction fetchScriptInternal(url, options, Promise) {\n  return new Promise(function(resolve, reject) {\n    const timeout = options.timeout || 5000;\n    const scriptId = getScriptId();\n    const script = createScript(url, scriptId);\n\n    const timeoutId = setTimeout(function() {\n      reject(new Error('Script request to ' + url + ' timed out'));\n\n      removeScript(scriptId);\n    }, timeout);\n\n    const disableTimeout = function(timeoutId) { clearTimeout(timeoutId); };\n\n    script.addEventListener('load', function(e) {\n      resolve({ok: true});\n\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n\n    script.addEventListener('error', function(e) {\n      reject(new Error('Script request to ' + url + ' failed ' + e));\n\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n\n    appendScript(script);\n  });\n}\n\nfunction fetchScript(settings) {\n  settings = settings || {};\n  return function (url, options) {\n    options = options || {};\n    return fetchScriptInternal(url, options, settings.Promise || Promise);\n  };\n}\n\nmodule.exports = fetchScript;\n","/**\n * Polyfill for the additional KeyboardEvent properties defined in the D3E and\n * D4E draft specifications, by @inexorabletash.\n *\n * See: https://github.com/inexorabletash/polyfill\n */\n(function(global) {\n  var nativeKeyboardEvent = ('KeyboardEvent' in global);\n  if (!nativeKeyboardEvent)\n    global.KeyboardEvent = function KeyboardEvent() { throw TypeError('Illegal constructor'); };\n\n  if (!('DOM_KEY_LOCATION_STANDARD' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_STANDARD = 0x00; // Default or unknown location\n  if (!('DOM_KEY_LOCATION_LEFT' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_LEFT          = 0x01; // e.g. Left Alt key\n  if (!('DOM_KEY_LOCATION_RIGHT' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_RIGHT         = 0x02; // e.g. Right Alt key\n  if (!('DOM_KEY_LOCATION_NUMPAD' in global.KeyboardEvent)) global.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD        = 0x03; // e.g. Numpad 0 or +\n\n  var STANDARD = window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,\n      LEFT = window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,\n      RIGHT = window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,\n      NUMPAD = window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;\n\n  //--------------------------------------------------------------------\n  //\n  // Utilities\n  //\n  //--------------------------------------------------------------------\n\n  function contains(s, ss) { return String(s).indexOf(ss) !== -1; }\n\n  var os = (function() {\n    if (contains(navigator.platform, 'Win')) { return 'win'; }\n    if (contains(navigator.platform, 'Mac')) { return 'mac'; }\n    if (contains(navigator.platform, 'CrOS')) { return 'cros'; }\n    if (contains(navigator.platform, 'Linux')) { return 'linux'; }\n    if (contains(navigator.userAgent, 'iPad') || contains(navigator.platform, 'iPod') || contains(navigator.platform, 'iPhone')) { return 'ios'; }\n    return '';\n  } ());\n\n  var browser = (function() {\n    if (contains(navigator.userAgent, 'Chrome/')) { return 'chrome'; }\n    if (contains(navigator.vendor, 'Apple')) { return 'safari'; }\n    if (contains(navigator.userAgent, 'MSIE')) { return 'ie'; }\n    if (contains(navigator.userAgent, 'Gecko/')) { return 'moz'; }\n    if (contains(navigator.userAgent, 'Opera/')) { return 'opera'; }\n    return '';\n  } ());\n\n  var browser_os = browser + '-' + os;\n\n  function mergeIf(baseTable, select, table) {\n    if (browser_os === select || browser === select || os === select) {\n      Object.keys(table).forEach(function(keyCode) {\n        baseTable[keyCode] = table[keyCode];\n      });\n    }\n  }\n\n  function remap(o, key) {\n    var r = {};\n    Object.keys(o).forEach(function(k) {\n      var item = o[k];\n      if (key in item) {\n        r[item[key]] = item;\n      }\n    });\n    return r;\n  }\n\n  function invert(o) {\n    var r = {};\n    Object.keys(o).forEach(function(k) {\n      r[o[k]] = k;\n    });\n    return r;\n  }\n\n  //--------------------------------------------------------------------\n  //\n  // Generic Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // \"keyInfo\" is a dictionary:\n  //   code: string - name from DOM Level 3 KeyboardEvent code Values\n  //     https://dvcs.w3.org/hg/dom3events/raw-file/tip/html/DOM3Events-code.html\n  //   location (optional): number - one of the DOM_KEY_LOCATION values\n  //   keyCap (optional): string - keyboard label in en-US locale\n  // USB code Usage ID from page 0x07 unless otherwise noted (Informative)\n\n  // Map of keyCode to keyInfo\n  var keyCodeToInfoTable = {\n    // 0x01 - VK_LBUTTON\n    // 0x02 - VK_RBUTTON\n    0x03: { code: 'Cancel' }, // [USB: 0x9b] char \\x0018 ??? (Not in D3E)\n    // 0x04 - VK_MBUTTON\n    // 0x05 - VK_XBUTTON1\n    // 0x06 - VK_XBUTTON2\n    0x06: { code: 'Help' }, // [USB: 0x75] ???\n    // 0x07 - undefined\n    0x08: { code: 'Backspace' }, // [USB: 0x2a] Labelled Delete on Macintosh keyboards.\n    0x09: { code: 'Tab' }, // [USB: 0x2b]\n    // 0x0A-0x0B - reserved\n    0X0C: { code: 'Clear' }, // [USB: 0x9c] NumPad Center (Not in D3E)\n    0X0D: { code: 'Enter' }, // [USB: 0x28]\n    // 0x0E-0x0F - undefined\n\n    0x10: { code: 'Shift' },\n    0x11: { code: 'Control' },\n    0x12: { code: 'Alt' },\n    0x13: { code: 'Pause' }, // [USB: 0x48]\n    0x14: { code: 'CapsLock' }, // [USB: 0x39]\n    0x15: { code: 'KanaMode' }, // [USB: 0x88] - \"HangulMode\" for Korean layout\n    0x16: { code: 'HangulMode' }, // [USB: 0x90] 0x15 as well in MSDN VK table ???\n    0x17: { code: 'JunjaMode' }, // (Not in D3E)\n    0x18: { code: 'FinalMode' }, // (Not in D3E)\n    0x19: { code: 'KanjiMode' }, // [USB: 0x91] - \"HanjaMode\" for Korean layout\n    // 0x1A - undefined\n    0x1B: { code: 'Escape' }, // [USB: 0x29]\n    0x1C: { code: 'Convert' }, // [USB: 0x8a]\n    0x1D: { code: 'NonConvert' }, // [USB: 0x8b]\n    0x1E: { code: 'Accept' }, // (Not in D3E)\n    0x1F: { code: 'ModeChange' }, // (Not in D3E)\n\n    0x20: { code: 'Space' }, // [USB: 0x2c]\n    0x21: { code: 'PageUp' }, // [USB: 0x4b]\n    0x22: { code: 'PageDown' }, // [USB: 0x4e]\n    0x23: { code: 'End' }, // [USB: 0x4d]\n    0x24: { code: 'Home' }, // [USB: 0x4a]\n    0x25: { code: 'ArrowLeft' }, // [USB: 0x50]\n    0x26: { code: 'ArrowUp' }, // [USB: 0x52]\n    0x27: { code: 'ArrowRight' }, // [USB: 0x4f]\n    0x28: { code: 'ArrowDown' }, // [USB: 0x51]\n    0x29: { code: 'Select' }, // (Not in D3E)\n    0x2A: { code: 'Print' }, // (Not in D3E)\n    0x2B: { code: 'Execute' }, // [USB: 0x74] (Not in D3E)\n    0x2C: { code: 'PrintScreen' }, // [USB: 0x46]\n    0x2D: { code: 'Insert' }, // [USB: 0x49]\n    0x2E: { code: 'Delete' }, // [USB: 0x4c]\n    0x2F: { code: 'Help' }, // [USB: 0x75] ???\n\n    0x30: { code: 'Digit0', keyCap: '0' }, // [USB: 0x27] 0)\n    0x31: { code: 'Digit1', keyCap: '1' }, // [USB: 0x1e] 1!\n    0x32: { code: 'Digit2', keyCap: '2' }, // [USB: 0x1f] 2@\n    0x33: { code: 'Digit3', keyCap: '3' }, // [USB: 0x20] 3#\n    0x34: { code: 'Digit4', keyCap: '4' }, // [USB: 0x21] 4$\n    0x35: { code: 'Digit5', keyCap: '5' }, // [USB: 0x22] 5%\n    0x36: { code: 'Digit6', keyCap: '6' }, // [USB: 0x23] 6^\n    0x37: { code: 'Digit7', keyCap: '7' }, // [USB: 0x24] 7&\n    0x38: { code: 'Digit8', keyCap: '8' }, // [USB: 0x25] 8*\n    0x39: { code: 'Digit9', keyCap: '9' }, // [USB: 0x26] 9(\n    // 0x3A-0x40 - undefined\n\n    0x41: { code: 'KeyA', keyCap: 'a' }, // [USB: 0x04]\n    0x42: { code: 'KeyB', keyCap: 'b' }, // [USB: 0x05]\n    0x43: { code: 'KeyC', keyCap: 'c' }, // [USB: 0x06]\n    0x44: { code: 'KeyD', keyCap: 'd' }, // [USB: 0x07]\n    0x45: { code: 'KeyE', keyCap: 'e' }, // [USB: 0x08]\n    0x46: { code: 'KeyF', keyCap: 'f' }, // [USB: 0x09]\n    0x47: { code: 'KeyG', keyCap: 'g' }, // [USB: 0x0a]\n    0x48: { code: 'KeyH', keyCap: 'h' }, // [USB: 0x0b]\n    0x49: { code: 'KeyI', keyCap: 'i' }, // [USB: 0x0c]\n    0x4A: { code: 'KeyJ', keyCap: 'j' }, // [USB: 0x0d]\n    0x4B: { code: 'KeyK', keyCap: 'k' }, // [USB: 0x0e]\n    0x4C: { code: 'KeyL', keyCap: 'l' }, // [USB: 0x0f]\n    0x4D: { code: 'KeyM', keyCap: 'm' }, // [USB: 0x10]\n    0x4E: { code: 'KeyN', keyCap: 'n' }, // [USB: 0x11]\n    0x4F: { code: 'KeyO', keyCap: 'o' }, // [USB: 0x12]\n\n    0x50: { code: 'KeyP', keyCap: 'p' }, // [USB: 0x13]\n    0x51: { code: 'KeyQ', keyCap: 'q' }, // [USB: 0x14]\n    0x52: { code: 'KeyR', keyCap: 'r' }, // [USB: 0x15]\n    0x53: { code: 'KeyS', keyCap: 's' }, // [USB: 0x16]\n    0x54: { code: 'KeyT', keyCap: 't' }, // [USB: 0x17]\n    0x55: { code: 'KeyU', keyCap: 'u' }, // [USB: 0x18]\n    0x56: { code: 'KeyV', keyCap: 'v' }, // [USB: 0x19]\n    0x57: { code: 'KeyW', keyCap: 'w' }, // [USB: 0x1a]\n    0x58: { code: 'KeyX', keyCap: 'x' }, // [USB: 0x1b]\n    0x59: { code: 'KeyY', keyCap: 'y' }, // [USB: 0x1c]\n    0x5A: { code: 'KeyZ', keyCap: 'z' }, // [USB: 0x1d]\n    0x5B: { code: 'OSLeft', location: LEFT }, // [USB: 0xe3]\n    0x5C: { code: 'OSRight', location: RIGHT }, // [USB: 0xe7]\n    0x5D: { code: 'ContextMenu' }, // [USB: 0x65] Context Menu\n    // 0x5E - reserved\n    0x5F: { code: 'Standby' }, // [USB: 0x82] Sleep\n\n    0x60: { code: 'Numpad0', keyCap: '0', location: NUMPAD }, // [USB: 0x62]\n    0x61: { code: 'Numpad1', keyCap: '1', location: NUMPAD }, // [USB: 0x59]\n    0x62: { code: 'Numpad2', keyCap: '2', location: NUMPAD }, // [USB: 0x5a]\n    0x63: { code: 'Numpad3', keyCap: '3', location: NUMPAD }, // [USB: 0x5b]\n    0x64: { code: 'Numpad4', keyCap: '4', location: NUMPAD }, // [USB: 0x5c]\n    0x65: { code: 'Numpad5', keyCap: '5', location: NUMPAD }, // [USB: 0x5d]\n    0x66: { code: 'Numpad6', keyCap: '6', location: NUMPAD }, // [USB: 0x5e]\n    0x67: { code: 'Numpad7', keyCap: '7', location: NUMPAD }, // [USB: 0x5f]\n    0x68: { code: 'Numpad8', keyCap: '8', location: NUMPAD }, // [USB: 0x60]\n    0x69: { code: 'Numpad9', keyCap: '9', location: NUMPAD }, // [USB: 0x61]\n    0x6A: { code: 'NumpadMultiply', keyCap: '*', location: NUMPAD }, // [USB: 0x55]\n    0x6B: { code: 'NumpadAdd', keyCap: '+', location: NUMPAD }, // [USB: 0x57]\n    0x6C: { code: 'NumpadComma', keyCap: ',', location: NUMPAD }, // [USB: 0x85]\n    0x6D: { code: 'NumpadSubtract', keyCap: '-', location: NUMPAD }, // [USB: 0x56]\n    0x6E: { code: 'NumpadDecimal', keyCap: '.', location: NUMPAD }, // [USB: 0x63]\n    0x6F: { code: 'NumpadDivide', keyCap: '/', location: NUMPAD }, // [USB: 0x54]\n\n    0x70: { code: 'F1' }, // [USB: 0x3a]\n    0x71: { code: 'F2' }, // [USB: 0x3b]\n    0x72: { code: 'F3' }, // [USB: 0x3c]\n    0x73: { code: 'F4' }, // [USB: 0x3d]\n    0x74: { code: 'F5' }, // [USB: 0x3e]\n    0x75: { code: 'F6' }, // [USB: 0x3f]\n    0x76: { code: 'F7' }, // [USB: 0x40]\n    0x77: { code: 'F8' }, // [USB: 0x41]\n    0x78: { code: 'F9' }, // [USB: 0x42]\n    0x79: { code: 'F10' }, // [USB: 0x43]\n    0x7A: { code: 'F11' }, // [USB: 0x44]\n    0x7B: { code: 'F12' }, // [USB: 0x45]\n    0x7C: { code: 'F13' }, // [USB: 0x68]\n    0x7D: { code: 'F14' }, // [USB: 0x69]\n    0x7E: { code: 'F15' }, // [USB: 0x6a]\n    0x7F: { code: 'F16' }, // [USB: 0x6b]\n\n    0x80: { code: 'F17' }, // [USB: 0x6c]\n    0x81: { code: 'F18' }, // [USB: 0x6d]\n    0x82: { code: 'F19' }, // [USB: 0x6e]\n    0x83: { code: 'F20' }, // [USB: 0x6f]\n    0x84: { code: 'F21' }, // [USB: 0x70]\n    0x85: { code: 'F22' }, // [USB: 0x71]\n    0x86: { code: 'F23' }, // [USB: 0x72]\n    0x87: { code: 'F24' }, // [USB: 0x73]\n    // 0x88-0x8F - unassigned\n\n    0x90: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n    0x91: { code: 'ScrollLock' }, // [USB: 0x47]\n    // 0x92-0x96 - OEM specific\n    // 0x97-0x9F - unassigned\n\n    // NOTE: 0xA0-0xA5 usually mapped to 0x10-0x12 in browsers\n    0xA0: { code: 'ShiftLeft', location: LEFT }, // [USB: 0xe1]\n    0xA1: { code: 'ShiftRight', location: RIGHT }, // [USB: 0xe5]\n    0xA2: { code: 'ControlLeft', location: LEFT }, // [USB: 0xe0]\n    0xA3: { code: 'ControlRight', location: RIGHT }, // [USB: 0xe4]\n    0xA4: { code: 'AltLeft', location: LEFT }, // [USB: 0xe2]\n    0xA5: { code: 'AltRight', location: RIGHT }, // [USB: 0xe6]\n\n    0xA6: { code: 'BrowserBack' }, // [USB: 0x0c/0x0224]\n    0xA7: { code: 'BrowserForward' }, // [USB: 0x0c/0x0225]\n    0xA8: { code: 'BrowserRefresh' }, // [USB: 0x0c/0x0227]\n    0xA9: { code: 'BrowserStop' }, // [USB: 0x0c/0x0226]\n    0xAA: { code: 'BrowserSearch' }, // [USB: 0x0c/0x0221]\n    0xAB: { code: 'BrowserFavorites' }, // [USB: 0x0c/0x0228]\n    0xAC: { code: 'BrowserHome' }, // [USB: 0x0c/0x0222]\n    0xAD: { code: 'VolumeMute' }, // [USB: 0x7f]\n    0xAE: { code: 'VolumeDown' }, // [USB: 0x81]\n    0xAF: { code: 'VolumeUp' }, // [USB: 0x80]\n\n    0xB0: { code: 'MediaTrackNext' }, // [USB: 0x0c/0x00b5]\n    0xB1: { code: 'MediaTrackPrevious' }, // [USB: 0x0c/0x00b6]\n    0xB2: { code: 'MediaStop' }, // [USB: 0x0c/0x00b7]\n    0xB3: { code: 'MediaPlayPause' }, // [USB: 0x0c/0x00cd]\n    0xB4: { code: 'LaunchMail' }, // [USB: 0x0c/0x018a]\n    0xB5: { code: 'MediaSelect' },\n    0xB6: { code: 'LaunchApp1' },\n    0xB7: { code: 'LaunchApp2' },\n    // 0xB8-0xB9 - reserved\n    0xBA: { code: 'Semicolon',  keyCap: ';' }, // [USB: 0x33] ;: (US Standard 101)\n    0xBB: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n    0xBC: { code: 'Comma', keyCap: ',' }, // [USB: 0x36] ,<\n    0xBD: { code: 'Minus', keyCap: '-' }, // [USB: 0x2d] -_\n    0xBE: { code: 'Period', keyCap: '.' }, // [USB: 0x37] .>\n    0xBF: { code: 'Slash', keyCap: '/' }, // [USB: 0x38] /? (US Standard 101)\n\n    0xC0: { code: 'Backquote', keyCap: '`' }, // [USB: 0x35] `~ (US Standard 101)\n    // 0xC1-0xCF - reserved\n\n    // 0xD0-0xD7 - reserved\n    // 0xD8-0xDA - unassigned\n    0xDB: { code: 'BracketLeft', keyCap: '[' }, // [USB: 0x2f] [{ (US Standard 101)\n    0xDC: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n    0xDD: { code: 'BracketRight', keyCap: ']' }, // [USB: 0x30] ]} (US Standard 101)\n    0xDE: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n    // 0xDF - miscellaneous/varies\n\n    // 0xE0 - reserved\n    // 0xE1 - OEM specific\n    0xE2: { code: 'IntlBackslash',  keyCap: '\\\\' }, // [USB: 0x64] \\| (UK Standard 102)\n    // 0xE3-0xE4 - OEM specific\n    0xE5: { code: 'Process' }, // (Not in D3E)\n    // 0xE6 - OEM specific\n    // 0xE7 - VK_PACKET\n    // 0xE8 - unassigned\n    // 0xE9-0xEF - OEM specific\n\n    // 0xF0-0xF5 - OEM specific\n    0xF6: { code: 'Attn' }, // [USB: 0x9a] (Not in D3E)\n    0xF7: { code: 'CrSel' }, // [USB: 0xa3] (Not in D3E)\n    0xF8: { code: 'ExSel' }, // [USB: 0xa4] (Not in D3E)\n    0xF9: { code: 'EraseEof' }, // (Not in D3E)\n    0xFA: { code: 'Play' }, // (Not in D3E)\n    0xFB: { code: 'ZoomToggle' }, // (Not in D3E)\n    // 0xFC - VK_NONAME - reserved\n    // 0xFD - VK_PA1\n    0xFE: { code: 'Clear' } // [USB: 0x9c] (Not in D3E)\n  };\n\n  // No legacy keyCode, but listed in D3E:\n\n  // code: usb\n  // 'IntlHash': 0x070032,\n  // 'IntlRo': 0x070087,\n  // 'IntlYen': 0x070089,\n  // 'NumpadBackspace': 0x0700bb,\n  // 'NumpadClear': 0x0700d8,\n  // 'NumpadClearEntry': 0x0700d9,\n  // 'NumpadMemoryAdd': 0x0700d3,\n  // 'NumpadMemoryClear': 0x0700d2,\n  // 'NumpadMemoryRecall': 0x0700d1,\n  // 'NumpadMemoryStore': 0x0700d0,\n  // 'NumpadMemorySubtract': 0x0700d4,\n  // 'NumpadParenLeft': 0x0700b6,\n  // 'NumpadParenRight': 0x0700b7,\n\n  //--------------------------------------------------------------------\n  //\n  // Browser/OS Specific Mappings\n  //\n  //--------------------------------------------------------------------\n\n  mergeIf(keyCodeToInfoTable,\n          'moz', {\n            0x3B: { code: 'Semicolon', keyCap: ';' }, // [USB: 0x33] ;: (US Standard 101)\n            0x3D: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n            0x6B: { code: 'Equal', keyCap: '=' }, // [USB: 0x2e] =+\n            0x6D: { code: 'Minus', keyCap: '-' }, // [USB: 0x2d] -_\n            0xBB: { code: 'NumpadAdd', keyCap: '+', location: NUMPAD }, // [USB: 0x57]\n            0xBD: { code: 'NumpadSubtract', keyCap: '-', location: NUMPAD } // [USB: 0x56]\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'moz-mac', {\n            0x0C: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n            0xAD: { code: 'Minus', keyCap: '-' } // [USB: 0x2d] -_\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'moz-win', {\n            0xAD: { code: 'Minus', keyCap: '-' } // [USB: 0x2d] -_\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'chrome-mac', {\n            0x5D: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n          });\n\n  // Windows via Bootcamp (!)\n  if (0) {\n    mergeIf(keyCodeToInfoTable,\n            'chrome-win', {\n              0xC0: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n              0xDE: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n              0xDF: { code: 'Backquote', keyCap: '`' } // [USB: 0x35] `~ (US Standard 101)\n            });\n\n    mergeIf(keyCodeToInfoTable,\n            'ie', {\n              0xC0: { code: 'Quote', keyCap: '\\'' }, // [USB: 0x34] '\" (US Standard 101)\n              0xDE: { code: 'Backslash',  keyCap: '\\\\' }, // [USB: 0x31] \\| (US Standard 101)\n              0xDF: { code: 'Backquote', keyCap: '`' } // [USB: 0x35] `~ (US Standard 101)\n            });\n  }\n\n  mergeIf(keyCodeToInfoTable,\n          'safari', {\n            0x03: { code: 'Enter' }, // [USB: 0x28] old Safari\n            0x19: { code: 'Tab' } // [USB: 0x2b] old Safari for Shift+Tab\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'ios', {\n            0x0A: { code: 'Enter', location: STANDARD } // [USB: 0x28]\n          });\n\n  mergeIf(keyCodeToInfoTable,\n          'safari-mac', {\n            0x5B: { code: 'OSLeft', location: LEFT }, // [USB: 0xe3]\n            0x5D: { code: 'OSRight', location: RIGHT }, // [USB: 0xe7]\n            0xE5: { code: 'KeyQ', keyCap: 'Q' } // [USB: 0x14] On alternate presses, Ctrl+Q sends this\n          });\n\n  //--------------------------------------------------------------------\n  //\n  // Identifier Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // Cases where newer-ish browsers send keyIdentifier which can be\n  // used to disambiguate keys.\n\n  // keyIdentifierTable[keyIdentifier] -> keyInfo\n\n  var keyIdentifierTable = {};\n  if ('cros' === os) {\n    keyIdentifierTable['U+00A0'] = { code: 'ShiftLeft', location: LEFT };\n    keyIdentifierTable['U+00A1'] = { code: 'ShiftRight', location: RIGHT };\n    keyIdentifierTable['U+00A2'] = { code: 'ControlLeft', location: LEFT };\n    keyIdentifierTable['U+00A3'] = { code: 'ControlRight', location: RIGHT };\n    keyIdentifierTable['U+00A4'] = { code: 'AltLeft', location: LEFT };\n    keyIdentifierTable['U+00A5'] = { code: 'AltRight', location: RIGHT };\n  }\n  if ('chrome-mac' === browser_os) {\n    keyIdentifierTable['U+0010'] = { code: 'ContextMenu' };\n  }\n  if ('safari-mac' === browser_os) {\n    keyIdentifierTable['U+0010'] = { code: 'ContextMenu' };\n  }\n  if ('ios' === os) {\n    // These only generate keyup events\n    keyIdentifierTable['U+0010'] = { code: 'Function' };\n\n    keyIdentifierTable['U+001C'] = { code: 'ArrowLeft' };\n    keyIdentifierTable['U+001D'] = { code: 'ArrowRight' };\n    keyIdentifierTable['U+001E'] = { code: 'ArrowUp' };\n    keyIdentifierTable['U+001F'] = { code: 'ArrowDown' };\n\n    keyIdentifierTable['U+0001'] = { code: 'Home' }; // [USB: 0x4a] Fn + ArrowLeft\n    keyIdentifierTable['U+0004'] = { code: 'End' }; // [USB: 0x4d] Fn + ArrowRight\n    keyIdentifierTable['U+000B'] = { code: 'PageUp' }; // [USB: 0x4b] Fn + ArrowUp\n    keyIdentifierTable['U+000C'] = { code: 'PageDown' }; // [USB: 0x4e] Fn + ArrowDown\n  }\n\n  //--------------------------------------------------------------------\n  //\n  // Location Mappings\n  //\n  //--------------------------------------------------------------------\n\n  // Cases where newer-ish browsers send location/keyLocation which\n  // can be used to disambiguate keys.\n\n  // locationTable[location][keyCode] -> keyInfo\n  var locationTable = [];\n  locationTable[LEFT] = {\n    0x10: { code: 'ShiftLeft', location: LEFT }, // [USB: 0xe1]\n    0x11: { code: 'ControlLeft', location: LEFT }, // [USB: 0xe0]\n    0x12: { code: 'AltLeft', location: LEFT } // [USB: 0xe2]\n  };\n  locationTable[RIGHT] = {\n    0x10: { code: 'ShiftRight', location: RIGHT }, // [USB: 0xe5]\n    0x11: { code: 'ControlRight', location: RIGHT }, // [USB: 0xe4]\n    0x12: { code: 'AltRight', location: RIGHT } // [USB: 0xe6]\n  };\n  locationTable[NUMPAD] = {\n    0x0D: { code: 'NumpadEnter', location: NUMPAD } // [USB: 0x58]\n  };\n\n  mergeIf(locationTable[NUMPAD], 'moz', {\n    0x6D: { code: 'NumpadSubtract', location: NUMPAD }, // [USB: 0x56]\n    0x6B: { code: 'NumpadAdd', location: NUMPAD } // [USB: 0x57]\n  });\n  mergeIf(locationTable[LEFT], 'moz-mac', {\n    0xE0: { code: 'OSLeft', location: LEFT } // [USB: 0xe3]\n  });\n  mergeIf(locationTable[RIGHT], 'moz-mac', {\n    0xE0: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n  mergeIf(locationTable[RIGHT], 'moz-win', {\n    0x5B: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n\n\n  mergeIf(locationTable[RIGHT], 'mac', {\n    0x5D: { code: 'OSRight', location: RIGHT } // [USB: 0xe7]\n  });\n\n  mergeIf(locationTable[NUMPAD], 'chrome-mac', {\n    0x0C: { code: 'NumLock', location: NUMPAD } // [USB: 0x53]\n  });\n\n  mergeIf(locationTable[NUMPAD], 'safari-mac', {\n    0x0C: { code: 'NumLock', location: NUMPAD }, // [USB: 0x53]\n    0xBB: { code: 'NumpadAdd', location: NUMPAD }, // [USB: 0x57]\n    0xBD: { code: 'NumpadSubtract', location: NUMPAD }, // [USB: 0x56]\n    0xBE: { code: 'NumpadDecimal', location: NUMPAD }, // [USB: 0x63]\n    0xBF: { code: 'NumpadDivide', location: NUMPAD } // [USB: 0x54]\n  });\n\n\n  //--------------------------------------------------------------------\n  //\n  // Key Values\n  //\n  //--------------------------------------------------------------------\n\n  // Mapping from `code` values to `key` values. Values defined at:\n  // https://dvcs.w3.org/hg/dom3events/raw-file/tip/html/DOM3Events-key.html\n  // Entries are only provided when `key` differs from `code`. If\n  // printable, `shiftKey` has the shifted printable character. This\n  // assumes US Standard 101 layout\n\n  var codeToKeyTable = {\n    // Modifier Keys\n    ShiftLeft: { key: 'Shift' },\n    ShiftRight: { key: 'Shift' },\n    ControlLeft: { key: 'Control' },\n    ControlRight: { key: 'Control' },\n    AltLeft: { key: 'Alt' },\n    AltRight: { key: 'Alt' },\n    OSLeft: { key: 'OS' },\n    OSRight: { key: 'OS' },\n\n    // Whitespace Keys\n    NumpadEnter: { key: 'Enter' },\n    Space: { key: ' ' },\n\n    // Printable Keys\n    Digit0: { key: '0', shiftKey: ')' },\n    Digit1: { key: '1', shiftKey: '!' },\n    Digit2: { key: '2', shiftKey: '@' },\n    Digit3: { key: '3', shiftKey: '#' },\n    Digit4: { key: '4', shiftKey: '$' },\n    Digit5: { key: '5', shiftKey: '%' },\n    Digit6: { key: '6', shiftKey: '^' },\n    Digit7: { key: '7', shiftKey: '&' },\n    Digit8: { key: '8', shiftKey: '*' },\n    Digit9: { key: '9', shiftKey: '(' },\n    KeyA: { key: 'a', shiftKey: 'A' },\n    KeyB: { key: 'b', shiftKey: 'B' },\n    KeyC: { key: 'c', shiftKey: 'C' },\n    KeyD: { key: 'd', shiftKey: 'D' },\n    KeyE: { key: 'e', shiftKey: 'E' },\n    KeyF: { key: 'f', shiftKey: 'F' },\n    KeyG: { key: 'g', shiftKey: 'G' },\n    KeyH: { key: 'h', shiftKey: 'H' },\n    KeyI: { key: 'i', shiftKey: 'I' },\n    KeyJ: { key: 'j', shiftKey: 'J' },\n    KeyK: { key: 'k', shiftKey: 'K' },\n    KeyL: { key: 'l', shiftKey: 'L' },\n    KeyM: { key: 'm', shiftKey: 'M' },\n    KeyN: { key: 'n', shiftKey: 'N' },\n    KeyO: { key: 'o', shiftKey: 'O' },\n    KeyP: { key: 'p', shiftKey: 'P' },\n    KeyQ: { key: 'q', shiftKey: 'Q' },\n    KeyR: { key: 'r', shiftKey: 'R' },\n    KeyS: { key: 's', shiftKey: 'S' },\n    KeyT: { key: 't', shiftKey: 'T' },\n    KeyU: { key: 'u', shiftKey: 'U' },\n    KeyV: { key: 'v', shiftKey: 'V' },\n    KeyW: { key: 'w', shiftKey: 'W' },\n    KeyX: { key: 'x', shiftKey: 'X' },\n    KeyY: { key: 'y', shiftKey: 'Y' },\n    KeyZ: { key: 'z', shiftKey: 'Z' },\n    Numpad0: { key: '0' },\n    Numpad1: { key: '1' },\n    Numpad2: { key: '2' },\n    Numpad3: { key: '3' },\n    Numpad4: { key: '4' },\n    Numpad5: { key: '5' },\n    Numpad6: { key: '6' },\n    Numpad7: { key: '7' },\n    Numpad8: { key: '8' },\n    Numpad9: { key: '9' },\n    NumpadMultiply: { key: '*' },\n    NumpadAdd: { key: '+' },\n    NumpadComma: { key: ',' },\n    NumpadSubtract: { key: '-' },\n    NumpadDecimal: { key: '.' },\n    NumpadDivide: { key: '/' },\n    Semicolon: { key: ';', shiftKey: ':' },\n    Equal: { key: '=', shiftKey: '+' },\n    Comma: { key: ',', shiftKey: '<' },\n    Minus: { key: '-', shiftKey: '_' },\n    Period: { key: '.', shiftKey: '>' },\n    Slash: { key: '/', shiftKey: '?' },\n    Backquote: { key: '`', shiftKey: '~' },\n    BracketLeft: { key: '[', shiftKey: '{' },\n    Backslash: { key: '\\\\', shiftKey: '|' },\n    BracketRight: { key: ']', shiftKey: '}' },\n    Quote: { key: '\\'', shiftKey: '\"' },\n    IntlBackslash: { key: '\\\\', shiftKey: '|' }\n  };\n\n  mergeIf(codeToKeyTable, 'mac', {\n    OSLeft: { key: 'Meta' },\n    OSRight: { key: 'Meta' }\n  });\n\n  // Corrections for 'key' names in older browsers (e.g. FF36-)\n  // https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent.key#Key_values\n  var keyFixTable = {\n    Esc: 'Escape',\n    Nonconvert: 'NonConvert',\n    Left: 'ArrowLeft',\n    Up: 'ArrowUp',\n    Right: 'ArrowRight',\n    Down: 'ArrowDown',\n    Del: 'Delete',\n    Menu: 'ContextMenu',\n    MediaNextTrack: 'MediaTrackNext',\n    MediaPreviousTrack: 'MediaTrackPrevious',\n    SelectMedia: 'MediaSelect',\n    HalfWidth: 'Hankaku',\n    FullWidth: 'Zenkaku',\n    RomanCharacters: 'Romaji',\n    Crsel: 'CrSel',\n    Exsel: 'ExSel',\n    Zoom: 'ZoomToggle'\n  };\n\n  //--------------------------------------------------------------------\n  //\n  // Exported Functions\n  //\n  //--------------------------------------------------------------------\n\n\n  var codeTable = remap(keyCodeToInfoTable, 'code');\n\n  try {\n    var nativeLocation = nativeKeyboardEvent && ('location' in new KeyboardEvent(''));\n  } catch (_) {}\n\n  function keyInfoForEvent(event) {\n    var keyCode = 'keyCode' in event ? event.keyCode : 'which' in event ? event.which : 0;\n\n    var keyInfo = (function(){\n      if (nativeLocation || 'keyLocation' in event) {\n        var location = nativeLocation ? event.location : event.keyLocation;\n        if (location && keyCode in locationTable[location]) {\n          return locationTable[location][keyCode];\n        }\n      }\n      if ('keyIdentifier' in event && event.keyIdentifier in keyIdentifierTable) {\n        return keyIdentifierTable[event.keyIdentifier];\n      }\n      if (keyCode in keyCodeToInfoTable) {\n        return keyCodeToInfoTable[keyCode];\n      }\n      return null;\n    }());\n\n    // TODO: Track these down and move to general tables\n    if (0) {\n      // TODO: Map these for newerish browsers?\n      // TODO: iOS only?\n      // TODO: Override with more common keyIdentifier name?\n      switch (event.keyIdentifier) {\n      case 'U+0010': keyInfo = { code: 'Function' }; break;\n      case 'U+001C': keyInfo = { code: 'ArrowLeft' }; break;\n      case 'U+001D': keyInfo = { code: 'ArrowRight' }; break;\n      case 'U+001E': keyInfo = { code: 'ArrowUp' }; break;\n      case 'U+001F': keyInfo = { code: 'ArrowDown' }; break;\n      }\n    }\n\n    if (!keyInfo)\n      return null;\n\n    var key = (function() {\n      var entry = codeToKeyTable[keyInfo.code];\n      if (!entry) return keyInfo.code;\n      return (event.shiftKey && 'shiftKey' in entry) ? entry.shiftKey : entry.key;\n    }());\n\n    return {\n      code: keyInfo.code,\n      key: key,\n      location: keyInfo.location,\n      keyCap: keyInfo.keyCap\n    };\n  }\n\n  function queryKeyCap(code, locale) {\n    code = String(code);\n    if (!codeTable.hasOwnProperty(code)) return 'Undefined';\n    if (locale && String(locale).toLowerCase() !== 'en-us') throw Error('Unsupported locale');\n    var keyInfo = codeTable[code];\n    return keyInfo.keyCap || keyInfo.code || 'Undefined';\n  }\n\n  if ('KeyboardEvent' in global && 'defineProperty' in Object) {\n    (function() {\n      function define(o, p, v) {\n        if (p in o) return;\n        Object.defineProperty(o, p, v);\n      }\n\n      define(KeyboardEvent.prototype, 'code', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return keyInfo ? keyInfo.code : '';\n      }});\n\n      // Fix for nonstandard `key` values (FF36-)\n      if ('key' in KeyboardEvent.prototype) {\n        var desc = Object.getOwnPropertyDescriptor(KeyboardEvent.prototype, 'key');\n        Object.defineProperty(KeyboardEvent.prototype, 'key', { get: function() {\n          var key = desc.get.call(this);\n          return keyFixTable.hasOwnProperty(key) ? keyFixTable[key] : key;\n        }});\n      }\n\n      define(KeyboardEvent.prototype, 'key', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return (keyInfo && 'key' in keyInfo) ? keyInfo.key : 'Unidentified';\n      }});\n\n      define(KeyboardEvent.prototype, 'location', { get: function() {\n        var keyInfo = keyInfoForEvent(this);\n        return (keyInfo && 'location' in keyInfo) ? keyInfo.location : STANDARD;\n      }});\n\n      define(KeyboardEvent.prototype, 'locale', { get: function() {\n        return '';\n      }});\n    }());\n  }\n\n  if (!('queryKeyCap' in global.KeyboardEvent))\n    global.KeyboardEvent.queryKeyCap = queryKeyCap;\n\n  // Helper for IE8-\n  global.identifyKey = function(event) {\n    if ('code' in event)\n      return;\n\n    var keyInfo = keyInfoForEvent(event);\n    event.code = keyInfo ? keyInfo.code : '';\n    event.key = (keyInfo && 'key' in keyInfo) ? keyInfo.key : 'Unidentified';\n    event.location = ('location' in event) ? event.location :\n      ('keyLocation' in event) ? event.keyLocation :\n      (keyInfo && 'location' in keyInfo) ? keyInfo.location : STANDARD;\n    event.locale = '';\n  };\n\n} (window));\n","!function(t,i){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(\"nipplejs\",[],i):\"object\"==typeof exports?exports.nipplejs=i():t.nipplejs=i()}(window,(function(){return function(t){var i={};function e(o){if(i[o])return i[o].exports;var n=i[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=i,e.d=function(t,i,o){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:o})},e.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&\"object\"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,\"default\",{enumerable:!0,value:t}),2&i&&\"string\"!=typeof t)for(var n in t)e.d(o,n,function(i){return t[i]}.bind(null,n));return o},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,\"a\",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p=\"\",e(e.s=0)}([function(t,i,e){\"use strict\";e.r(i);var o,n=function(t,i){var e=i.x-t.x,o=i.y-t.y;return Math.sqrt(e*e+o*o)},s=function(t){return t*(Math.PI/180)},r=function(t){return t*(180/Math.PI)},d=new Map,a=function(t){d.has(t)&&clearTimeout(d.get(t)),d.set(t,setTimeout(t,100))},p=function(t,i,e){for(var o,n=i.split(/[ ,]+/g),s=0;s<n.length;s+=1)o=n[s],t.addEventListener?t.addEventListener(o,e,!1):t.attachEvent&&t.attachEvent(o,e)},c=function(t,i,e){for(var o,n=i.split(/[ ,]+/g),s=0;s<n.length;s+=1)o=n[s],t.removeEventListener?t.removeEventListener(o,e):t.detachEvent&&t.detachEvent(o,e)},l=function(t){return t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t},h=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},u=function(t,i){i.top||i.right||i.bottom||i.left?(t.style.top=i.top,t.style.right=i.right,t.style.bottom=i.bottom,t.style.left=i.left):(t.style.left=i.x+\"px\",t.style.top=i.y+\"px\")},f=function(t,i,e){var o=y(t);for(var n in o)if(o.hasOwnProperty(n))if(\"string\"==typeof i)o[n]=i+\" \"+e;else{for(var s=\"\",r=0,d=i.length;r<d;r+=1)s+=i[r]+\" \"+e+\", \";o[n]=s.slice(0,-2)}return o},y=function(t){var i={};i[t]=\"\";return[\"webkit\",\"Moz\",\"o\"].forEach((function(e){i[e+t.charAt(0).toUpperCase()+t.slice(1)]=\"\"})),i},m=function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e]);return t},v=function(t,i){if(t.length)for(var e=0,o=t.length;e<o;e+=1)i(t[e]);else i(t)},g=!!(\"ontouchstart\"in window),b=!!window.PointerEvent,x=!!window.MSPointerEvent,O={start:\"mousedown\",move:\"mousemove\",end:\"mouseup\"},w={};function _(){}b?o={start:\"pointerdown\",move:\"pointermove\",end:\"pointerup, pointercancel\"}:x?o={start:\"MSPointerDown\",move:\"MSPointerMove\",end:\"MSPointerUp\"}:g?(o={start:\"touchstart\",move:\"touchmove\",end:\"touchend, touchcancel\"},w=O):o=O,_.prototype.on=function(t,i){var e,o=t.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var n=0;n<o.length;n+=1)e=o[n],this._handlers_[e]=this._handlers_[e]||[],this._handlers_[e].push(i);return this},_.prototype.off=function(t,i){return this._handlers_=this._handlers_||{},void 0===t?this._handlers_={}:void 0===i?this._handlers_[t]=null:this._handlers_[t]&&this._handlers_[t].indexOf(i)>=0&&this._handlers_[t].splice(this._handlers_[t].indexOf(i),1),this},_.prototype.trigger=function(t,i){var e,o=this,n=t.split(/[ ,]+/g);o._handlers_=o._handlers_||{};for(var s=0;s<n.length;s+=1)e=n[s],o._handlers_[e]&&o._handlers_[e].length&&o._handlers_[e].forEach((function(t){t.call(o,{type:e,target:o},i)}))},_.prototype.config=function(t){this.options=this.defaults||{},t&&(this.options=function(t,i){var e={};for(var o in t)t.hasOwnProperty(o)&&i.hasOwnProperty(o)?e[o]=i[o]:t.hasOwnProperty(o)&&(e[o]=t[o]);return e}(this.options,t))},_.prototype.bindEvt=function(t,i){var e=this;return e._domHandlers_=e._domHandlers_||{},e._domHandlers_[i]=function(){\"function\"==typeof e[\"on\"+i]?e[\"on\"+i].apply(e,arguments):console.warn('[WARNING] : Missing \"on'+i+'\" handler.')},p(t,o[i],e._domHandlers_[i]),w[i]&&p(t,w[i],e._domHandlers_[i]),e},_.prototype.unbindEvt=function(t,i){return this._domHandlers_=this._domHandlers_||{},c(t,o[i],this._domHandlers_[i]),w[i]&&c(t,w[i],this._domHandlers_[i]),delete this._domHandlers_[i],this};var T=_;function k(t,i){return this.identifier=i.identifier,this.position=i.position,this.frontPosition=i.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:\"white\",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:\"dynamic\",zone:document.body,lockX:!1,lockY:!1,shape:\"circle\"},this.config(i),\"dynamic\"===this.options.mode&&(this.options.restOpacity=0),this.id=k.id,k.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}k.prototype=new T,k.constructor=k,k.id=0,k.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement(\"div\"),this.ui.back=document.createElement(\"div\"),this.ui.front=document.createElement(\"div\"),this.ui.el.className=\"nipple collection_\"+this.collection.id,this.ui.back.className=\"back\",this.ui.front.className=\"front\",this.ui.el.setAttribute(\"id\",\"nipple_\"+this.collection.id+\"_\"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},k.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+\"ms\",i=function(t,i){var e=y(t);for(var o in e)e.hasOwnProperty(o)&&(e[o]=i);return e}(\"borderRadius\",\"50%\"),e=f(\"transition\",\"opacity\",t),o={};return o.el={position:\"absolute\",opacity:this.options.restOpacity,display:\"block\",zIndex:999},o.back={position:\"absolute\",display:\"block\",width:this.options.size+\"px\",height:this.options.size+\"px\",marginLeft:-this.options.size/2+\"px\",marginTop:-this.options.size/2+\"px\",background:this.options.color,opacity:\".5\"},o.front={width:this.options.size/2+\"px\",height:this.options.size/2+\"px\",position:\"absolute\",display:\"block\",marginLeft:-this.options.size/4+\"px\",marginTop:-this.options.size/4+\"px\",background:this.options.color,opacity:\".5\",transform:\"translate(0px, 0px)\"},m(o.el,e),\"circle\"===this.options.shape&&m(o.back,i),m(o.front,i),this.applyStyles(o),this},k.prototype.applyStyles=function(t){for(var i in this.ui)if(this.ui.hasOwnProperty(i))for(var e in t[i])this.ui[i].style[e]=t[i][e];return this},k.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},k.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},k.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger(\"destroyed\",this.instance),this.removeFromDom(),this.off()},k.prototype.show=function(t){var i=this;return i.options.dataOnly||(clearTimeout(i.removeTimeout),clearTimeout(i.showTimeout),clearTimeout(i.restTimeout),i.addToDom(),i.restCallback(),setTimeout((function(){i.ui.el.style.opacity=1}),0),i.showTimeout=setTimeout((function(){i.trigger(\"shown\",i.instance),\"function\"==typeof t&&t.call(this)}),i.options.fadeTime)),i},k.prototype.hide=function(t){var i=this;if(i.options.dataOnly)return i;if(i.ui.el.style.opacity=i.options.restOpacity,clearTimeout(i.removeTimeout),clearTimeout(i.showTimeout),clearTimeout(i.restTimeout),i.removeTimeout=setTimeout((function(){var e=\"dynamic\"===i.options.mode?\"none\":\"block\";i.ui.el.style.display=e,\"function\"==typeof t&&t.call(i),i.trigger(\"hidden\",i.instance)}),i.options.fadeTime),i.options.restJoystick){var e=i.options.restJoystick,o={};o.x=!0===e||!1!==e.x?0:i.instance.frontPosition.x,o.y=!0===e||!1!==e.y?0:i.instance.frontPosition.y,i.setPosition(t,o)}return i},k.prototype.setPosition=function(t,i){var e=this;e.frontPosition={x:i.x,y:i.y};var o=e.options.fadeTime+\"ms\",n={};n.front=f(\"transition\",[\"transform\"],o);var s={front:{}};s.front={transform:\"translate(\"+e.frontPosition.x+\"px,\"+e.frontPosition.y+\"px)\"},e.applyStyles(n),e.applyStyles(s),e.restTimeout=setTimeout((function(){\"function\"==typeof t&&t.call(e),e.restCallback()}),e.options.fadeTime)},k.prototype.restCallback=function(){var t={};t.front=f(\"transition\",\"none\",\"\"),this.applyStyles(t),this.trigger(\"rested\",this.instance)},k.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},k.prototype.computeDirection=function(t){var i,e,o,n=t.angle.radian,s=Math.PI/4,r=Math.PI/2;if(n>s&&n<3*s&&!t.lockX?i=\"up\":n>-s&&n<=s&&!t.lockY?i=\"left\":n>3*-s&&n<=-s&&!t.lockX?i=\"down\":t.lockY||(i=\"right\"),t.lockY||(e=n>-r&&n<r?\"left\":\"right\"),t.lockX||(o=n>0?\"up\":\"down\"),t.force>this.options.threshold){var d,a={};for(d in this.direction)this.direction.hasOwnProperty(d)&&(a[d]=this.direction[d]);var p={};for(d in this.direction={x:e,y:o,angle:i},t.direction=this.direction,a)a[d]===this.direction[d]&&(p[d]=!0);if(p.x&&p.y&&p.angle)return t;p.x&&p.y||this.trigger(\"plain\",t),p.x||this.trigger(\"plain:\"+e,t),p.y||this.trigger(\"plain:\"+o,t),p.angle||this.trigger(\"dir dir:\"+i,t)}else this.resetDirection();return t};var P=k;function E(t,i){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=t,this.id=E.id,E.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:\"dynamic\",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:\"white\",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:\"circle\",dynamicPage:!1,follow:!1},this.config(i),\"static\"!==this.options.mode&&\"semi\"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var e=getComputedStyle(this.options.zone.parentElement);return e&&\"flex\"===e.display&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}E.prototype=new T,E.constructor=E,E.id=0,E.prototype.prepareNipples=function(){var t=this.nipples;t.on=this.on.bind(this),t.off=this.off.bind(this),t.options=this.options,t.destroy=this.destroy.bind(this),t.ids=this.ids,t.id=this.id,t.processOnMove=this.processOnMove.bind(this),t.processOnEnd=this.processOnEnd.bind(this),t.get=function(i){if(void 0===i)return t[0];for(var e=0,o=t.length;e<o;e+=1)if(t[e].identifier===i)return t[e];return!1}},E.prototype.bindings=function(){this.bindEvt(this.options.zone,\"start\"),this.options.zone.style.touchAction=\"none\",this.options.zone.style.msTouchAction=\"none\"},E.prototype.begin=function(){var t=this.options;if(\"static\"===t.mode){var i=this.createNipple(t.position,this.manager.getIdentifier());i.add(),this.idles.push(i)}},E.prototype.createNipple=function(t,i){var e=this.manager.scroll,o={},n=this.options,s=this.parentIsFlex?e.x:e.x+this.box.left,r=this.parentIsFlex?e.y:e.y+this.box.top;if(t.x&&t.y)o={x:t.x-s,y:t.y-r};else if(t.top||t.right||t.bottom||t.left){var d=document.createElement(\"DIV\");d.style.display=\"hidden\",d.style.top=t.top,d.style.right=t.right,d.style.bottom=t.bottom,d.style.left=t.left,d.style.position=\"absolute\",n.zone.appendChild(d);var a=d.getBoundingClientRect();n.zone.removeChild(d),o=t,t={x:a.left+e.x,y:a.top+e.y}}var p=new P(this,{color:n.color,size:n.size,threshold:n.threshold,fadeTime:n.fadeTime,dataOnly:n.dataOnly,restJoystick:n.restJoystick,restOpacity:n.restOpacity,mode:n.mode,identifier:i,position:t,zone:n.zone,frontPosition:{x:0,y:0},shape:n.shape});return n.dataOnly||(u(p.ui.el,o),u(p.ui.front,p.frontPosition)),this.nipples.push(p),this.trigger(\"added \"+p.identifier+\":added\",p),this.manager.trigger(\"added \"+p.identifier+\":added\",p),this.bindNipple(p),p},E.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},E.prototype.bindNipple=function(t){var i,e=this,o=function(t,o){i=t.type+\" \"+o.id+\":\"+t.type,e.trigger(i,o)};t.on(\"destroyed\",e.onDestroyed.bind(e)),t.on(\"shown hidden rested dir plain\",o),t.on(\"dir:up dir:right dir:down dir:left\",o),t.on(\"plain:up plain:right plain:down plain:left\",o)},E.prototype.pressureFn=function(t,i,e){var o=this,n=0;clearInterval(o.pressureIntervals[e]),o.pressureIntervals[e]=setInterval(function(){var e=t.force||t.pressure||t.webkitForce||0;e!==n&&(i.trigger(\"pressure\",e),o.trigger(\"pressure \"+i.identifier+\":pressure\",e),n=e)}.bind(o),100)},E.prototype.onstart=function(t){var i=this,e=i.options,o=t;t=l(t),i.updateBox();return v(t,(function(n){i.actives.length<e.maxNumberOfNipples?i.processOnStart(n):o.type.match(/^touch/)&&(Object.keys(i.manager.ids).forEach((function(e){if(Object.values(o.touches).findIndex((function(t){return t.identifier===e}))<0){var n=[t[0]];n.identifier=e,i.processOnEnd(n)}})),i.actives.length<e.maxNumberOfNipples&&i.processOnStart(n))})),i.manager.bindDocument(),!1},E.prototype.processOnStart=function(t){var i,e=this,o=e.options,s=e.manager.getIdentifier(t),r=t.force||t.pressure||t.webkitForce||0,d={x:t.pageX,y:t.pageY},a=e.getOrCreate(s,d);a.identifier!==s&&e.manager.removeIdentifier(a.identifier),a.identifier=s;var p=function(i){i.trigger(\"start\",i),e.trigger(\"start \"+i.id+\":start\",i),i.show(),r>0&&e.pressureFn(t,i,i.identifier),e.processOnMove(t)};if((i=e.idles.indexOf(a))>=0&&e.idles.splice(i,1),e.actives.push(a),e.ids.push(a.identifier),\"semi\"!==o.mode)p(a);else{if(!(n(d,a.position)<=o.catchDistance))return a.destroy(),void e.processOnStart(t);p(a)}return a},E.prototype.getOrCreate=function(t,i){var e,o=this.options;return/(semi|static)/.test(o.mode)?(e=this.idles[0])?(this.idles.splice(0,1),e):\"semi\"===o.mode?this.createNipple(i,t):(console.warn(\"Coudln't find the needed nipple.\"),!1):e=this.createNipple(i,t)},E.prototype.processOnMove=function(t){var i=this.options,e=this.manager.getIdentifier(t),o=this.nipples.get(e),d=this.manager.scroll;if(function(t){return isNaN(t.buttons)?0!==t.pressure:0!==t.buttons}(t)){if(!o)return console.error(\"Found zombie joystick with ID \"+e),void this.manager.removeIdentifier(e);if(i.dynamicPage){var a=o.el.getBoundingClientRect();o.position={x:d.x+a.left,y:d.y+a.top}}o.identifier=e;var p=o.options.size/2,c={x:t.pageX,y:t.pageY};i.lockX&&(c.y=o.position.y),i.lockY&&(c.x=o.position.x);var l,h,u,f,y,m,v,g,b,x,O=n(c,o.position),w=(l=c,h=o.position,u=h.x-l.x,f=h.y-l.y,r(Math.atan2(f,u))),_=s(w),T=O/p,k={distance:O,position:c};if(\"circle\"===o.options.shape?(y=Math.min(O,p),v=o.position,g=y,x={x:0,y:0},b=s(b=w),x.x=v.x-g*Math.cos(b),x.y=v.y-g*Math.sin(b),m=x):(m=function(t,i,e){return{x:Math.min(Math.max(t.x,i.x-e),i.x+e),y:Math.min(Math.max(t.y,i.y-e),i.y+e)}}(c,o.position,p),y=n(m,o.position)),i.follow){if(O>p){var P=c.x-m.x,E=c.y-m.y;o.position.x+=P,o.position.y+=E,o.el.style.top=o.position.y-(this.box.top+d.y)+\"px\",o.el.style.left=o.position.x-(this.box.left+d.x)+\"px\",O=n(c,o.position)}}else c=m,O=y;var I=c.x-o.position.x,z=c.y-o.position.y;o.frontPosition={x:I,y:z},i.dataOnly||(o.ui.front.style.transform=\"translate(\"+I+\"px,\"+z+\"px)\");var D={identifier:o.identifier,position:c,force:T,pressure:t.force||t.pressure||t.webkitForce||0,distance:O,angle:{radian:_,degree:w},vector:{x:I/p,y:-z/p},raw:k,instance:o,lockX:i.lockX,lockY:i.lockY};(D=o.computeDirection(D)).angle={radian:s(180-w),degree:180-w},o.trigger(\"move\",D),this.trigger(\"move \"+o.id+\":move\",D)}else this.processOnEnd(t)},E.prototype.processOnEnd=function(t){var i=this,e=i.options,o=i.manager.getIdentifier(t),n=i.nipples.get(o),s=i.manager.removeIdentifier(n.identifier);n&&(e.dataOnly||n.hide((function(){\"dynamic\"===e.mode&&(n.trigger(\"removed\",n),i.trigger(\"removed \"+n.id+\":removed\",n),i.manager.trigger(\"removed \"+n.id+\":removed\",n),n.destroy())})),clearInterval(i.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger(\"end\",n),i.trigger(\"end \"+n.id+\":end\",n),i.ids.indexOf(n.identifier)>=0&&i.ids.splice(i.ids.indexOf(n.identifier),1),i.actives.indexOf(n)>=0&&i.actives.splice(i.actives.indexOf(n),1),/(semi|static)/.test(e.mode)?i.idles.push(n):i.nipples.indexOf(n)>=0&&i.nipples.splice(i.nipples.indexOf(n),1),i.manager.unbindDocument(),/(semi|static)/.test(e.mode)&&(i.manager.ids[s.id]=s.identifier))},E.prototype.onDestroyed=function(t,i){this.nipples.indexOf(i)>=0&&this.nipples.splice(this.nipples.indexOf(i),1),this.actives.indexOf(i)>=0&&this.actives.splice(this.actives.indexOf(i),1),this.idles.indexOf(i)>=0&&this.idles.splice(this.idles.indexOf(i),1),this.ids.indexOf(i.identifier)>=0&&this.ids.splice(this.ids.indexOf(i.identifier),1),this.manager.removeIdentifier(i.identifier),this.manager.unbindDocument()},E.prototype.destroy=function(){for(var t in this.unbindEvt(this.options.zone,\"start\"),this.nipples.forEach((function(t){t.destroy()})),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(t)&&clearInterval(this.pressureIntervals[t]);this.trigger(\"destroyed\",this.nipples),this.manager.unbindDocument(),this.off()};var I=E;function z(t){var i=this;i.ids={},i.index=0,i.collections=[],i.scroll=h(),i.config(t),i.prepareCollections();var e=function(){var t;i.collections.forEach((function(e){e.forEach((function(e){t=e.el.getBoundingClientRect(),e.position={x:i.scroll.x+t.left,y:i.scroll.y+t.top}}))}))};p(window,\"resize\",(function(){a(e)}));var o=function(){i.scroll=h()};return p(window,\"scroll\",(function(){a(o)})),i.collections}z.prototype=new T,z.constructor=z,z.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(i){var e;return t.collections.every((function(t){return!(e=t.get(i))})),e}},z.prototype.create=function(t){return this.createCollection(t)},z.prototype.createCollection=function(t){var i=new I(this,t);return this.bindCollection(i),this.collections.push(i),i},z.prototype.bindCollection=function(t){var i,e=this,o=function(t,o){i=t.type+\" \"+o.id+\":\"+t.type,e.trigger(i,o)};t.on(\"destroyed\",e.onDestroyed.bind(e)),t.on(\"shown hidden rested dir plain\",o),t.on(\"dir:up dir:right dir:down dir:left\",o),t.on(\"plain:up plain:right plain:down plain:left\",o)},z.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,\"move\").bindEvt(document,\"end\"),this.binded=!0)},z.prototype.unbindDocument=function(t){Object.keys(this.ids).length&&!0!==t||(this.unbindEvt(document,\"move\").unbindEvt(document,\"end\"),this.binded=!1)},z.prototype.getIdentifier=function(t){var i;return t?void 0===(i=void 0===t.identifier?t.pointerId:t.identifier)&&(i=this.latest||0):i=this.index,void 0===this.ids[i]&&(this.ids[i]=this.index,this.index+=1),this.latest=i,this.ids[i]},z.prototype.removeIdentifier=function(t){var i={};for(var e in this.ids)if(this.ids[e]===t){i.id=e,i.identifier=this.ids[e],delete this.ids[e];break}return i},z.prototype.onmove=function(t){return this.onAny(\"move\",t),!1},z.prototype.onend=function(t){return this.onAny(\"end\",t),!1},z.prototype.oncancel=function(t){return this.onAny(\"end\",t),!1},z.prototype.onAny=function(t,i){var e,o=this,n=\"processOn\"+t.charAt(0).toUpperCase()+t.slice(1);i=l(i);var s=function(t,i,e){e.ids.indexOf(i)>=0&&(e[n](t),t._found_=!0)};return v(i,(function(t){e=o.getIdentifier(t),v(o.collections,s.bind(null,t,e)),t._found_||o.removeIdentifier(e)})),!1},z.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach((function(t){t.destroy()})),this.off()},z.prototype.onDestroyed=function(t,i){if(this.collections.indexOf(i)<0)return!1;this.collections.splice(this.collections.indexOf(i),1)};var D=new z;i.default={create:function(t){return D.create(t)},factory:D}}]).default}));","import{BufferAttribute as t,BufferGeometry as e,Vector3 as r,Plane as s,Triangle as n,Color as o,Object3D as i,Mesh as h,SphereGeometry as c,MeshBasicMaterial as a,BoxGeometry as u,LineBasicMaterial as l,Line as d}from\"three\";class p{static roundNumber(t,e){const r=Math.pow(10,e);return Math.round(t*r)/r}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,e){var r=t.x-e.x,s=t.y-e.y,n=t.z-e.z;return r*r+s*s+n*n}static isPointInPoly(t,e){for(var r=!1,s=-1,n=t.length,o=n-1;++s<n;o=s)(t[s].z<=e.z&&e.z<t[o].z||t[o].z<=e.z&&e.z<t[s].z)&&e.x<(t[o].x-t[s].x)*(e.z-t[s].z)/(t[o].z-t[s].z)+t[s].x&&(r=!r);return r}static isVectorInPolygon(t,e,r){var s=1e5,n=-1e5,o=[];return e.vertexIds.forEach(t=>{s=Math.min(r[t].y,s),n=Math.max(r[t].y,n),o.push(r[t])}),!!(t.y<n+.5&&t.y>s-.5&&this.isPointInPoly(o,t))}static triarea2(t,e,r){return(r.x-t.x)*(e.z-t.z)-(e.x-t.x)*(r.z-t.z)}static vequal(t,e){return this.distanceToSquared(t,e)<1e-5}static mergeVertices(r,s=1e-4){s=Math.max(s,Number.EPSILON);for(var n={},o=r.getIndex(),i=r.getAttribute(\"position\"),h=o?o.count:i.count,c=0,a=[],u=[],l=Math.log10(1/s),d=Math.pow(10,l),p=0;p<h;p++){var g=o?o.getX(p):p,f=\"\";f+=~~(i.getX(g)*d)+\",\",f+=~~(i.getY(g)*d)+\",\",(f+=~~(i.getZ(g)*d)+\",\")in n?a.push(n[f]):(u.push(i.getX(g)),u.push(i.getY(g)),u.push(i.getZ(g)),n[f]=c,a.push(c),c++)}const v=new t(new Float32Array(u),i.itemSize,i.normalized),b=new e;return b.setAttribute(\"position\",v),b.setIndex(a),b}}class g{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),r=this.content.pop();e!==this.content.length-1&&(this.content[e]=r,this.scoreFunction(r)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const r=(t+1>>1)-1,s=this.content[r];if(!(this.scoreFunction(e)<this.scoreFunction(s)))break;this.content[r]=e,this.content[t]=s,t=r}}bubbleUp(t){const e=this.content.length,r=this.content[t],s=this.scoreFunction(r);for(;;){const n=t+1<<1,o=n-1;let i,h=null;if(o<e&&(i=this.scoreFunction(this.content[o]),i<s&&(h=o)),n<e&&this.scoreFunction(this.content[n])<(null===h?s:i)&&(h=n),null===h)break;this.content[t]=this.content[h],this.content[h]=r,t=h}}}class f{constructor(){this.portals=[]}push(t,e){void 0===e&&(e=t),this.portals.push({left:t,right:e})}stringPull(){const t=this.portals,e=[];let r,s,n,o=0,i=0,h=0;r=t[0].left,s=t[0].left,n=t[0].right,e.push(r);for(let c=1;c<t.length;c++){const a=t[c].left,u=t[c].right;if(p.triarea2(r,n,u)<=0){if(!(p.vequal(r,n)||p.triarea2(r,s,u)>0)){e.push(s),r=s,o=i,s=r,n=r,i=o,h=o,c=o;continue}n=u,h=c}if(p.triarea2(r,s,a)>=0){if(!(p.vequal(r,s)||p.triarea2(r,n,a)<0)){e.push(n),r=n,o=h,s=r,n=r,i=o,h=o,c=o;continue}s=a,i=c}}return 0!==e.length&&p.vequal(e[e.length-1],t[t.length-1].left)||e.push(t[t.length-1].left),this.path=e,e}}class v{constructor(){this.zones={}}static createZone(t,e=1e-4){return class{static buildZone(t,e){const s=this._buildNavigationMesh(t,e),n={};s.vertices.forEach(t=>{t.x=p.roundNumber(t.x,2),t.y=p.roundNumber(t.y,2),t.z=p.roundNumber(t.z,2)}),n.vertices=s.vertices;const o=this._buildPolygonGroups(s);return n.groups=new Array(o.length),o.forEach((t,e)=>{const s=new Map;t.forEach((t,e)=>{s.set(t,e)});const o=new Array(t.length);t.forEach((t,e)=>{const i=[];t.neighbours.forEach(t=>i.push(s.get(t)));const h=[];t.neighbours.forEach(e=>h.push(this._getSharedVerticesInOrder(t,e)));const c=new r(0,0,0);c.add(n.vertices[t.vertexIds[0]]),c.add(n.vertices[t.vertexIds[1]]),c.add(n.vertices[t.vertexIds[2]]),c.divideScalar(3),c.x=p.roundNumber(c.x,2),c.y=p.roundNumber(c.y,2),c.z=p.roundNumber(c.z,2),o[e]={id:e,neighbours:i,vertexIds:t.vertexIds,centroid:c,portals:h}}),n.groups[e]=o}),n}static _buildNavigationMesh(t,e){return t=p.mergeVertices(t,e),this._buildPolygonsFromGeometry(t)}static _spreadGroupId(t){let e=new Set([t]);for(;e.size>0;){const r=e;e=new Set,r.forEach(r=>{r.group=t.group,r.neighbours.forEach(t=>{void 0===t.group&&e.add(t)})})}}static _buildPolygonGroups(t){const e=[];return t.polygons.forEach(t=>{void 0!==t.group?e[t.group].push(t):(t.group=e.length,this._spreadGroupId(t),e.push([t]))}),e}static _buildPolygonNeighbours(t,e){const r=new Set,s=e[t.vertexIds[1]],n=e[t.vertexIds[2]];return e[t.vertexIds[0]].forEach(e=>{e!==t&&(s.includes(e)||n.includes(e))&&r.add(e)}),s.forEach(e=>{e!==t&&n.includes(e)&&r.add(e)}),r}static _buildPolygonsFromGeometry(t){const e=[],s=[],n=t.attributes.position,o=t.index,i=[];for(let t=0;t<n.count;t++)s.push((new r).fromBufferAttribute(n,t)),i[t]=[];for(let r=0;r<t.index.count;r+=3){const t=o.getX(r),s=o.getX(r+1),n=o.getX(r+2),h={vertexIds:[t,s,n],neighbours:null};e.push(h),i[t].push(h),i[s].push(h),i[n].push(h)}return e.forEach(t=>{t.neighbours=this._buildPolygonNeighbours(t,i)}),{polygons:e,vertices:s}}static _getSharedVerticesInOrder(t,e){const r=t.vertexIds,s=r[0],n=r[1],o=r[2],i=e.vertexIds,h=i.includes(s),c=i.includes(n),a=i.includes(o);return h&&c&&a?Array.from(r):h&&c?[s,n]:c&&a?[n,o]:h&&a?[o,s]:(console.warn(\"Error processing navigation mesh neighbors; neighbors with <2 shared vertices found.\"),[])}}.buildZone(t,e)}setZoneData(t,e){this.zones[t]=e}getRandomNode(t,e,s,n){if(!this.zones[t])return new r;s=s||null,n=n||0;const o=[];return this.zones[t].groups[e].forEach(t=>{s&&n?p.distanceToSquared(s,t.centroid)<n*n&&o.push(t.centroid):o.push(t.centroid)}),p.sample(o)||new r}getClosestNode(t,e,r,s=!1){const n=this.zones[e].vertices;let o=null,i=Infinity;return this.zones[e].groups[r].forEach(e=>{const r=p.distanceToSquared(e.centroid,t);r<i&&(!s||p.isVectorInPolygon(t,e,n))&&(o=e,i=r)}),o}findPath(t,e,s,n){const o=this.zones[s].groups[n],i=this.zones[s].vertices,h=this.getClosestNode(t,s,n,!0),c=this.getClosestNode(e,s,n,!0);if(!h||!c)return null;const a=class{static init(t){for(let e=0;e<t.length;e++){const r=t[e];r.f=0,r.g=0,r.h=0,r.cost=1,r.visited=!1,r.closed=!1,r.parent=null}}static cleanUp(t){for(let e=0;e<t.length;e++){const r=t[e];delete r.f,delete r.g,delete r.h,delete r.cost,delete r.visited,delete r.closed,delete r.parent}}static heap(){return new g(function(t){return t.f})}static search(t,e,r){this.init(t);const s=this.heap();for(s.push(e);s.size()>0;){const e=s.pop();if(e===r){let t=e;const r=[];for(;t.parent;)r.push(t),t=t.parent;return this.cleanUp(r),r.reverse()}e.closed=!0;const n=this.neighbours(t,e);for(let t=0,o=n.length;t<o;t++){const o=n[t];if(o.closed)continue;const i=e.g+o.cost,h=o.visited;if(!h||i<o.g){if(o.visited=!0,o.parent=e,!o.centroid||!r.centroid)throw new Error(\"Unexpected state\");o.h=o.h||this.heuristic(o.centroid,r.centroid),o.g=i,o.f=o.g+o.h,h?s.rescoreElement(o):s.push(o)}}}return[]}static heuristic(t,e){return p.distanceToSquared(t,e)}static neighbours(t,e){const r=[];for(let s=0;s<e.neighbours.length;s++)r.push(t[e.neighbours[s]]);return r}}.search(o,h,c),u=function(t,e){for(var r=0;r<t.neighbours.length;r++)if(t.neighbours[r]===e.id)return t.portals[r]},l=new f;l.push(t);for(let t=0;t<a.length;t++){const e=a[t],r=a[t+1];if(r){const t=u(e,r);l.push(i[t[0]],i[t[1]])}}l.push(e),l.stringPull();const d=l.path.map(t=>new r(t.x,t.y,t.z));return d.shift(),d}}v.prototype.getGroup=function(){const t=new s;return function(e,r,s=!1){if(!this.zones[e])return null;let n=null,o=Math.pow(50,2);const i=this.zones[e];for(let e=0;e<i.groups.length;e++){const h=i.groups[e];for(const c of h){if(s&&(t.setFromCoplanarPoints(i.vertices[c.vertexIds[0]],i.vertices[c.vertexIds[1]],i.vertices[c.vertexIds[2]]),Math.abs(t.distanceToPoint(r))<.01)&&p.isPointInPoly([i.vertices[c.vertexIds[0]],i.vertices[c.vertexIds[1]],i.vertices[c.vertexIds[2]]],r))return e;const h=p.distanceToSquared(c.centroid,r);h<o&&(n=e,o=h)}}return n}}(),v.prototype.clampStep=function(){const t=new r,e=new s,o=new n,i=new r;let h,c,a=new r;return function(r,s,n,u,l,d){const p=this.zones[u].vertices,g=this.zones[u].groups[l],f=[n],v={};v[n.id]=0,h=void 0,a.set(0,0,0),c=Infinity,e.setFromCoplanarPoints(p[n.vertexIds[0]],p[n.vertexIds[1]],p[n.vertexIds[2]]),e.projectPoint(s,t),i.copy(t);for(let e=f.pop();e;e=f.pop()){o.set(p[e.vertexIds[0]],p[e.vertexIds[1]],p[e.vertexIds[2]]),o.closestPointToPoint(i,t),t.distanceToSquared(i)<c&&(h=e,a.copy(t),c=t.distanceToSquared(i));const r=v[e.id];if(!(r>2))for(let t=0;t<e.neighbours.length;t++){const s=g[e.neighbours[t]];s.id in v||(f.push(s),v[s.id]=r+1)}}return d.copy(a),h}}();const b={PLAYER:new o(15631215).convertSRGBToLinear().getHex(),TARGET:new o(14469912).convertSRGBToLinear().getHex(),PATH:new o(41903).convertSRGBToLinear().getHex(),WAYPOINT:new o(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new o(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new o(4417387).convertSRGBToLinear().getHex()};class w extends i{constructor(){super(),this._playerMarker=new h(new c(.25,32,32),new a({color:b.PLAYER})),this._targetMarker=new h(new u(.3,.3,.3),new a({color:b.TARGET})),this._nodeMarker=new h(new u(.1,.8,.1),new a({color:b.CLOSEST_NODE})),this._stepMarker=new h(new u(.1,1,.1),new a({color:b.CLAMPED_STEP})),this._pathMarker=new i,this._pathLineMaterial=new l({color:b.PATH,linewidth:2}),this._pathPointMaterial=new a({color:b.WAYPOINT}),this._pathPointGeometry=new c(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(t=>{t.visible=!1,this.add(t)})}setPath(r){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);r=[this._playerMarker.position].concat(r);const s=new e;s.setAttribute(\"position\",new t(new Float32Array(3*r.length),3));for(let t=0;t<r.length;t++)s.attributes.position.setXYZ(t,r[t].x,r[t].y+.2,r[t].z);this._pathMarker.add(new d(s,this._pathLineMaterial));for(let t=0;t<r.length-1;t++){const e=new h(this._pathPointGeometry,this._pathPointMaterial);e.position.copy(r[t]),e.position.y+=.2,this._pathMarker.add(e)}return this._pathMarker.visible=!0,this}setPlayerPosition(t){return this._playerMarker.position.copy(t),this._playerMarker.visible=!0,this}setTargetPosition(t){return this._targetMarker.position.copy(t),this._targetMarker.visible=!0,this}setNodePosition(t){return this._nodeMarker.position.copy(t),this._nodeMarker.visible=!0,this}setStepPosition(t){return this._stepMarker.position.copy(t),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(t=>{t.visible=!1}),this}}export{v as Pathfinding,w as PathfindingHelper};\n//# sourceMappingURL=three-pathfinding.module.js.map\n","const EPS = 0.1;\n\nmodule.exports = AFRAME.registerComponent('checkpoint-controls', {\n  schema: {\n    enabled: {default: true},\n    mode: {default: 'teleport', oneOf: ['teleport', 'animate']},\n    animateSpeed: {default: 3.0}\n  },\n\n  init: function () {\n    this.active = true;\n    this.checkpoint = null;\n\n    this.isNavMeshConstrained = false;\n\n    this.offset = new THREE.Vector3();\n    this.position = new THREE.Vector3();\n    this.targetPosition = new THREE.Vector3();\n  },\n\n  play: function () { this.active = true; },\n  pause: function () { this.active = false; },\n\n  setCheckpoint: function (checkpoint) {\n    const el = this.el;\n\n    if (!this.active) return;\n    if (this.checkpoint === checkpoint) return;\n\n    if (this.checkpoint) {\n      el.emit('navigation-end', {checkpoint: this.checkpoint});\n    }\n\n    this.checkpoint = checkpoint;\n    this.sync();\n\n    // Ignore new checkpoint if we're already there.\n    if (this.position.distanceTo(this.targetPosition) < EPS) {\n      this.checkpoint = null;\n      return;\n    }\n\n    el.emit('navigation-start', {checkpoint: checkpoint});\n\n    if (this.data.mode === 'teleport') {\n      this.el.setAttribute('position', this.targetPosition);\n      this.checkpoint = null;\n      el.emit('navigation-end', {checkpoint: checkpoint});\n      el.components['movement-controls'].updateNavLocation();\n    }\n  },\n\n  isVelocityActive: function () {\n    return !!(this.active && this.checkpoint);\n  },\n\n  getVelocity: function () {\n    if (!this.active) return;\n\n    const data = this.data;\n    const offset = this.offset;\n    const position = this.position;\n    const targetPosition = this.targetPosition;\n    const checkpoint = this.checkpoint;\n\n    this.sync();\n    if (position.distanceTo(targetPosition) < EPS) {\n      this.checkpoint = null;\n      this.el.emit('navigation-end', {checkpoint: checkpoint});\n      return offset.set(0, 0, 0);\n    }\n    offset.setLength(data.animateSpeed);\n    return offset;\n  },\n\n  sync: function () {\n    const offset = this.offset;\n    const position = this.position;\n    const targetPosition = this.targetPosition;\n\n    position.copy(this.el.getAttribute('position'));\n    this.checkpoint.object3D.getWorldPosition(targetPosition);\n    targetPosition.add(this.checkpoint.components.checkpoint.getOffset());\n    offset.copy(targetPosition).sub(position);\n  }\n});\n","/**\n * Gamepad controls for A-Frame.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-gamepad-controls\n *\n * For more information about the Gamepad API, see:\n * https://developer.mozilla.org/en-US/docs/Web/API/Gamepad_API/Using_the_Gamepad_API\n */\n\nconst GamepadButton = require('../../lib/GamepadButton'),\n    GamepadButtonEvent = require('../../lib/GamepadButtonEvent');\n\nconst JOYSTICK_EPS = 0.2;\n\nconst Hand = {\n  LEFT: 'left',\n  RIGHT: 'right'\n};\n\nconst Joystick = {\n  MOVEMENT: 1,\n  ROTATION: 2\n};\n\nmodule.exports = AFRAME.registerComponent('gamepad-controls', {\n\n  /*******************************************************************\n   * Statics\n   */\n\n  GamepadButton: GamepadButton,\n\n  /*******************************************************************\n   * Schema\n   */\n\n  schema: {\n    // Enable/disable gamepad-controls\n    enabled: { default: true },\n\n    // Rotation sensitivity\n    rotationSensitivity: { default: 2.0 },\n  },\n\n  /*******************************************************************\n   * Core\n   */\n\n  /**\n   * Called once when component is attached. Generally for initial setup.\n   */\n  init: function () {\n    const sceneEl = this.el.sceneEl;\n\n    this.system = sceneEl.systems['tracked-controls-webxr'] || {controllers: []};\n\n    this.prevTime = window.performance.now();\n\n    // Button state\n    this.buttons = {};\n\n    // Rotation\n    const rotation = this.el.object3D.rotation;\n    this.pitch = new THREE.Object3D();\n    this.pitch.rotation.x = rotation.x;\n    this.yaw = new THREE.Object3D();\n    this.yaw.position.y = 10;\n    this.yaw.rotation.y = rotation.y;\n    this.yaw.add(this.pitch);\n\n    this._lookVector = new THREE.Vector2();\n    this._moveVector = new THREE.Vector2();\n    this._dpadVector = new THREE.Vector2();\n\n    sceneEl.addBehavior(this);\n  },\n\n  /**\n   * Called when component is attached and when component data changes.\n   * Generally modifies the entity based on the data.\n   */\n  update: function () { this.tick(); },\n\n  /**\n   * Called on each iteration of main render loop.\n   */\n  tick: function (t, dt) {\n    this.updateButtonState();\n    this.updateRotation(dt);\n  },\n\n  /**\n   * Called when a component is removed (e.g., via removeAttribute).\n   * Generally undoes all modifications to the entity.\n   */\n  remove: function () { },\n\n  /*******************************************************************\n   * Movement\n   */\n\n  isVelocityActive: function () {\n    if (!this.data.enabled || !this.isConnected()) return false;\n\n    const dpad = this._dpadVector;\n    const joystick = this._moveVector;\n\n    this.getDpad(dpad);\n    this.getJoystick(Joystick.MOVEMENT, joystick);\n\n    const inputX = dpad.x || joystick.x;\n    const inputY = dpad.y || joystick.y;\n\n    return Math.abs(inputX) > JOYSTICK_EPS || Math.abs(inputY) > JOYSTICK_EPS;\n  },\n\n  getVelocityDelta: function () {\n    const dpad = this._dpadVector;\n    const joystick = this._moveVector;\n\n    this.getDpad(dpad);\n    this.getJoystick(Joystick.MOVEMENT, joystick);\n\n    const inputX = dpad.x || joystick.x;\n    const inputY = dpad.y || joystick.y;\n    const dVelocity = new THREE.Vector3();\n\n    if (Math.abs(inputX) > JOYSTICK_EPS) {\n      dVelocity.x += inputX;\n    }\n    if (Math.abs(inputY) > JOYSTICK_EPS) {\n      dVelocity.z += inputY;\n    }\n\n    return dVelocity;\n  },\n\n  /*******************************************************************\n   * Rotation\n   */\n\n  isRotationActive: function () {\n    if (!this.data.enabled || !this.isConnected()) return false;\n\n    const joystick = this._lookVector;\n\n    this.getJoystick(Joystick.ROTATION, joystick);\n\n    return Math.abs(joystick.x) > JOYSTICK_EPS || Math.abs(joystick.y) > JOYSTICK_EPS;\n  },\n\n  updateRotation: function (dt) {\n    if (!this.isRotationActive()) return;\n\n    const data = this.data;\n    const yaw = this.yaw;\n    const pitch = this.pitch;\n\n    // First copy camera rig pitch/yaw, it may have been changed from\n    // another component.\n    yaw.rotation.y = this.el.object3D.rotation.y;\n    pitch.rotation.x = this.el.object3D.rotation.x;\n\n    const lookVector = this._lookVector;\n\n    this.getJoystick(Joystick.ROTATION, lookVector);\n\n    if (Math.abs(lookVector.x) <= JOYSTICK_EPS) lookVector.x = 0;\n    if (Math.abs(lookVector.y) <= JOYSTICK_EPS) lookVector.y = 0;\n\n    lookVector.multiplyScalar(data.rotationSensitivity * dt / 1000);\n    yaw.rotation.y -= lookVector.x;\n    pitch.rotation.x -= lookVector.y;\n    pitch.rotation.x = Math.max(- Math.PI / 2, Math.min(Math.PI / 2, pitch.rotation.x));\n    this.el.object3D.rotation.set(pitch.rotation.x, yaw.rotation.y, 0);\n  },\n\n  /*******************************************************************\n   * Button events\n   */\n\n  updateButtonState: function () {\n    const gamepad = this.getGamepad(Hand.RIGHT);\n    if (this.data.enabled && gamepad) {\n\n      // Fire DOM events for button state changes.\n      for (var i = 0; i < gamepad.buttons.length; i++) {\n        if (gamepad.buttons[i].pressed && !this.buttons[i]) {\n          this.emit(new GamepadButtonEvent('gamepadbuttondown', i, gamepad.buttons[i]));\n        } else if (!gamepad.buttons[i].pressed && this.buttons[i]) {\n          this.emit(new GamepadButtonEvent('gamepadbuttonup', i, gamepad.buttons[i]));\n        }\n        this.buttons[i] = gamepad.buttons[i].pressed;\n      }\n\n    } else if (Object.keys(this.buttons)) {\n      // Reset state if controls are disabled or controller is lost.\n      this.buttons = {};\n    }\n  },\n\n  emit: function (event) {\n    // Emit original event.\n    this.el.emit(event.type, event);\n\n    // Emit convenience event, identifying button index.\n    this.el.emit(\n      event.type + ':' + event.index,\n      new GamepadButtonEvent(event.type, event.index, event)\n    );\n  },\n\n  /*******************************************************************\n   * Gamepad state\n   */\n\n  /**\n   * Returns the Gamepad instance attached to the component. If connected,\n   * a proxy-controls component may provide access to Gamepad input from a\n   * remote device.\n   *\n   * @param {string} handPreference\n   * @return {Gamepad}\n   */\n  getGamepad: (function () {\n    const _xrGamepads = [];\n    const _empty = [];\n\n    return function (handPreference) {\n      // https://github.com/donmccurdy/aframe-proxy-controls\n      const proxyControls = this.el.sceneEl.components['proxy-controls'];\n      const proxyGamepad = proxyControls && proxyControls.isConnected()\n        && proxyControls.getGamepad(0);\n      if (proxyGamepad) return proxyGamepad;\n\n      // https://www.w3.org/TR/webxr/#dom-xrinputsource-handedness\n      _xrGamepads.length = 0;\n      for (let i = 0; i < this.system.controllers.length; i++) {\n        const xrController = this.system.controllers[i];\n        const xrGamepad = xrController ? xrController.gamepad : null;\n        _xrGamepads.push(xrGamepad);\n        if (xrGamepad && xrController.handedness === handPreference) return xrGamepad;\n      }\n\n      // https://developer.mozilla.org/en-US/docs/Web/API/Gamepad/hand\n      const navGamepads = navigator.getGamepads ? navigator.getGamepads() : _empty;\n      for (let i = 0; i < navGamepads.length; i++) {\n        const navGamepad = navGamepads[i];\n        if (navGamepad && navGamepad.hand === handPreference) return navGamepad;\n      }\n\n      return _xrGamepads[0] || navGamepads[0];\n    };\n  })(),\n\n  /**\n   * Returns the state of the given button.\n   * @param  {number} index The button (0-N) for which to find state.\n   * @return {GamepadButton}\n   */\n  getButton: function (index) {\n    return this.getGamepad(Hand.RIGHT).buttons[index];\n  },\n\n  /**\n   * Returns state of the given axis. Axes are labelled 0-N, where 0-1 will\n   * represent X/Y on the first joystick, and 2-3 X/Y on the second.\n   * @param  {number} index The axis (0-N) for which to find state.\n   * @return {number} On the interval [-1,1].\n   */\n  getAxis: function (index) {\n    return this.getGamepad(index > 1 ? Hand.RIGHT : Hand.LEFT).axes[index];\n  },\n\n  /**\n   * Returns the state of the specified joystick as a THREE.Vector2.\n   * @param  {Joystick} role\n   * @param  {THREE.Vector2} target\n   * @return {THREE.Vector2}\n   */\n  getJoystick: function (index, target) {\n    const gamepad = this.getGamepad(index === Joystick.MOVEMENT ? Hand.LEFT : Hand.RIGHT);\n    // gamepad can be null here if it becomes disconnected even if isConnected() was called\n    // in the same tick before calling getJoystick.\n    if (!gamepad) {\n      return target.set(0, 0);\n    }\n    if (gamepad.mapping === 'xr-standard') {\n      // See: https://github.com/donmccurdy/aframe-extras/issues/307\n      switch (index) {\n        case Joystick.MOVEMENT: return target.set(gamepad.axes[2], gamepad.axes[3]);\n        case Joystick.ROTATION: return target.set(gamepad.axes[2], 0);\n      }\n    } else {\n      switch (index) {\n        case Joystick.MOVEMENT: return target.set(gamepad.axes[0], gamepad.axes[1]);\n        case Joystick.ROTATION: return target.set(gamepad.axes[2], gamepad.axes[3]);\n      }\n    }\n    throw new Error('Unexpected joystick index \"%d\".', index);\n  },\n\n  /**\n   * Returns the state of the dpad as a THREE.Vector2.\n   * @param {THREE.Vector2} target\n   * @return {THREE.Vector2}\n   */\n  getDpad: function (target) {\n    const gamepad = this.getGamepad(Hand.LEFT);\n    if (!gamepad) {\n      return target.set(0, 0);\n    }\n    if (!gamepad.buttons[GamepadButton.DPAD_RIGHT]) {\n      return target.set(0, 0);\n    }\n    return target.set(\n      (gamepad.buttons[GamepadButton.DPAD_RIGHT].pressed ? 1 : 0)\n      + (gamepad.buttons[GamepadButton.DPAD_LEFT].pressed ? -1 : 0),\n      (gamepad.buttons[GamepadButton.DPAD_UP].pressed ? -1 : 0)\n      + (gamepad.buttons[GamepadButton.DPAD_DOWN].pressed ? 1 : 0)\n    );\n  },\n\n  /**\n   * Returns true if the gamepad is currently connected to the system.\n   * @return {boolean}\n   */\n  isConnected: function () {\n    const gamepad = this.getGamepad(Hand.LEFT);\n    return !!(gamepad && gamepad.connected);\n  },\n\n  /**\n   * Returns a string containing some information about the controller. Result\n   * may vary across browsers, for a given controller.\n   * @return {string}\n   */\n  getID: function () {\n    return this.getGamepad(Hand.LEFT).id;\n  }\n});\n","require('./checkpoint-controls');\nrequire('./gamepad-controls');\nrequire('./keyboard-controls');\nrequire('./touch-controls');\nrequire('./movement-controls');\nrequire('./trackpad-controls');\nrequire('./nipple-controls');\n","/* global AFRAME, THREE */\n/* eslint-disable no-prototype-builtins */\nrequire('../../lib/keyboard.polyfill');\n\nconst PROXY_FLAG = '__keyboard-controls-proxy';\n\nconst KeyboardEvent = window.KeyboardEvent;\n\n/**\n * Keyboard Controls component.\n *\n * Stripped-down version of: https://github.com/donmccurdy/aframe-keyboard-controls\n *\n * Bind keyboard events to components, or control your entities with the WASD keys.\n *\n * Why use KeyboardEvent.code? \"This is set to a string representing the key that was pressed to\n * generate the KeyboardEvent, without taking the current keyboard layout (e.g., QWERTY vs.\n * Dvorak), locale (e.g., English vs. French), or any modifier keys into account. This is useful\n * when you care about which physical key was pressed, rather thanwhich character it corresponds\n * to. For example, if you’re a writing a game, you might want a certain set of keys to move the\n * player in different directions, and that mapping should ideally be independent of keyboard\n * layout. See: https://developers.google.com/web/updates/2016/04/keyboardevent-keys-codes\n *\n * @namespace wasd-controls\n * keys the entity moves and if you release it will stop. Easing simulates friction.\n * to the entity when pressing the keys.\n * @param {bool} [enabled=true] - To completely enable or disable the controls\n */\nmodule.exports = AFRAME.registerComponent('keyboard-controls', {\n  schema: {\n    enabled:           { default: true },\n    debug:             { default: false }\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.localKeys = {};\n    this.listeners = {\n      keydown: this.onKeyDown.bind(this),\n      keyup: this.onKeyUp.bind(this),\n      blur: this.onBlur.bind(this),\n      onContextMenu: this.onContextMenu.bind(this),\n    };\n  },\n\n  /*******************************************************************\n  * Movement\n  */\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!Object.keys(this.getKeys()).length;\n  },\n\n  getVelocityDelta: function () {\n    const data = this.data;\n    const keys = this.getKeys();\n\n    this.dVelocity.set(0, 0, 0);\n    if (data.enabled) {\n      if (keys.KeyW || keys.ArrowUp)    { this.dVelocity.z -= 1; }\n      if (keys.KeyA || keys.ArrowLeft)  { this.dVelocity.x -= 1; }\n      if (keys.KeyS || keys.ArrowDown)  { this.dVelocity.z += 1; }\n      if (keys.KeyD || keys.ArrowRight) { this.dVelocity.x += 1; }\n    }\n\n    return this.dVelocity.clone();\n  },\n\n  /*******************************************************************\n  * Events\n  */\n\n  play: function () {\n    this.attachEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n  },\n\n  attachEventListeners: function () {\n    window.addEventListener(\"contextmenu\", this.listeners.onContextMenu, false);\n    window.addEventListener(\"keydown\", this.listeners.keydown, false);\n    window.addEventListener(\"keyup\", this.listeners.keyup, false);\n    window.addEventListener(\"blur\", this.listeners.blur, false);\n  },\n\n  onContextMenu: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n\n  removeEventListeners: function () {\n    window.removeEventListener('keydown', this.listeners.keydown);\n    window.removeEventListener('keyup', this.listeners.keyup);\n    window.removeEventListener('blur', this.listeners.blur);\n  },\n\n  onKeyDown: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      this.localKeys[event.code] = true;\n      this.emit(event);\n    }\n  },\n\n  onKeyUp: function (event) {\n    if (AFRAME.utils.shouldCaptureKeyEvent(event)) {\n      delete this.localKeys[event.code];\n      this.emit(event);\n    }\n  },\n\n  onBlur: function () {\n    for (const code in this.localKeys) {\n      if (this.localKeys.hasOwnProperty(code)) {\n        delete this.localKeys[code];\n      }\n    }\n  },\n\n  emit: function (event) {\n    // TODO - keydown only initially?\n    // TODO - where the f is the spacebar\n\n    // Emit original event.\n    if (PROXY_FLAG in event) {\n      // TODO - Method never triggered.\n      this.el.emit(event.type, event);\n    }\n\n    // Emit convenience event, identifying key.\n    this.el.emit(event.type + ':' + event.code, new KeyboardEvent(event.type, event));\n    if (this.data.debug) console.log(event.type + ':' + event.code);\n  },\n\n  /*******************************************************************\n  * Accessors\n  */\n\n  isPressed: function (code) {\n    return code in this.getKeys();\n  },\n\n  getKeys: function () {\n    if (this.isProxied()) {\n      return this.el.sceneEl.components['proxy-controls'].getKeyboard();\n    }\n    return this.localKeys;\n  },\n\n  isProxied: function () {\n    const proxyControls = this.el.sceneEl.components['proxy-controls'];\n    return proxyControls && proxyControls.isConnected();\n  }\n\n});\n","/**\n * Movement Controls\n *\n * @author Don McCurdy <dm@donmccurdy.com>\n */\n\nconst COMPONENT_SUFFIX = '-controls';\nconst MAX_DELTA = 0.2; // ms\nconst EPS = 10e-6;\nconst MOVED = 'moved';\n\nmodule.exports = AFRAME.registerComponent('movement-controls', {\n\n  /*******************************************************************\n   * Schema\n   */\n\n  dependencies: ['rotation'],\n\n  schema: {\n    enabled:            { default: true },\n    controls:           { default: ['gamepad', 'trackpad', 'keyboard', 'touch'] },\n    speed:              { default: 0.3, min: 0 },\n    fly:                { default: false },\n    constrainToNavMesh: { default: false },\n    camera:             { default: '[movement-controls] [camera]', type: 'selector' }\n  },\n\n  /*******************************************************************\n   * Lifecycle\n   */\n\n  init: function () {\n    const el = this.el;\n    if (!this.data.camera) {\n      this.data.camera = el.querySelector('[camera]');\n    }\n    this.velocityCtrl = null;\n\n    this.velocity = new THREE.Vector3();\n    this.heading = new THREE.Quaternion();\n    this.eventDetail = {};\n\n    // Navigation\n    this.navGroup = null;\n    this.navNode = null;\n\n    if (el.sceneEl.hasLoaded) {\n      this.injectControls();\n    } else {\n      el.sceneEl.addEventListener('loaded', this.injectControls.bind(this));\n    }\n  },\n\n  update: function (prevData) {\n    const el = this.el;\n    const data = this.data;\n    const nav = el.sceneEl.systems.nav;\n    if (el.sceneEl.hasLoaded) {\n      this.injectControls();\n    }\n    if (nav && data.constrainToNavMesh !== prevData.constrainToNavMesh) {\n      data.constrainToNavMesh\n        ? nav.addAgent(this)\n        : nav.removeAgent(this);\n    }\n    if (data.enabled !== prevData.enabled) {\n      // Propagate the enabled change to all controls\n      for (let i = 0; i < data.controls.length; i++) {\n        const name = data.controls[i] + COMPONENT_SUFFIX;\n        this.el.setAttribute(name, { enabled: this.data.enabled });\n      }\n    }\n  },\n\n  injectControls: function () {\n    const data = this.data;\n\n    for (let i = 0; i < data.controls.length; i++) {\n      const name = data.controls[i] + COMPONENT_SUFFIX;\n      this.el.setAttribute(name, { enabled: this.data.enabled });\n    }\n  },\n\n  updateNavLocation: function () {\n    this.navGroup = null;\n    this.navNode = null;\n  },\n\n  /*******************************************************************\n   * Tick\n   */\n\n  tick: (function () {\n    const start = new THREE.Vector3();\n    const end = new THREE.Vector3();\n    const clampedEnd = new THREE.Vector3();\n\n    return function (t, dt) {\n      if (!dt) return;\n\n      const el = this.el;\n      const data = this.data;\n\n      if (!data.enabled) return;\n\n      this.updateVelocityCtrl();\n      const velocityCtrl = this.velocityCtrl;\n      const velocity = this.velocity;\n\n      if (!velocityCtrl) return;\n\n      // Update velocity. If FPS is too low, reset.\n      if (dt / 1000 > MAX_DELTA) {\n        velocity.set(0, 0, 0);\n      } else {\n        this.updateVelocity(dt);\n      }\n\n      if (data.constrainToNavMesh\n          && velocityCtrl.isNavMeshConstrained !== false) {\n\n        if (velocity.lengthSq() < EPS) return;\n\n        start.copy(el.object3D.position);\n        end\n          .copy(velocity)\n          .multiplyScalar(dt / 1000)\n          .add(start);\n\n        const nav = el.sceneEl.systems.nav;\n        this.navGroup = this.navGroup === null ? nav.getGroup(start) : this.navGroup;\n        this.navNode = this.navNode || nav.getNode(start, this.navGroup);\n        this.navNode = nav.clampStep(start, end, this.navGroup, this.navNode, clampedEnd);\n        el.object3D.position.copy(clampedEnd);\n      } else if (el.hasAttribute('velocity')) {\n        el.setAttribute('velocity', velocity);\n      } else {\n        el.object3D.position.x += velocity.x * dt / 1000;\n        el.object3D.position.y += velocity.y * dt / 1000;\n        el.object3D.position.z += velocity.z * dt / 1000;\n      }\n\n    };\n  }()),\n\n  /*******************************************************************\n   * Movement\n   */\n\n  updateVelocityCtrl: function () {\n    const data = this.data;\n    if (data.enabled) {\n      for (let i = 0, l = data.controls.length; i < l; i++) {\n        const control = this.el.components[data.controls[i] + COMPONENT_SUFFIX];\n        if (control && control.isVelocityActive()) {\n          this.velocityCtrl = control;\n          return;\n        }\n      }\n      this.velocityCtrl = null;\n    }\n  },\n\n  updateVelocity: (function () {\n    const vector2 = new THREE.Vector2();\n    const quaternion = new THREE.Quaternion();\n\n    return function (dt) {\n      let dVelocity;\n      const el = this.el;\n      const control = this.velocityCtrl;\n      const velocity = this.velocity;\n      const data = this.data;\n\n      if (control) {\n        if (control.getVelocityDelta) {\n          dVelocity = control.getVelocityDelta(dt);\n        } else if (control.getVelocity) {\n          velocity.copy(control.getVelocity());\n          return;\n        } else if (control.getPositionDelta) {\n          velocity.copy(control.getPositionDelta(dt).multiplyScalar(1000 / dt));\n          return;\n        } else {\n          throw new Error('Incompatible movement controls: ', control);\n        }\n      }\n\n      if (el.hasAttribute('velocity') && !data.constrainToNavMesh) {\n        velocity.copy(this.el.getAttribute('velocity'));\n      }\n\n      if (dVelocity && data.enabled) {\n        const cameraEl = data.camera;\n\n        // Rotate to heading\n        quaternion.copy(cameraEl.object3D.quaternion);\n        quaternion.premultiply(el.object3D.quaternion);\n        dVelocity.applyQuaternion(quaternion);\n\n        const factor = dVelocity.length();\n        if (data.fly) {\n          velocity.copy(dVelocity);\n          velocity.multiplyScalar(this.data.speed * 16.66667);\n        } else {\n          vector2.set(dVelocity.x, dVelocity.z);\n          vector2.setLength(factor * this.data.speed * 16.66667);\n          velocity.x = vector2.x;\n          velocity.y = 0;\n          velocity.z = vector2.y;\n        }\n        if (velocity.x !== 0 || velocity.y !== 0 || velocity.z !== 0) {\n          this.eventDetail.velocity = velocity;\n          this.el.emit(MOVED, this.eventDetail);\n        }\n      }\n    };\n\n  }())\n});\n","/* global AFRAME, THREE */\nimport nipplejs from \"nipplejs\";\n\nAFRAME.registerComponent(\"nipple-controls\", {\n  schema: {\n    enabled: { default: true },\n    mode: { default: \"dynamic\", oneOf: [\"static\", \"semi\", \"dynamic\"] },\n    rotationSensitivity: { default: 1.0 },\n    moveJoystickEnabled: { default: true },\n    lookJoystickEnabled: { default: true },\n    sideMargin: { default: \"30px\" },\n    bottomMargin: { default: \"70px\" },\n    moveJoystickPosition: { default: \"left\", oneOf: [\"left\", \"right\"] },\n    lookJoystickPosition: { default: \"right\", oneOf: [\"left\", \"right\"] },\n  },\n\n  init() {\n    this.dVelocity = new THREE.Vector3();\n    this.lookVector = new THREE.Vector2();\n    const lookControls = this.el.querySelector(\"[look-controls]\").components[\"look-controls\"];\n    this.pitchObject = lookControls.pitchObject;\n    this.yawObject = lookControls.yawObject;\n    this.rigRotation = this.el.object3D.rotation;\n    this.moveData = undefined;\n    this.lookData = undefined;\n    this.moving = false;\n    this.rotating = false;\n  },\n\n  update(oldData) {\n    if (\n      this.data.moveJoystickPosition !== oldData.moveJoystickPosition ||\n      this.data.sideMargin !== oldData.sideMargin ||\n      this.data.bottomMargin !== oldData.bottomMargin ||\n      this.data.mode !== oldData.mode\n    ) {\n      this.removeMoveJoystick();\n    }\n    if (\n      this.data.lookJoystickPosition !== oldData.lookJoystickPosition ||\n      this.data.sideMargin !== oldData.sideMargin ||\n      this.data.bottomMargin !== oldData.bottomMargin ||\n      this.data.mode !== oldData.mode\n    ) {\n      this.removeLookJoystick();\n    }\n    if (this.data.enabled && this.data.moveJoystickEnabled) {\n      this.createMoveJoystick();\n    } else {\n      this.removeMoveJoystick();\n    }\n    if (this.data.enabled && this.data.lookJoystickEnabled) {\n      this.createLookJoystick();\n    } else {\n      this.removeLookJoystick();\n    }\n  },\n\n  pause() {\n    this.moving = false;\n    this.rotating = false;\n  },\n\n  remove() {\n    this.removeMoveJoystick();\n    this.removeLookJoystick();\n  },\n\n  isVelocityActive() {\n    return this.data.enabled && this.moving;\n  },\n\n  getVelocityDelta() {\n    this.dVelocity.set(0, 0, 0);\n    if (this.isVelocityActive()) {\n      const force = this.moveData.force < 1 ? this.moveData.force : 1;\n      const angle = this.moveData.angle.radian;\n      const x = Math.cos(angle) * force;\n      const z = -Math.sin(angle) * force;\n      this.dVelocity.set(x, 0, z);\n    }\n    return this.dVelocity; // We don't do a clone() here, the Vector3 will be modified by the calling code but that's fine.\n  },\n\n  isRotationActive() {\n    return this.data.enabled && this.rotating;\n  },\n\n  updateRotation(dt) {\n    if (!this.isRotationActive()) return;\n\n    const force = this.lookData.force < 1 ? this.lookData.force : 1;\n    const angle = this.lookData.angle.radian;\n    const lookVector = this.lookVector;\n    lookVector.x = Math.cos(angle) * force;\n    lookVector.y = Math.sin(angle) * force;\n    lookVector.multiplyScalar((this.data.rotationSensitivity * dt) / 1000);\n\n    this.yawObject.rotation.y -= lookVector.x;\n    let x = this.pitchObject.rotation.x + lookVector.y;\n    x = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, x));\n    this.pitchObject.rotation.x = x;\n  },\n\n  tick: function (t, dt) {\n    this.updateRotation(dt);\n  },\n\n  initLeftZone() {\n    const leftZone = document.createElement(\"div\");\n    leftZone.setAttribute(\"id\", \"joystickLeftZone\");\n    leftZone.setAttribute(\n      \"style\",\n      `position:absolute;${this.data.moveJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`\n    );\n    document.body.appendChild(leftZone);\n    this.leftZone = leftZone;\n  },\n\n  initRightZone() {\n    const rightZone = document.createElement(\"div\");\n    rightZone.setAttribute(\"id\", \"joystickRightZone\");\n    rightZone.setAttribute(\n      \"style\",\n      `position:absolute;${this.data.lookJoystickPosition}:${this.data.sideMargin};bottom:${this.data.bottomMargin};z-index:1`\n    );\n    document.body.appendChild(rightZone);\n    this.rightZone = rightZone;\n  },\n\n  createMoveJoystick() {\n    if (this.moveJoystick) return;\n    this.initLeftZone();\n    const options = {\n      mode: this.data.mode,\n      zone: this.leftZone,\n      color: \"white\",\n      fadeTime: 0,\n    };\n    this.leftZone.style.width = \"100px\";\n    if (this.data.mode === \"static\") {\n      this.leftZone.style.height = \"100px\";\n      options.position = { left: \"50%\", bottom: \"50%\" };\n    } else {\n      this.leftZone.style.height = \"400px\";\n    }\n\n    this.moveJoystick = nipplejs.create(options);\n    this.moveJoystick.on(\"move\", (evt, data) => {\n      this.moveData = data;\n      this.moving = true;\n    });\n    this.moveJoystick.on(\"end\", (evt, data) => {\n      this.moving = false;\n    });\n  },\n\n  createLookJoystick() {\n    if (this.lookJoystick) return;\n    this.initRightZone();\n    const options = {\n      mode: this.data.mode,\n      zone: this.rightZone,\n      color: \"white\",\n      fadeTime: 0,\n    };\n    this.rightZone.style.width = \"100px\";\n    if (this.data.mode === \"static\") {\n      this.rightZone.style.height = \"100px\";\n      options.position = { left: \"50%\", bottom: \"50%\" };\n    } else {\n      this.rightZone.style.height = \"400px\";\n    }\n\n    this.lookJoystick = nipplejs.create(options);\n    this.lookJoystick.on(\"move\", (evt, data) => {\n      this.lookData = data;\n      this.rotating = true;\n    });\n    this.lookJoystick.on(\"end\", (evt, data) => {\n      this.rotating = false;\n    });\n  },\n\n  removeMoveJoystick() {\n    if (this.moveJoystick) {\n      this.moveJoystick.destroy();\n      this.moveJoystick = undefined;\n    }\n\n    this.moveData = undefined;\n\n    if (this.leftZone && this.leftZone.parentNode) {\n      this.leftZone.remove();\n      this.leftZone = undefined;\n    }\n  },\n\n  removeLookJoystick() {\n    if (this.lookJoystick) {\n      this.lookJoystick.destroy();\n      this.lookJoystick = undefined;\n    }\n\n    this.lookData = undefined;\n\n    if (this.rightZone && this.rightZone.parentNode) {\n      this.rightZone.remove();\n      this.rightZone = undefined;\n    }\n  },\n});\n","/**\n * Touch-to-move-forward controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('touch-controls', {\n  schema: {\n    enabled: { default: true },\n    reverseEnabled: { default: true }\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.bindMethods();\n    this.direction = 0;\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  addEventListeners: function () {\n    const sceneEl = this.el.sceneEl;\n    const canvasEl = sceneEl.canvas;\n\n    if (!canvasEl) {\n      sceneEl.addEventListener('render-target-loaded', this.addEventListeners.bind(this));\n      return;\n    }\n\n    canvasEl.addEventListener('touchstart', this.onTouchStart);\n    canvasEl.addEventListener('touchend', this.onTouchEnd);\n    const vrModeUI = sceneEl.getAttribute('vr-mode-ui');\n    if (vrModeUI && vrModeUI.cardboardModeEnabled) {\n      sceneEl.addEventListener('enter-vr', this.onEnterVR);\n    }\n  },\n\n  removeEventListeners: function () {\n    const canvasEl = this.el.sceneEl && this.el.sceneEl.canvas;\n    if (!canvasEl) { return; }\n\n    canvasEl.removeEventListener('touchstart', this.onTouchStart);\n    canvasEl.removeEventListener('touchend', this.onTouchEnd);\n    this.el.sceneEl.removeEventListener('enter-vr', this.onEnterVR)\n  },\n\n  isVelocityActive: function () {\n    return this.data.enabled && !!this.direction;\n  },\n\n  getVelocityDelta: function () {\n    this.dVelocity.z = this.direction;\n    return this.dVelocity.clone();\n  },\n\n  bindMethods: function () {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n  },\n\n  onTouchStart: function (e) {\n    this.direction = -1;\n    if (this.data.reverseEnabled && e.touches && e.touches.length === 2) {\n      this.direction = 1;\n    }\n    e.preventDefault();\n  },\n\n  onTouchEnd: function (e) {\n    this.direction = 0;\n    e.preventDefault();\n  },\n\n  onEnterVR: function () {\n    // This is to make the Cardboard button on Chrome Android working\n    const xrSession = this.el.sceneEl.xrSession;\n    if (!xrSession) { return; }\n    xrSession.addEventListener('selectstart', this.onTouchStart);\n    xrSession.addEventListener('selectend', this.onTouchEnd);\n  }\n});\n","/**\n * 3dof (Gear VR, Daydream) controls for mobile.\n */\nmodule.exports = AFRAME.registerComponent('trackpad-controls', {\n  schema: {\n    enabled: { default: true },\n    enableNegX: { default: true },\n    enablePosX: { default: true },\n    enableNegZ: { default: true },\n    enablePosZ: { default: true },\n    mode: { default: 'touch', oneOf: ['swipe', 'touch', 'press'] }\n\n  },\n\n  init: function () {\n    this.dVelocity = new THREE.Vector3();\n    this.zVel      = 0;\n    this.xVel      = 0;\n    this.bindMethods();\n  },\n\n  play: function () {\n    this.addEventListeners();\n  },\n\n  pause: function () {\n    this.removeEventListeners();\n    this.dVelocity.set(0, 0, 0);\n  },\n\n  remove: function () {\n    this.pause();\n  },\n\n  addEventListeners: function () {\n    const data = this.data;\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.addEventListener('axismove', this.onAxisMove);\n\n    switch (data.mode) {\n      case 'swipe':\n      case 'touch':\n        sceneEl.addEventListener('trackpadtouchstart', this.onTouchStart);\n        sceneEl.addEventListener('trackpadtouchend', this.onTouchEnd);\n        break;\n\n      case 'press':\n        sceneEl.addEventListener('trackpaddown', this.onTouchStart);\n        sceneEl.addEventListener('trackpadup', this.onTouchEnd);\n        break;\n    }\n\n  },\n\n  removeEventListeners: function () {\n    const sceneEl = this.el.sceneEl;\n\n    sceneEl.removeEventListener('axismove', this.onAxisMove);\n    sceneEl.removeEventListener('trackpadtouchstart', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadtouchend', this.onTouchEnd);\n    sceneEl.removeEventListener('trackpaddown', this.onTouchStart);\n    sceneEl.removeEventListener('trackpadup', this.onTouchEnd);\n  },\n\n  isVelocityActive: function () {\n    return this.data.enabled && this.isMoving;\n  },\n\n  getVelocityDelta: function () {\n    this.dVelocity.z = this.isMoving ? -this.zVel : 1;\n    this.dVelocity.x = this.isMoving ? this.xVel : 1;\n    return this.dVelocity.clone();\n  },\n\n  bindMethods: function () {\n    this.onTouchStart = this.onTouchStart.bind(this);\n    this.onTouchEnd = this.onTouchEnd.bind(this);\n    this.onAxisMove = this.onAxisMove.bind(this);\n  },\n\n  onTouchStart: function (e) {\n    switch(this.data.mode){\n      case 'swipe':\n        this.canRecordAxis = true;\n        this.startingAxisData = [];\n        break;\n      case 'touch':\n        this.isMoving = true;\n        break;\n      case 'press':\n        this.isMoving = true;\n        break;\n    }\n\n    e.preventDefault();\n  },\n\n  onTouchEnd: function (e) {\n    if(this.data.mode == 'swipe') {\n        this.startingAxisData = [];\n    }\n\n    this.isMoving = false;\n    e.preventDefault();\n  },\n\n  onAxisMove: function(e){\n    switch (this.data.mode) {\n      case 'swipe':\n        return this.handleSwipeAxis(e);\n      case 'touch':\n      case 'press':\n        return this.handleTouchAxis(e);\n    }\n  },\n\n  handleSwipeAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    if(this.startingAxisData.length === 0 && this.canRecordAxis){\n      this.canRecordAxis = false;\n      this.startingAxisData[0] = axisData[0];\n      this.startingAxisData[1] = axisData[1];\n    }\n\n    if(this.startingAxisData.length > 0){\n      let velX = 0;\n      let velZ = 0;\n\n      if (data.enableNegX && axisData[0] < this.startingAxisData[0]) {\n        velX = -1;\n      }\n\n      if (data.enablePosX && axisData[0] > this.startingAxisData[0]) {\n        velX = 1;\n      }\n\n      if (data.enablePosZ && axisData[1] > this.startingAxisData[1]) {\n        velZ = -1;\n      }\n\n      if (data.enableNegZ && axisData[1] < this.startingAxisData[1]) {\n        velZ = 1;\n      }\n\n      const absChangeZ  = Math.abs(this.startingAxisData[1] - axisData[1]);\n      const absChangeX  = Math.abs(this.startingAxisData[0] - axisData[0]);\n\n      if (absChangeX > absChangeZ) {\n        this.zVel = 0;\n        this.xVel = velX;\n        this.isMoving = true;\n      } else {\n        this.xVel = 0;\n        this.zVel = velZ;\n        this.isMoving = true;\n      }\n\n    }\n  },\n\n  handleTouchAxis: function(e) {\n    const data = this.data;\n    const axisData = e.detail.axis;\n\n    let velX = 0;\n    let velZ = 0;\n\n    if (data.enableNegX && axisData[0] < 0) {\n      velX = -1;\n    }\n\n    if (data.enablePosX && axisData[0] > 0) {\n      velX = 1;\n    }\n\n    if (data.enablePosZ && axisData[1] > 0) {\n      velZ = -1;\n    }\n\n    if (data.enableNegZ && axisData[1] < 0) {\n      velZ = 1;\n    }\n\n    if (Math.abs(axisData[0]) > Math.abs(axisData[1])) {\n      this.zVel = 0;\n      this.xVel = velX;\n    } else {\n      this.xVel = 0;\n      this.zVel = velZ;\n    }\n\n  }\n\n});\n\n","const LoopMode = {\n  once: THREE.LoopOnce,\n  repeat: THREE.LoopRepeat,\n  pingpong: THREE.LoopPingPong\n};\n\n/**\n * animation-mixer\n *\n * Player for animation clips. Intended to be compatible with any model format that supports\n * skeletal or morph animations through THREE.AnimationMixer.\n * See: https://threejs.org/docs/?q=animation#Reference/Animation/AnimationMixer\n */\nmodule.exports = AFRAME.registerComponent('animation-mixer', {\n  schema: {\n    clip: { default: '*' },\n    useRegExp: {default: false},\n    duration: { default: 0 },\n    clampWhenFinished: { default: false, type: 'boolean' },\n    crossFadeDuration: { default: 0 },\n    loop: { default: 'repeat', oneOf: Object.keys(LoopMode) },\n    repetitions: { default: Infinity, min: 0 },\n    timeScale: { default: 1 },\n    startAt: { default: 0 }\n  },\n\n  init: function () {\n    /** @type {THREE.Mesh} */\n    this.model = null;\n    /** @type {THREE.AnimationMixer} */\n    this.mixer = null;\n    /** @type {Array<THREE.AnimationAction>} */\n    this.activeActions = [];\n\n    const model = this.el.getObject3D('mesh');\n\n    if (model) {\n      this.load(model);\n    } else {\n      this.el.addEventListener('model-loaded', (e) => {\n        this.load(e.detail.model);\n      });\n    }\n  },\n\n  load: function (model) {\n    const el = this.el;\n    this.model = model;\n    this.mixer = new THREE.AnimationMixer(model);\n    this.mixer.addEventListener('loop', (e) => {\n      el.emit('animation-loop', { action: e.action, loopDelta: e.loopDelta });\n    });\n    this.mixer.addEventListener('finished', (e) => {\n      el.emit('animation-finished', { action: e.action, direction: e.direction });\n    });\n    if (this.data.clip) this.update({});\n  },\n\n  remove: function () {\n    if (this.mixer) this.mixer.stopAllAction();\n  },\n\n  update: function (prevData) {\n    if (!prevData) return;\n\n    const data = this.data;\n    const changes = AFRAME.utils.diff(data, prevData);\n\n    // If selected clips have changed, restart animation.\n    if ('clip' in changes) {\n      this.stopAction();\n      if (data.clip) this.playAction();\n      return;\n    }\n\n    // Otherwise, modify running actions.\n    this.activeActions.forEach((action) => {\n      if ('duration' in changes && data.duration) {\n        action.setDuration(data.duration);\n      }\n      if ('clampWhenFinished' in changes) {\n        action.clampWhenFinished = data.clampWhenFinished;\n      }\n      if ('loop' in changes || 'repetitions' in changes) {\n        action.setLoop(LoopMode[data.loop], data.repetitions);\n      }\n      if ('timeScale' in changes) {\n        action.setEffectiveTimeScale(data.timeScale);\n      }\n    });\n  },\n\n  stopAction: function () {\n    const data = this.data;\n    for (let i = 0; i < this.activeActions.length; i++) {\n      data.crossFadeDuration\n        ? this.activeActions[i].fadeOut(data.crossFadeDuration)\n        : this.activeActions[i].stop();\n    }\n    this.activeActions.length = 0;\n  },\n\n  playAction: function () {\n    if (!this.mixer) return;\n\n    const model = this.model,\n      data = this.data,\n      clips = model.animations || (model.geometry || {}).animations || [];\n\n    if (!clips.length) return;\n\n    const re = data.useRegExp ? data.clip : wildcardToRegExp(data.clip);\n\n    for (let clip, i = 0; (clip = clips[i]); i++) {\n      if (clip.name.match(re)) {\n        const action = this.mixer.clipAction(clip, model);\n\n        action.enabled = true;\n        action.clampWhenFinished = data.clampWhenFinished;\n        if (data.duration) action.setDuration(data.duration);\n        if (data.timeScale !== 1) action.setEffectiveTimeScale(data.timeScale);\n        // animation-mixer.startAt and AnimationAction.startAt have very different meanings.\n        // animation-mixer.startAt indicates which frame in the animation to start at, in msecs.\n        // AnimationAction.startAt indicates when to start the animation (from the 1st frame),\n        // measured in global mixer time, in seconds.\n        action.startAt(this.mixer.time - data.startAt / 1000);\n        action\n          .setLoop(LoopMode[data.loop], data.repetitions)\n          .fadeIn(data.crossFadeDuration)\n          .play();\n        this.activeActions.push(action);\n      }\n    }\n  },\n\n  tick: function (t, dt) {\n    if (this.mixer && !isNaN(dt)) this.mixer.update(dt / 1000);\n  }\n});\n\n/**\n * Creates a RegExp from the given string, converting asterisks to .* expressions,\n * and escaping all other characters.\n */\nfunction wildcardToRegExp(s) {\n  return new RegExp('^' + s.split(/\\*+/).map(regExpEscape).join('.*') + '$');\n}\n\n/**\n * RegExp-escapes all characters in the given string.\n */\nfunction regExpEscape(s) {\n  return s.replace(/[|\\\\{}()[\\]^$+*?.]/g, '\\\\$&');\n}\n","THREE.ColladaLoader = require('../../lib/ColladaLoader');\n\n/**\n * collada-model-legacy\n *\n * Loader for COLLADA (.dae) format.\n */\nmodule.exports.Component = AFRAME.registerComponent('collada-model-legacy', {\n  schema: {type: 'asset'},\n\n  init: function () {\n    this.model = null;\n    this.loader = new THREE.ColladaLoader();\n  },\n\n  update: function () {\n    var self = this;\n    var el = this.el;\n    var src = this.data;\n    var rendererSystem = this.el.sceneEl.systems.renderer;\n\n    if (!src) { return; }\n\n    this.remove();\n\n    this.loader.load(src, function (colladaModel) {\n      self.model = colladaModel.scene;\n      self.model.traverse(function (object) {\n        if (object.isMesh) {\n          var material = object.material;\n          if (material.color) rendererSystem.applyColorCorrection(material.color);\n          if (material.map) rendererSystem.applyColorCorrection(material.map);\n          if (material.emissive) rendererSystem.applyColorCorrection(material.emissive);\n          if (material.emissiveMap) rendererSystem.applyColorCorrection(material.emissiveMap);\n        }\n      });\n      el.setObject3D('mesh', self.model);\n      el.emit('model-loaded', {format: 'collada', model: self.model});\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","/*!\nfflate - fast JavaScript compression/decompression\n<https://101arrowz.github.io/fflate>\nLicensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE\nversion 0.6.9\n*/\n\n// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar durl = function (c) { return URL.createObjectURL(new Blob([c], { type: 'text/javascript' })); };\nvar cwk = function (u) { return new Worker(u); };\ntry {\n    URL.revokeObjectURL(durl(''));\n}\ncatch (e) {\n    // We're in Deno or a very old browser\n    durl = function (c) { return 'data:application/javascript;charset=UTF-8,' + encodeURI(c); };\n    // If Deno, this is necessary; if not, this changes nothing\n    cwk = function (u) { return new Worker(u, { type: 'module' }); };\n}\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = cwk(ch2[id] || (ch2[id] = durl(c)));\n    w.onerror = function (e) { return cb(e.error, null); };\n    w.onmessage = function (e) { return cb(null, e.data); };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i)\n        ++l[cd[i] - 1];\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p / 8) | 0) + (p & 7 && 1); };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v instanceof u16 ? u16 : v instanceof u32 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && !st.l && sl < 5))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            st.f = final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                throw 'invalid block type';\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    throw 'unexpected EOF';\n                break;\n            }\n            if (!c)\n                throw 'invalid length/literal';\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    throw 'invalid distance';\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        throw 'unexpected EOF';\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e < s) {\n                // write full block\n                pos = wfblk(w, pos, dat.subarray(i, e));\n            }\n            else {\n                // write final block\n                w[i] = lst;\n                pos = wfblk(w, pos, dat.subarray(i, s));\n            }\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new u32(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && 0xEDB88320) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/ /g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k] instanceof u8 || v[k] instanceof u16 || v[k] instanceof u32)\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, hMap, max, bits, bits16, shft, slc, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (t)\n            throw 'stream finished';\n        if (!strm.ondata)\n            throw 'no stream handler';\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        throw 'invalid gzip data';\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        throw 'invalid zlib data';\n    if (d[1] & 32)\n        throw 'invalid zlib data: preset dictionaries not supported';\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (this.d)\n            throw 'stream finished';\n        if (!this.ondata)\n            throw 'no stream handler';\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                throw 'invalid gzip stream';\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                throw 'invalid zlib stream';\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no stream handler';\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k;\n        if (val instanceof u8)\n            t[n] = [val, o];\n        else if (Array.isArray(val))\n            t[n] = [val[0], mrg(o, val[1])];\n        else\n            fltn(val, n + '/', t, o);\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    throw 'invalid utf-8 data';\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            throw 'stream finished';\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                throw 'invalid utf-8 data';\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback';\n        if (this.d)\n            throw 'stream finished';\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            throw 'invalid utf-8 data';\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                throw 'extra field too long';\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c == null && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        throw 'date not in range 1980-2099';\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != null) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            throw 'no callback - add to ZIP archive before pushing';\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (this.d & 2)\n            throw 'stream finished';\n        var f = strToU8(file.filename), fl = f.length;\n        var com = file.comment, o = com && strToU8(com);\n        var u = fl != file.filename.length || (o && (com.length != o.length));\n        var hl = fl + exfl(file.extra) + 30;\n        if (fl > 65535)\n            throw 'filename too long';\n        var header = new u8(hl);\n        wzh(header, 0, file, f, u);\n        var chks = [header];\n        var pAll = function () {\n            for (var _i = 0, chks_1 = chks; _i < chks_1.length; _i++) {\n                var chk = chks_1[_i];\n                _this_1.ondata(null, chk, false);\n            }\n            chks = [];\n        };\n        var tr = this.d;\n        this.d = 0;\n        var ind = this.u.length;\n        var uf = mrg(file, {\n            f: f,\n            u: u,\n            o: o,\n            t: function () {\n                if (file.terminate)\n                    file.terminate();\n            },\n            r: function () {\n                pAll();\n                if (tr) {\n                    var nxt = _this_1.u[ind + 1];\n                    if (nxt)\n                        nxt.r();\n                    else\n                        _this_1.d = 1;\n                }\n                tr = 1;\n            }\n        });\n        var cl = 0;\n        file.ondata = function (err, dat, final) {\n            if (err) {\n                _this_1.ondata(err, dat, final);\n                _this_1.terminate();\n            }\n            else {\n                cl += dat.length;\n                chks.push(dat);\n                if (final) {\n                    var dd = new u8(16);\n                    wbytes(dd, 0, 0x8074B50);\n                    wbytes(dd, 4, file.crc);\n                    wbytes(dd, 8, cl);\n                    wbytes(dd, 12, file.size);\n                    chks.push(dd);\n                    uf.c = cl, uf.b = hl + cl + 16, uf.crc = file.crc, uf.size = file.size;\n                    if (tr)\n                        uf.r();\n                    tr = 1;\n                }\n                else if (tr)\n                    pAll();\n            }\n        };\n        this.u.push(uf);\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            if (this.d & 1)\n                throw 'stream finishing';\n            throw 'stream finished';\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, f.c, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cb(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cb(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl('filename too long', null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            throw 'filename too long';\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, data, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            throw 'no callback';\n        if (!this.p)\n            throw 'stream finished';\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_2 = [];\n                        this_1.k.unshift(chks_2);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    throw 'no callback';\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        throw 'unknown compression type ' + cmp_1;\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_3 = chks_2; _i < chks_3.length; _i++) {\n                                        var dat = chks_3[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_2 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                throw 'invalid zip file';\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\n/**\n * Asynchronously decompresses a ZIP archive\n * @param data The raw compressed ZIP file\n * @param cb The callback to call with the decompressed files\n * @returns A function that can be used to immediately terminate the unzipping\n */\nexport function unzip(data, cb) {\n    if (typeof cb != 'function')\n        throw 'no callback';\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cb('invalid zip file', null);\n            return;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (!lft)\n        cb(null, {});\n    var c = lft;\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50) {\n            cb('invalid zip file', null);\n            return;\n        }\n        c = lft = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    var _loop_3 = function (i) {\n        var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cb(e, null);\n            }\n            else {\n                files[fn] = d;\n                if (!--lft)\n                    cb(null, files);\n            }\n        };\n        if (!c_1)\n            cbl(null, slc(data, b, b + sc));\n        else if (c_1 == 8) {\n            var infl = data.subarray(b, b + sc);\n            if (sc < 320000) {\n                try {\n                    cbl(null, inflateSync(infl, new u8(su)));\n                }\n                catch (e) {\n                    cbl(e, null);\n                }\n            }\n            else\n                term.push(inflate(infl, { size: su }, cbl));\n        }\n        else\n            cbl('unknown compression type ' + c_1, null);\n    };\n    for (var i = 0; i < c; ++i) {\n        _loop_3(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @returns The decompressed files\n */\nexport function unzipSync(data) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            throw 'invalid zip file';\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295;\n    if (z) {\n        e = b4(data, e - 12);\n        if (b4(data, e) != 0x6064B50)\n            throw 'invalid zip file';\n        c = b4(data, e + 32);\n        o = b4(data, e + 48);\n    }\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!c_2)\n            files[fn] = slc(data, b, b + sc);\n        else if (c_2 == 8)\n            files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n        else\n            throw 'unknown compression type ' + c_2;\n    }\n    return files;\n}\n","import {\n\tVector3,\n\tVector4\n} from 'three';\n\n/**\n * NURBS utils\n *\n * See NURBSCurve and NURBSSurface.\n **/\n\n\n/**************************************************************\n *\tNURBS Utils\n **************************************************************/\n\n/*\nFinds knot vector span.\n\np : degree\nu : parametric value\nU : knot vector\n\nreturns the span\n*/\nfunction findSpan( p, u, U ) {\n\n\tconst n = U.length - p - 1;\n\n\tif ( u >= U[ n ] ) {\n\n\t\treturn n - 1;\n\n\t}\n\n\tif ( u <= U[ p ] ) {\n\n\t\treturn p;\n\n\t}\n\n\tlet low = p;\n\tlet high = n;\n\tlet mid = Math.floor( ( low + high ) / 2 );\n\n\twhile ( u < U[ mid ] || u >= U[ mid + 1 ] ) {\n\n\t\tif ( u < U[ mid ] ) {\n\n\t\t\thigh = mid;\n\n\t\t} else {\n\n\t\t\tlow = mid;\n\n\t\t}\n\n\t\tmid = Math.floor( ( low + high ) / 2 );\n\n\t}\n\n\treturn mid;\n\n}\n\n\n/*\nCalculate basis functions. See The NURBS Book, page 70, algorithm A2.2\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nU    : knot vector\n\nreturns array[p+1] with basis functions values.\n*/\nfunction calcBasisFunctions( span, u, p, U ) {\n\n\tconst N = [];\n\tconst left = [];\n\tconst right = [];\n\tN[ 0 ] = 1.0;\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tconst temp = N[ r ] / ( rv + lv );\n\t\t\tN[ r ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tN[ j ] = saved;\n\n\t}\n\n\treturn N;\n\n}\n\n\n/*\nCalculate B-Spline curve points. See The NURBS Book, page 82, algorithm A3.1.\n\np : degree of B-Spline\nU : knot vector\nP : control points (x, y, z, w)\nu : parametric point\n\nreturns point for given u\n*/\nfunction calcBSplinePoint( p, U, P, u ) {\n\n\tconst span = findSpan( p, u, U );\n\tconst N = calcBasisFunctions( span, u, p, U );\n\tconst C = new Vector4( 0, 0, 0, 0 );\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tconst point = P[ span - p + j ];\n\t\tconst Nj = N[ j ];\n\t\tconst wNj = point.w * Nj;\n\t\tC.x += point.x * wNj;\n\t\tC.y += point.y * wNj;\n\t\tC.z += point.z * wNj;\n\t\tC.w += point.w * Nj;\n\n\t}\n\n\treturn C;\n\n}\n\n\n/*\nCalculate basis functions derivatives. See The NURBS Book, page 72, algorithm A2.3.\n\nspan : span in which u lies\nu    : parametric point\np    : degree\nn    : number of derivatives to calculate\nU    : knot vector\n\nreturns array[n+1][p+1] with basis functions derivatives\n*/\nfunction calcBasisFunctionDerivatives( span, u, p, n, U ) {\n\n\tconst zeroArr = [];\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tzeroArr[ i ] = 0.0;\n\n\tconst ders = [];\n\n\tfor ( let i = 0; i <= n; ++ i )\n\t\tders[ i ] = zeroArr.slice( 0 );\n\n\tconst ndu = [];\n\n\tfor ( let i = 0; i <= p; ++ i )\n\t\tndu[ i ] = zeroArr.slice( 0 );\n\n\tndu[ 0 ][ 0 ] = 1.0;\n\n\tconst left = zeroArr.slice( 0 );\n\tconst right = zeroArr.slice( 0 );\n\n\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\tleft[ j ] = u - U[ span + 1 - j ];\n\t\tright[ j ] = U[ span + j ] - u;\n\n\t\tlet saved = 0.0;\n\n\t\tfor ( let r = 0; r < j; ++ r ) {\n\n\t\t\tconst rv = right[ r + 1 ];\n\t\t\tconst lv = left[ j - r ];\n\t\t\tndu[ j ][ r ] = rv + lv;\n\n\t\t\tconst temp = ndu[ r ][ j - 1 ] / ndu[ j ][ r ];\n\t\t\tndu[ r ][ j ] = saved + rv * temp;\n\t\t\tsaved = lv * temp;\n\n\t\t}\n\n\t\tndu[ j ][ j ] = saved;\n\n\t}\n\n\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\tders[ 0 ][ j ] = ndu[ j ][ p ];\n\n\t}\n\n\tfor ( let r = 0; r <= p; ++ r ) {\n\n\t\tlet s1 = 0;\n\t\tlet s2 = 1;\n\n\t\tconst a = [];\n\t\tfor ( let i = 0; i <= p; ++ i ) {\n\n\t\t\ta[ i ] = zeroArr.slice( 0 );\n\n\t\t}\n\n\t\ta[ 0 ][ 0 ] = 1.0;\n\n\t\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\t\tlet d = 0.0;\n\t\t\tconst rk = r - k;\n\t\t\tconst pk = p - k;\n\n\t\t\tif ( r >= k ) {\n\n\t\t\t\ta[ s2 ][ 0 ] = a[ s1 ][ 0 ] / ndu[ pk + 1 ][ rk ];\n\t\t\t\td = a[ s2 ][ 0 ] * ndu[ rk ][ pk ];\n\n\t\t\t}\n\n\t\t\tconst j1 = ( rk >= - 1 ) ? 1 : - rk;\n\t\t\tconst j2 = ( r - 1 <= pk ) ? k - 1 : p - r;\n\n\t\t\tfor ( let j = j1; j <= j2; ++ j ) {\n\n\t\t\t\ta[ s2 ][ j ] = ( a[ s1 ][ j ] - a[ s1 ][ j - 1 ] ) / ndu[ pk + 1 ][ rk + j ];\n\t\t\t\td += a[ s2 ][ j ] * ndu[ rk + j ][ pk ];\n\n\t\t\t}\n\n\t\t\tif ( r <= pk ) {\n\n\t\t\t\ta[ s2 ][ k ] = - a[ s1 ][ k - 1 ] / ndu[ pk + 1 ][ r ];\n\t\t\t\td += a[ s2 ][ k ] * ndu[ r ][ pk ];\n\n\t\t\t}\n\n\t\t\tders[ k ][ r ] = d;\n\n\t\t\tconst j = s1;\n\t\t\ts1 = s2;\n\t\t\ts2 = j;\n\n\t\t}\n\n\t}\n\n\tlet r = p;\n\n\tfor ( let k = 1; k <= n; ++ k ) {\n\n\t\tfor ( let j = 0; j <= p; ++ j ) {\n\n\t\t\tders[ k ][ j ] *= r;\n\n\t\t}\n\n\t\tr *= p - k;\n\n\t}\n\n\treturn ders;\n\n}\n\n\n/*\n\tCalculate derivatives of a B-Spline. See The NURBS Book, page 93, algorithm A3.2.\n\n\tp  : degree\n\tU  : knot vector\n\tP  : control points\n\tu  : Parametric points\n\tnd : number of derivatives\n\n\treturns array[d+1] with derivatives\n\t*/\nfunction calcBSplineDerivatives( p, U, P, u, nd ) {\n\n\tconst du = nd < p ? nd : p;\n\tconst CK = [];\n\tconst span = findSpan( p, u, U );\n\tconst nders = calcBasisFunctionDerivatives( span, u, p, du, U );\n\tconst Pw = [];\n\n\tfor ( let i = 0; i < P.length; ++ i ) {\n\n\t\tconst point = P[ i ].clone();\n\t\tconst w = point.w;\n\n\t\tpoint.x *= w;\n\t\tpoint.y *= w;\n\t\tpoint.z *= w;\n\n\t\tPw[ i ] = point;\n\n\t}\n\n\tfor ( let k = 0; k <= du; ++ k ) {\n\n\t\tconst point = Pw[ span - p ].clone().multiplyScalar( nders[ k ][ 0 ] );\n\n\t\tfor ( let j = 1; j <= p; ++ j ) {\n\n\t\t\tpoint.add( Pw[ span - p + j ].clone().multiplyScalar( nders[ k ][ j ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = point;\n\n\t}\n\n\tfor ( let k = du + 1; k <= nd + 1; ++ k ) {\n\n\t\tCK[ k ] = new Vector4( 0, 0, 0 );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate \"K over I\"\n\nreturns k!/(i!(k-i)!)\n*/\nfunction calcKoverI( k, i ) {\n\n\tlet nom = 1;\n\n\tfor ( let j = 2; j <= k; ++ j ) {\n\n\t\tnom *= j;\n\n\t}\n\n\tlet denom = 1;\n\n\tfor ( let j = 2; j <= i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\tfor ( let j = 2; j <= k - i; ++ j ) {\n\n\t\tdenom *= j;\n\n\t}\n\n\treturn nom / denom;\n\n}\n\n\n/*\nCalculate derivatives (0-nd) of rational curve. See The NURBS Book, page 127, algorithm A4.2.\n\nPders : result of function calcBSplineDerivatives\n\nreturns array with derivatives for rational curve.\n*/\nfunction calcRationalCurveDerivatives( Pders ) {\n\n\tconst nd = Pders.length;\n\tconst Aders = [];\n\tconst wders = [];\n\n\tfor ( let i = 0; i < nd; ++ i ) {\n\n\t\tconst point = Pders[ i ];\n\t\tAders[ i ] = new Vector3( point.x, point.y, point.z );\n\t\twders[ i ] = point.w;\n\n\t}\n\n\tconst CK = [];\n\n\tfor ( let k = 0; k < nd; ++ k ) {\n\n\t\tconst v = Aders[ k ].clone();\n\n\t\tfor ( let i = 1; i <= k; ++ i ) {\n\n\t\t\tv.sub( CK[ k - i ].clone().multiplyScalar( calcKoverI( k, i ) * wders[ i ] ) );\n\n\t\t}\n\n\t\tCK[ k ] = v.divideScalar( wders[ 0 ] );\n\n\t}\n\n\treturn CK;\n\n}\n\n\n/*\nCalculate NURBS curve derivatives. See The NURBS Book, page 127, algorithm A4.2.\n\np  : degree\nU  : knot vector\nP  : control points in homogeneous space\nu  : parametric points\nnd : number of derivatives\n\nreturns array with derivatives.\n*/\nfunction calcNURBSDerivatives( p, U, P, u, nd ) {\n\n\tconst Pders = calcBSplineDerivatives( p, U, P, u, nd );\n\treturn calcRationalCurveDerivatives( Pders );\n\n}\n\n\n/*\nCalculate rational B-Spline surface point. See The NURBS Book, page 134, algorithm A4.3.\n\np1, p2 : degrees of B-Spline surface\nU1, U2 : knot vectors\nP      : control points (x, y, z, w)\nu, v   : parametric values\n\nreturns point for given (u, v)\n*/\nfunction calcSurfacePoint( p, q, U, V, P, u, v, target ) {\n\n\tconst uspan = findSpan( p, u, U );\n\tconst vspan = findSpan( q, v, V );\n\tconst Nu = calcBasisFunctions( uspan, u, p, U );\n\tconst Nv = calcBasisFunctions( vspan, v, q, V );\n\tconst temp = [];\n\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\ttemp[ l ] = new Vector4( 0, 0, 0, 0 );\n\t\tfor ( let k = 0; k <= p; ++ k ) {\n\n\t\t\tconst point = P[ uspan - p + k ][ vspan - q + l ].clone();\n\t\t\tconst w = point.w;\n\t\t\tpoint.x *= w;\n\t\t\tpoint.y *= w;\n\t\t\tpoint.z *= w;\n\t\t\ttemp[ l ].add( point.multiplyScalar( Nu[ k ] ) );\n\n\t\t}\n\n\t}\n\n\tconst Sw = new Vector4( 0, 0, 0, 0 );\n\tfor ( let l = 0; l <= q; ++ l ) {\n\n\t\tSw.add( temp[ l ].multiplyScalar( Nv[ l ] ) );\n\n\t}\n\n\tSw.divideScalar( Sw.w );\n\ttarget.set( Sw.x, Sw.y, Sw.z );\n\n}\n\n\n\nexport {\n\tfindSpan,\n\tcalcBasisFunctions,\n\tcalcBSplinePoint,\n\tcalcBasisFunctionDerivatives,\n\tcalcBSplineDerivatives,\n\tcalcKoverI,\n\tcalcRationalCurveDerivatives,\n\tcalcNURBSDerivatives,\n\tcalcSurfacePoint,\n};\n","import {\n\tCurve,\n\tVector3,\n\tVector4\n} from 'three';\nimport * as NURBSUtils from '../curves/NURBSUtils.js';\n\n/**\n * NURBS curve object\n *\n * Derives from Curve, overriding getPoint and getTangent.\n *\n * Implementation is based on (x, y [, z=0 [, w=1]]) control points with w=weight.\n *\n **/\n\nclass NURBSCurve extends Curve {\n\n\tconstructor(\n\t\tdegree,\n\t\tknots /* array of reals */,\n\t\tcontrolPoints /* array of Vector(2|3|4) */,\n\t\tstartKnot /* index in knots */,\n\t\tendKnot /* index in knots */\n\t) {\n\n\t\tsuper();\n\n\t\tthis.degree = degree;\n\t\tthis.knots = knots;\n\t\tthis.controlPoints = [];\n\t\t// Used by periodic NURBS to remove hidden spans\n\t\tthis.startKnot = startKnot || 0;\n\t\tthis.endKnot = endKnot || ( this.knots.length - 1 );\n\n\t\tfor ( let i = 0; i < controlPoints.length; ++ i ) {\n\n\t\t\t// ensure Vector4 for control points\n\t\t\tconst point = controlPoints[ i ];\n\t\t\tthis.controlPoints[ i ] = new Vector4( point.x, point.y, point.z, point.w );\n\n\t\t}\n\n\t}\n\n\tgetPoint( t, optionalTarget = new Vector3() ) {\n\n\t\tconst point = optionalTarget;\n\n\t\tconst u = this.knots[ this.startKnot ] + t * ( this.knots[ this.endKnot ] - this.knots[ this.startKnot ] ); // linear mapping t->u\n\n\t\t// following results in (wx, wy, wz, w) homogeneous point\n\t\tconst hpoint = NURBSUtils.calcBSplinePoint( this.degree, this.knots, this.controlPoints, u );\n\n\t\tif ( hpoint.w !== 1.0 ) {\n\n\t\t\t// project to 3D space: (wx, wy, wz, w) -> (x, y, z, 1)\n\t\t\thpoint.divideScalar( hpoint.w );\n\n\t\t}\n\n\t\treturn point.set( hpoint.x, hpoint.y, hpoint.z );\n\n\t}\n\n\tgetTangent( t, optionalTarget = new Vector3() ) {\n\n\t\tconst tangent = optionalTarget;\n\n\t\tconst u = this.knots[ 0 ] + t * ( this.knots[ this.knots.length - 1 ] - this.knots[ 0 ] );\n\t\tconst ders = NURBSUtils.calcNURBSDerivatives( this.degree, this.knots, this.controlPoints, u, 1 );\n\t\ttangent.copy( ders[ 1 ] ).normalize();\n\n\t\treturn tangent;\n\n\t}\n\n}\n\nexport { NURBSCurve };\n","import {\n\tAmbientLight,\n\tAnimationClip,\n\tBone,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tEquirectangularReflectionMapping,\n\tEuler,\n\tFileLoader,\n\tFloat32BufferAttribute,\n\tGroup,\n\tLine,\n\tLineBasicMaterial,\n\tLoader,\n\tLoaderUtils,\n\tMathUtils,\n\tMatrix3,\n\tMatrix4,\n\tMesh,\n\tMeshLambertMaterial,\n\tMeshPhongMaterial,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tUint16BufferAttribute,\n\tVector2,\n\tVector3,\n\tVector4,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tShapeUtils\n} from 'three';\nimport * as fflate from '../libs/fflate.module.js';\nimport { NURBSCurve } from '../curves/NURBSCurve.js';\n\n/**\n * Loader loads FBX file and generates Group representing FBX scene.\n * Requires FBX file to be >= 7.0 and in ASCII or >= 6400 in Binary format\n * Versions lower than this may load but will probably have errors\n *\n * Needs Support:\n *  Morph normals / blend shape normals\n *\n * FBX format references:\n * \thttps://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_index_html (C++ SDK reference)\n *\n * Binary format specification:\n *\thttps://code.blender.org/2013/08/fbx-binary-file-format-specification/\n */\n\n\nlet fbxTree;\nlet connections;\nlet sceneGraph;\n\nclass FBXLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tconst path = ( scope.path === '' ) ? LoaderUtils.extractUrlBase( url ) : scope.path;\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( scope.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( scope.requestHeader );\n\t\tloader.setWithCredentials( scope.withCredentials );\n\n\t\tloader.load( url, function ( buffer ) {\n\n\t\t\ttry {\n\n\t\t\t\tonLoad( scope.parse( buffer, path ) );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\tif ( onError ) {\n\n\t\t\t\t\tonError( e );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.error( e );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\n\t\t\t}\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( FBXBuffer, path ) {\n\n\t\tif ( isFbxFormatBinary( FBXBuffer ) ) {\n\n\t\t\tfbxTree = new BinaryParser().parse( FBXBuffer );\n\n\t\t} else {\n\n\t\t\tconst FBXText = convertArrayBufferToString( FBXBuffer );\n\n\t\t\tif ( ! isFbxFormatASCII( FBXText ) ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown format.' );\n\n\t\t\t}\n\n\t\t\tif ( getFbxVersion( FBXText ) < 7000 ) {\n\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + getFbxVersion( FBXText ) );\n\n\t\t\t}\n\n\t\t\tfbxTree = new TextParser().parse( FBXText );\n\n\t\t}\n\n\t\t// console.log( fbxTree );\n\n\t\tconst textureLoader = new TextureLoader( this.manager ).setPath( this.resourcePath || path ).setCrossOrigin( this.crossOrigin );\n\n\t\treturn new FBXTreeParser( textureLoader, this.manager ).parse( fbxTree );\n\n\t}\n\n}\n\n// Parse the FBXTree object returned by the BinaryParser or TextParser and return a Group\nclass FBXTreeParser {\n\n\tconstructor( textureLoader, manager ) {\n\n\t\tthis.textureLoader = textureLoader;\n\t\tthis.manager = manager;\n\n\t}\n\n\tparse() {\n\n\t\tconnections = this.parseConnections();\n\n\t\tconst images = this.parseImages();\n\t\tconst textures = this.parseTextures( images );\n\t\tconst materials = this.parseMaterials( textures );\n\t\tconst deformers = this.parseDeformers();\n\t\tconst geometryMap = new GeometryParser().parse( deformers );\n\n\t\tthis.parseScene( deformers, geometryMap, materials );\n\n\t\treturn sceneGraph;\n\n\t}\n\n\t// Parses FBXTree.Connections which holds parent-child connections between objects (e.g. material -> texture, model->geometry )\n\t// and details the connection type\n\tparseConnections() {\n\n\t\tconst connectionMap = new Map();\n\n\t\tif ( 'Connections' in fbxTree ) {\n\n\t\t\tconst rawConnections = fbxTree.Connections.connections;\n\n\t\t\trawConnections.forEach( function ( rawConnection ) {\n\n\t\t\t\tconst fromID = rawConnection[ 0 ];\n\t\t\t\tconst toID = rawConnection[ 1 ];\n\t\t\t\tconst relationship = rawConnection[ 2 ];\n\n\t\t\t\tif ( ! connectionMap.has( fromID ) ) {\n\n\t\t\t\t\tconnectionMap.set( fromID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst parentRelationship = { ID: toID, relationship: relationship };\n\t\t\t\tconnectionMap.get( fromID ).parents.push( parentRelationship );\n\n\t\t\t\tif ( ! connectionMap.has( toID ) ) {\n\n\t\t\t\t\tconnectionMap.set( toID, {\n\t\t\t\t\t\tparents: [],\n\t\t\t\t\t\tchildren: []\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t\tconst childRelationship = { ID: fromID, relationship: relationship };\n\t\t\t\tconnectionMap.get( toID ).children.push( childRelationship );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn connectionMap;\n\n\t}\n\n\t// Parse FBXTree.Objects.Video for embedded image data\n\t// These images are connected to textures in FBXTree.Objects.Textures\n\t// via FBXTree.Connections.\n\tparseImages() {\n\n\t\tconst images = {};\n\t\tconst blobs = {};\n\n\t\tif ( 'Video' in fbxTree.Objects ) {\n\n\t\t\tconst videoNodes = fbxTree.Objects.Video;\n\n\t\t\tfor ( const nodeID in videoNodes ) {\n\n\t\t\t\tconst videoNode = videoNodes[ nodeID ];\n\n\t\t\t\tconst id = parseInt( nodeID );\n\n\t\t\t\timages[ id ] = videoNode.RelativeFilename || videoNode.Filename;\n\n\t\t\t\t// raw image data is in videoNode.Content\n\t\t\t\tif ( 'Content' in videoNode ) {\n\n\t\t\t\t\tconst arrayBufferContent = ( videoNode.Content instanceof ArrayBuffer ) && ( videoNode.Content.byteLength > 0 );\n\t\t\t\t\tconst base64Content = ( typeof videoNode.Content === 'string' ) && ( videoNode.Content !== '' );\n\n\t\t\t\t\tif ( arrayBufferContent || base64Content ) {\n\n\t\t\t\t\t\tconst image = this.parseImage( videoNodes[ nodeID ] );\n\n\t\t\t\t\t\tblobs[ videoNode.RelativeFilename || videoNode.Filename ] = image;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( const id in images ) {\n\n\t\t\tconst filename = images[ id ];\n\n\t\t\tif ( blobs[ filename ] !== undefined ) images[ id ] = blobs[ filename ];\n\t\t\telse images[ id ] = images[ id ].split( '\\\\' ).pop();\n\n\t\t}\n\n\t\treturn images;\n\n\t}\n\n\t// Parse embedded image data in FBXTree.Video.Content\n\tparseImage( videoNode ) {\n\n\t\tconst content = videoNode.Content;\n\t\tconst fileName = videoNode.RelativeFilename || videoNode.Filename;\n\t\tconst extension = fileName.slice( fileName.lastIndexOf( '.' ) + 1 ).toLowerCase();\n\n\t\tlet type;\n\n\t\tswitch ( extension ) {\n\n\t\t\tcase 'bmp':\n\n\t\t\t\ttype = 'image/bmp';\n\t\t\t\tbreak;\n\n\t\t\tcase 'jpg':\n\t\t\tcase 'jpeg':\n\n\t\t\t\ttype = 'image/jpeg';\n\t\t\t\tbreak;\n\n\t\t\tcase 'png':\n\n\t\t\t\ttype = 'image/png';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tif':\n\n\t\t\t\ttype = 'image/tiff';\n\t\t\t\tbreak;\n\n\t\t\tcase 'tga':\n\n\t\t\t\tif ( this.manager.getHandler( '.tga' ) === null ) {\n\n\t\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, skipping ', fileName );\n\n\t\t\t\t}\n\n\t\t\t\ttype = 'image/tga';\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tconsole.warn( 'FBXLoader: Image type \"' + extension + '\" is not supported.' );\n\t\t\t\treturn;\n\n\t\t}\n\n\t\tif ( typeof content === 'string' ) { // ASCII format\n\n\t\t\treturn 'data:' + type + ';base64,' + content;\n\n\t\t} else { // Binary Format\n\n\t\t\tconst array = new Uint8Array( content );\n\t\t\treturn window.URL.createObjectURL( new Blob( [ array ], { type: type } ) );\n\n\t\t}\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Texture\n\t// These contain details such as UV scaling, cropping, rotation etc and are connected\n\t// to images in FBXTree.Objects.Video\n\tparseTextures( images ) {\n\n\t\tconst textureMap = new Map();\n\n\t\tif ( 'Texture' in fbxTree.Objects ) {\n\n\t\t\tconst textureNodes = fbxTree.Objects.Texture;\n\t\t\tfor ( const nodeID in textureNodes ) {\n\n\t\t\t\tconst texture = this.parseTexture( textureNodes[ nodeID ], images );\n\t\t\t\ttextureMap.set( parseInt( nodeID ), texture );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn textureMap;\n\n\t}\n\n\t// Parse individual node in FBXTree.Objects.Texture\n\tparseTexture( textureNode, images ) {\n\n\t\tconst texture = this.loadTexture( textureNode, images );\n\n\t\ttexture.ID = textureNode.id;\n\n\t\ttexture.name = textureNode.attrName;\n\n\t\tconst wrapModeU = textureNode.WrapModeU;\n\t\tconst wrapModeV = textureNode.WrapModeV;\n\n\t\tconst valueU = wrapModeU !== undefined ? wrapModeU.value : 0;\n\t\tconst valueV = wrapModeV !== undefined ? wrapModeV.value : 0;\n\n\t\t// http://download.autodesk.com/us/fbx/SDKdocs/FBX_SDK_Help/files/fbxsdkref/class_k_fbx_texture.html#889640e63e2e681259ea81061b85143a\n\t\t// 0: repeat(default), 1: clamp\n\n\t\ttexture.wrapS = valueU === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\t\ttexture.wrapT = valueV === 0 ? RepeatWrapping : ClampToEdgeWrapping;\n\n\t\tif ( 'Scaling' in textureNode ) {\n\n\t\t\tconst values = textureNode.Scaling.value;\n\n\t\t\ttexture.repeat.x = values[ 0 ];\n\t\t\ttexture.repeat.y = values[ 1 ];\n\n\t\t}\n\n\t\tif ( 'Translation' in textureNode ) {\n\n\t\t\tconst values = textureNode.Translation.value;\n\n\t\t\ttexture.offset.x = values[ 0 ];\n\t\t\ttexture.offset.y = values[ 1 ];\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\t// load a texture specified as a blob or data URI, or via an external URL using TextureLoader\n\tloadTexture( textureNode, images ) {\n\n\t\tlet fileName;\n\n\t\tconst currentPath = this.textureLoader.path;\n\n\t\tconst children = connections.get( textureNode.id ).children;\n\n\t\tif ( children !== undefined && children.length > 0 && images[ children[ 0 ].ID ] !== undefined ) {\n\n\t\t\tfileName = images[ children[ 0 ].ID ];\n\n\t\t\tif ( fileName.indexOf( 'blob:' ) === 0 || fileName.indexOf( 'data:' ) === 0 ) {\n\n\t\t\t\tthis.textureLoader.setPath( undefined );\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet texture;\n\n\t\tconst extension = textureNode.FileName.slice( - 3 ).toLowerCase();\n\n\t\tif ( extension === 'tga' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.tga' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: TGA loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'dds' ) {\n\n\t\t\tconst loader = this.manager.getHandler( '.dds' );\n\n\t\t\tif ( loader === null ) {\n\n\t\t\t\tconsole.warn( 'FBXLoader: DDS loader not found, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\t\ttexture = new Texture();\n\n\t\t\t} else {\n\n\t\t\t\tloader.setPath( this.textureLoader.path );\n\t\t\t\ttexture = loader.load( fileName );\n\n\t\t\t}\n\n\t\t} else if ( extension === 'psd' ) {\n\n\t\t\tconsole.warn( 'FBXLoader: PSD textures are not supported, creating placeholder texture for', textureNode.RelativeFilename );\n\t\t\ttexture = new Texture();\n\n\t\t} else {\n\n\t\t\ttexture = this.textureLoader.load( fileName );\n\n\t\t}\n\n\t\tthis.textureLoader.setPath( currentPath );\n\n\t\treturn texture;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Material\n\tparseMaterials( textureMap ) {\n\n\t\tconst materialMap = new Map();\n\n\t\tif ( 'Material' in fbxTree.Objects ) {\n\n\t\t\tconst materialNodes = fbxTree.Objects.Material;\n\n\t\t\tfor ( const nodeID in materialNodes ) {\n\n\t\t\t\tconst material = this.parseMaterial( materialNodes[ nodeID ], textureMap );\n\n\t\t\t\tif ( material !== null ) materialMap.set( parseInt( nodeID ), material );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn materialMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Material\n\t// Materials are connected to texture maps in FBXTree.Objects.Textures\n\t// FBX format currently only supports Lambert and Phong shading models\n\tparseMaterial( materialNode, textureMap ) {\n\n\t\tconst ID = materialNode.id;\n\t\tconst name = materialNode.attrName;\n\t\tlet type = materialNode.ShadingModel;\n\n\t\t// Case where FBX wraps shading model in property object.\n\t\tif ( typeof type === 'object' ) {\n\n\t\t\ttype = type.value;\n\n\t\t}\n\n\t\t// Ignore unused materials which don't have any connections.\n\t\tif ( ! connections.has( ID ) ) return null;\n\n\t\tconst parameters = this.parseParameters( materialNode, textureMap, ID );\n\n\t\tlet material;\n\n\t\tswitch ( type.toLowerCase() ) {\n\n\t\t\tcase 'phong':\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\t\t\tcase 'lambert':\n\t\t\t\tmaterial = new MeshLambertMaterial();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.', type );\n\t\t\t\tmaterial = new MeshPhongMaterial();\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tmaterial.setValues( parameters );\n\t\tmaterial.name = name;\n\n\t\treturn material;\n\n\t}\n\n\t// Parse FBX material and return parameters suitable for a three.js material\n\t// Also parse the texture map and return any textures associated with the material\n\tparseParameters( materialNode, textureMap, ID ) {\n\n\t\tconst parameters = {};\n\n\t\tif ( materialNode.BumpFactor ) {\n\n\t\t\tparameters.bumpScale = materialNode.BumpFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Diffuse ) {\n\n\t\t\tparameters.color = new Color().fromArray( materialNode.Diffuse.value ).convertSRGBToLinear();\n\n\t\t} else if ( materialNode.DiffuseColor && ( materialNode.DiffuseColor.type === 'Color' || materialNode.DiffuseColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports diffuse here instead of in materialNode.Diffuse\n\t\t\tparameters.color = new Color().fromArray( materialNode.DiffuseColor.value ).convertSRGBToLinear();\n\n\t\t}\n\n\t\tif ( materialNode.DisplacementFactor ) {\n\n\t\t\tparameters.displacementScale = materialNode.DisplacementFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Emissive ) {\n\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.Emissive.value ).convertSRGBToLinear();\n\n\t\t} else if ( materialNode.EmissiveColor && ( materialNode.EmissiveColor.type === 'Color' || materialNode.EmissiveColor.type === 'ColorRGB' ) ) {\n\n\t\t\t// The blender exporter exports emissive color here instead of in materialNode.Emissive\n\t\t\tparameters.emissive = new Color().fromArray( materialNode.EmissiveColor.value ).convertSRGBToLinear();\n\n\t\t}\n\n\t\tif ( materialNode.EmissiveFactor ) {\n\n\t\t\tparameters.emissiveIntensity = parseFloat( materialNode.EmissiveFactor.value );\n\n\t\t}\n\n\t\tif ( materialNode.Opacity ) {\n\n\t\t\tparameters.opacity = parseFloat( materialNode.Opacity.value );\n\n\t\t}\n\n\t\tif ( parameters.opacity < 1.0 ) {\n\n\t\t\tparameters.transparent = true;\n\n\t\t}\n\n\t\tif ( materialNode.ReflectionFactor ) {\n\n\t\t\tparameters.reflectivity = materialNode.ReflectionFactor.value;\n\n\t\t}\n\n\t\tif ( materialNode.Shininess ) {\n\n\t\t\tparameters.shininess = materialNode.Shininess.value;\n\n\t\t}\n\n\t\tif ( materialNode.Specular ) {\n\n\t\t\tparameters.specular = new Color().fromArray( materialNode.Specular.value ).convertSRGBToLinear();\n\n\t\t} else if ( materialNode.SpecularColor && materialNode.SpecularColor.type === 'Color' ) {\n\n\t\t\t// The blender exporter exports specular color here instead of in materialNode.Specular\n\t\t\tparameters.specular = new Color().fromArray( materialNode.SpecularColor.value ).convertSRGBToLinear();\n\n\t\t}\n\n\t\tconst scope = this;\n\t\tconnections.get( ID ).children.forEach( function ( child ) {\n\n\t\t\tconst type = child.relationship;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'Bump':\n\t\t\t\t\tparameters.bumpMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'Maya|TEX_ao_map':\n\t\t\t\t\tparameters.aoMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DiffuseColor':\n\t\t\t\tcase 'Maya|TEX_color_map':\n\t\t\t\t\tparameters.map = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.map !== undefined ) {\n\n\t\t\t\t\t\tparameters.map.colorSpace = SRGBColorSpace;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'DisplacementColor':\n\t\t\t\t\tparameters.displacementMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'EmissiveColor':\n\t\t\t\t\tparameters.emissiveMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.emissiveMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.emissiveMap.colorSpace = SRGBColorSpace;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'NormalMap':\n\t\t\t\tcase 'Maya|TEX_normal_map':\n\t\t\t\t\tparameters.normalMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'ReflectionColor':\n\t\t\t\t\tparameters.envMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.envMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.envMap.mapping = EquirectangularReflectionMapping;\n\t\t\t\t\t\tparameters.envMap.colorSpace = SRGBColorSpace;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'SpecularColor':\n\t\t\t\t\tparameters.specularMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tif ( parameters.specularMap !== undefined ) {\n\n\t\t\t\t\t\tparameters.specularMap.colorSpace = SRGBColorSpace;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'TransparentColor':\n\t\t\t\tcase 'TransparencyFactor':\n\t\t\t\t\tparameters.alphaMap = scope.getTexture( textureMap, child.ID );\n\t\t\t\t\tparameters.transparent = true;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'AmbientColor':\n\t\t\t\tcase 'ShininessExponent': // AKA glossiness map\n\t\t\t\tcase 'SpecularFactor': // AKA specularLevel\n\t\t\t\tcase 'VectorDisplacementColor': // NOTE: Seems to be a copy of DisplacementColor\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: %s map is not supported in three.js, skipping texture.', type );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn parameters;\n\n\t}\n\n\t// get a texture from the textureMap for use by a material.\n\tgetTexture( textureMap, id ) {\n\n\t\t// if the texture is a layered texture, just use the first layer and issue a warning\n\t\tif ( 'LayeredTexture' in fbxTree.Objects && id in fbxTree.Objects.LayeredTexture ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer.' );\n\t\t\tid = connections.get( id ).children[ 0 ].ID;\n\n\t\t}\n\n\t\treturn textureMap.get( id );\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Deformer\n\t// Deformer node can contain skinning or Vertex Cache animation data, however only skinning is supported here\n\t// Generates map of Skeleton-like objects for use later when generating and binding skeletons.\n\tparseDeformers() {\n\n\t\tconst skeletons = {};\n\t\tconst morphTargets = {};\n\n\t\tif ( 'Deformer' in fbxTree.Objects ) {\n\n\t\t\tconst DeformerNodes = fbxTree.Objects.Deformer;\n\n\t\t\tfor ( const nodeID in DeformerNodes ) {\n\n\t\t\t\tconst deformerNode = DeformerNodes[ nodeID ];\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\n\t\t\t\tif ( deformerNode.attrType === 'Skin' ) {\n\n\t\t\t\t\tconst skeleton = this.parseSkeleton( relationships, DeformerNodes );\n\t\t\t\t\tskeleton.ID = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: skeleton attached to more than one geometry is not supported.' );\n\t\t\t\t\tskeleton.geometryID = relationships.parents[ 0 ].ID;\n\n\t\t\t\t\tskeletons[ nodeID ] = skeleton;\n\n\t\t\t\t} else if ( deformerNode.attrType === 'BlendShape' ) {\n\n\t\t\t\t\tconst morphTarget = {\n\t\t\t\t\t\tid: nodeID,\n\t\t\t\t\t};\n\n\t\t\t\t\tmorphTarget.rawTargets = this.parseMorphTargets( relationships, DeformerNodes );\n\t\t\t\t\tmorphTarget.id = nodeID;\n\n\t\t\t\t\tif ( relationships.parents.length > 1 ) console.warn( 'THREE.FBXLoader: morph target attached to more than one geometry is not supported.' );\n\n\t\t\t\t\tmorphTargets[ nodeID ] = morphTarget;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\n\t\t\tskeletons: skeletons,\n\t\t\tmorphTargets: morphTargets,\n\n\t\t};\n\n\t}\n\n\t// Parse single nodes in FBXTree.Objects.Deformer\n\t// The top level skeleton node has type 'Skin' and sub nodes have type 'Cluster'\n\t// Each skin node represents a skeleton and each cluster node represents a bone\n\tparseSkeleton( relationships, deformerNodes ) {\n\n\t\tconst rawBones = [];\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst boneNode = deformerNodes[ child.ID ];\n\n\t\t\tif ( boneNode.attrType !== 'Cluster' ) return;\n\n\t\t\tconst rawBone = {\n\n\t\t\t\tID: child.ID,\n\t\t\t\tindices: [],\n\t\t\t\tweights: [],\n\t\t\t\ttransformLink: new Matrix4().fromArray( boneNode.TransformLink.a ),\n\t\t\t\t// transform: new Matrix4().fromArray( boneNode.Transform.a ),\n\t\t\t\t// linkMode: boneNode.Mode,\n\n\t\t\t};\n\n\t\t\tif ( 'Indexes' in boneNode ) {\n\n\t\t\t\trawBone.indices = boneNode.Indexes.a;\n\t\t\t\trawBone.weights = boneNode.Weights.a;\n\n\t\t\t}\n\n\t\t\trawBones.push( rawBone );\n\n\t\t} );\n\n\t\treturn {\n\n\t\t\trawBones: rawBones,\n\t\t\tbones: []\n\n\t\t};\n\n\t}\n\n\t// The top level morph deformer node has type \"BlendShape\" and sub nodes have type \"BlendShapeChannel\"\n\tparseMorphTargets( relationships, deformerNodes ) {\n\n\t\tconst rawMorphTargets = [];\n\n\t\tfor ( let i = 0; i < relationships.children.length; i ++ ) {\n\n\t\t\tconst child = relationships.children[ i ];\n\n\t\t\tconst morphTargetNode = deformerNodes[ child.ID ];\n\n\t\t\tconst rawMorphTarget = {\n\n\t\t\t\tname: morphTargetNode.attrName,\n\t\t\t\tinitialWeight: morphTargetNode.DeformPercent,\n\t\t\t\tid: morphTargetNode.id,\n\t\t\t\tfullWeights: morphTargetNode.FullWeights.a\n\n\t\t\t};\n\n\t\t\tif ( morphTargetNode.attrType !== 'BlendShapeChannel' ) return;\n\n\t\t\trawMorphTarget.geoID = connections.get( parseInt( child.ID ) ).children.filter( function ( child ) {\n\n\t\t\t\treturn child.relationship === undefined;\n\n\t\t\t} )[ 0 ].ID;\n\n\t\t\trawMorphTargets.push( rawMorphTarget );\n\n\t\t}\n\n\t\treturn rawMorphTargets;\n\n\t}\n\n\t// create the main Group() to be returned by the loader\n\tparseScene( deformers, geometryMap, materialMap ) {\n\n\t\tsceneGraph = new Group();\n\n\t\tconst modelMap = this.parseModels( deformers.skeletons, geometryMap, materialMap );\n\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tconst scope = this;\n\t\tmodelMap.forEach( function ( model ) {\n\n\t\t\tconst modelNode = modelNodes[ model.ID ];\n\t\t\tscope.setLookAtProperties( model, modelNode );\n\n\t\t\tconst parentConnections = connections.get( model.ID ).parents;\n\n\t\t\tparentConnections.forEach( function ( connection ) {\n\n\t\t\t\tconst parent = modelMap.get( connection.ID );\n\t\t\t\tif ( parent !== undefined ) parent.add( model );\n\n\t\t\t} );\n\n\t\t\tif ( model.parent === null ) {\n\n\t\t\t\tsceneGraph.add( model );\n\n\t\t\t}\n\n\n\t\t} );\n\n\t\tthis.bindSkeleton( deformers.skeletons, geometryMap, modelMap );\n\n\t\tthis.addGlobalSceneSettings();\n\n\t\tsceneGraph.traverse( function ( node ) {\n\n\t\t\tif ( node.userData.transformData ) {\n\n\t\t\t\tif ( node.parent ) {\n\n\t\t\t\t\tnode.userData.transformData.parentMatrix = node.parent.matrix;\n\t\t\t\t\tnode.userData.transformData.parentMatrixWorld = node.parent.matrixWorld;\n\n\t\t\t\t}\n\n\t\t\t\tconst transform = generateTransform( node.userData.transformData );\n\n\t\t\t\tnode.applyMatrix4( transform );\n\t\t\t\tnode.updateWorldMatrix();\n\n\t\t\t}\n\n\t\t} );\n\n\t\tconst animations = new AnimationParser().parse();\n\n\t\t// if all the models where already combined in a single group, just return that\n\t\tif ( sceneGraph.children.length === 1 && sceneGraph.children[ 0 ].isGroup ) {\n\n\t\t\tsceneGraph.children[ 0 ].animations = animations;\n\t\t\tsceneGraph = sceneGraph.children[ 0 ];\n\n\t\t}\n\n\t\tsceneGraph.animations = animations;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.Model\n\tparseModels( skeletons, geometryMap, materialMap ) {\n\n\t\tconst modelMap = new Map();\n\t\tconst modelNodes = fbxTree.Objects.Model;\n\n\t\tfor ( const nodeID in modelNodes ) {\n\n\t\t\tconst id = parseInt( nodeID );\n\t\t\tconst node = modelNodes[ nodeID ];\n\t\t\tconst relationships = connections.get( id );\n\n\t\t\tlet model = this.buildSkeleton( relationships, skeletons, id, node.attrName );\n\n\t\t\tif ( ! model ) {\n\n\t\t\t\tswitch ( node.attrType ) {\n\n\t\t\t\t\tcase 'Camera':\n\t\t\t\t\t\tmodel = this.createCamera( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Light':\n\t\t\t\t\t\tmodel = this.createLight( relationships );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Mesh':\n\t\t\t\t\t\tmodel = this.createMesh( relationships, geometryMap, materialMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'NurbsCurve':\n\t\t\t\t\t\tmodel = this.createCurve( relationships, geometryMap );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'LimbNode':\n\t\t\t\t\tcase 'Root':\n\t\t\t\t\t\tmodel = new Bone();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'Null':\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tmodel = new Group();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tmodel.name = node.attrName ? PropertyBinding.sanitizeNodeName( node.attrName ) : '';\n\t\t\t\tmodel.userData.originalName = node.attrName;\n\n\t\t\t\tmodel.ID = id;\n\n\t\t\t}\n\n\t\t\tthis.getTransformData( model, node );\n\t\t\tmodelMap.set( id, model );\n\n\t\t}\n\n\t\treturn modelMap;\n\n\t}\n\n\tbuildSkeleton( relationships, skeletons, id, name ) {\n\n\t\tlet bone = null;\n\n\t\trelationships.parents.forEach( function ( parent ) {\n\n\t\t\tfor ( const ID in skeletons ) {\n\n\t\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t\tif ( rawBone.ID === parent.ID ) {\n\n\t\t\t\t\t\tconst subBone = bone;\n\t\t\t\t\t\tbone = new Bone();\n\n\t\t\t\t\t\tbone.matrixWorld.copy( rawBone.transformLink );\n\n\t\t\t\t\t\t// set name and id here - otherwise in cases where \"subBone\" is created it will not have a name / id\n\n\t\t\t\t\t\tbone.name = name ? PropertyBinding.sanitizeNodeName( name ) : '';\n\t\t\t\t\t\tbone.userData.originalName = name;\n\t\t\t\t\t\tbone.ID = id;\n\n\t\t\t\t\t\tskeleton.bones[ i ] = bone;\n\n\t\t\t\t\t\t// In cases where a bone is shared between multiple meshes\n\t\t\t\t\t\t// duplicate the bone here and and it as a child of the first bone\n\t\t\t\t\t\tif ( subBone !== null ) {\n\n\t\t\t\t\t\t\tbone.add( subBone );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn bone;\n\n\t}\n\n\t// create a PerspectiveCamera or OrthographicCamera\n\tcreateCamera( relationships ) {\n\n\t\tlet model;\n\t\tlet cameraAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tcameraAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( cameraAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type = 0;\n\t\t\tif ( cameraAttribute.CameraProjectionType !== undefined && cameraAttribute.CameraProjectionType.value === 1 ) {\n\n\t\t\t\ttype = 1;\n\n\t\t\t}\n\n\t\t\tlet nearClippingPlane = 1;\n\t\t\tif ( cameraAttribute.NearPlane !== undefined ) {\n\n\t\t\t\tnearClippingPlane = cameraAttribute.NearPlane.value / 1000;\n\n\t\t\t}\n\n\t\t\tlet farClippingPlane = 1000;\n\t\t\tif ( cameraAttribute.FarPlane !== undefined ) {\n\n\t\t\t\tfarClippingPlane = cameraAttribute.FarPlane.value / 1000;\n\n\t\t\t}\n\n\n\t\t\tlet width = window.innerWidth;\n\t\t\tlet height = window.innerHeight;\n\n\t\t\tif ( cameraAttribute.AspectWidth !== undefined && cameraAttribute.AspectHeight !== undefined ) {\n\n\t\t\t\twidth = cameraAttribute.AspectWidth.value;\n\t\t\t\theight = cameraAttribute.AspectHeight.value;\n\n\t\t\t}\n\n\t\t\tconst aspect = width / height;\n\n\t\t\tlet fov = 45;\n\t\t\tif ( cameraAttribute.FieldOfView !== undefined ) {\n\n\t\t\t\tfov = cameraAttribute.FieldOfView.value;\n\n\t\t\t}\n\n\t\t\tconst focalLength = cameraAttribute.FocalLength ? cameraAttribute.FocalLength.value : null;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Perspective\n\t\t\t\t\tmodel = new PerspectiveCamera( fov, aspect, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tif ( focalLength !== null ) model.setFocalLength( focalLength );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Orthographic\n\t\t\t\t\tmodel = new OrthographicCamera( - width / 2, width / 2, height / 2, - height / 2, nearClippingPlane, farClippingPlane );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown camera type ' + type + '.' );\n\t\t\t\t\tmodel = new Object3D();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\t// Create a DirectionalLight, PointLight or SpotLight\n\tcreateLight( relationships ) {\n\n\t\tlet model;\n\t\tlet lightAttribute;\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tconst attr = fbxTree.Objects.NodeAttribute[ child.ID ];\n\n\t\t\tif ( attr !== undefined ) {\n\n\t\t\t\tlightAttribute = attr;\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( lightAttribute === undefined ) {\n\n\t\t\tmodel = new Object3D();\n\n\t\t} else {\n\n\t\t\tlet type;\n\n\t\t\t// LightType can be undefined for Point lights\n\t\t\tif ( lightAttribute.LightType === undefined ) {\n\n\t\t\t\ttype = 0;\n\n\t\t\t} else {\n\n\t\t\t\ttype = lightAttribute.LightType.value;\n\n\t\t\t}\n\n\t\t\tlet color = 0xffffff;\n\n\t\t\tif ( lightAttribute.Color !== undefined ) {\n\n\t\t\t\tcolor = new Color().fromArray( lightAttribute.Color.value ).convertSRGBToLinear();\n\n\t\t\t}\n\n\t\t\tlet intensity = ( lightAttribute.Intensity === undefined ) ? 1 : lightAttribute.Intensity.value / 100;\n\n\t\t\t// light disabled\n\t\t\tif ( lightAttribute.CastLightOnObject !== undefined && lightAttribute.CastLightOnObject.value === 0 ) {\n\n\t\t\t\tintensity = 0;\n\n\t\t\t}\n\n\t\t\tlet distance = 0;\n\t\t\tif ( lightAttribute.FarAttenuationEnd !== undefined ) {\n\n\t\t\t\tif ( lightAttribute.EnableFarAttenuation !== undefined && lightAttribute.EnableFarAttenuation.value === 0 ) {\n\n\t\t\t\t\tdistance = 0;\n\n\t\t\t\t} else {\n\n\t\t\t\t\tdistance = lightAttribute.FarAttenuationEnd.value;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// TODO: could this be calculated linearly from FarAttenuationStart to FarAttenuationEnd?\n\t\t\tconst decay = 1;\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 0: // Point\n\t\t\t\t\tmodel = new PointLight( color, intensity, distance, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 1: // Directional\n\t\t\t\t\tmodel = new DirectionalLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 2: // Spot\n\t\t\t\t\tlet angle = Math.PI / 3;\n\n\t\t\t\t\tif ( lightAttribute.InnerAngle !== undefined ) {\n\n\t\t\t\t\t\tangle = MathUtils.degToRad( lightAttribute.InnerAngle.value );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet penumbra = 0;\n\t\t\t\t\tif ( lightAttribute.OuterAngle !== undefined ) {\n\n\t\t\t\t\t\t// TODO: this is not correct - FBX calculates outer and inner angle in degrees\n\t\t\t\t\t\t// with OuterAngle > InnerAngle && OuterAngle <= Math.PI\n\t\t\t\t\t\t// while three.js uses a penumbra between (0, 1) to attenuate the inner angle\n\t\t\t\t\t\tpenumbra = MathUtils.degToRad( lightAttribute.OuterAngle.value );\n\t\t\t\t\t\tpenumbra = Math.max( penumbra, 1 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tmodel = new SpotLight( color, intensity, distance, angle, penumbra, decay );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Unknown light type ' + lightAttribute.LightType.value + ', defaulting to a PointLight.' );\n\t\t\t\t\tmodel = new PointLight( color, intensity );\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif ( lightAttribute.CastShadows !== undefined && lightAttribute.CastShadows.value === 1 ) {\n\n\t\t\t\tmodel.castShadow = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateMesh( relationships, geometryMap, materialMap ) {\n\n\t\tlet model;\n\t\tlet geometry = null;\n\t\tlet material = null;\n\t\tconst materials = [];\n\n\t\t// get geometry and materials(s) from connections\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) {\n\n\t\t\t\tgeometry = geometryMap.get( child.ID );\n\n\t\t\t}\n\n\t\t\tif ( materialMap.has( child.ID ) ) {\n\n\t\t\t\tmaterials.push( materialMap.get( child.ID ) );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tif ( materials.length > 1 ) {\n\n\t\t\tmaterial = materials;\n\n\t\t} else if ( materials.length > 0 ) {\n\n\t\t\tmaterial = materials[ 0 ];\n\n\t\t} else {\n\n\t\t\tmaterial = new MeshPhongMaterial( {\n\t\t\t\tname: Loader.DEFAULT_MATERIAL_NAME,\n\t\t\t\tcolor: 0xcccccc\n\t\t\t} );\n\t\t\tmaterials.push( material );\n\n\t\t}\n\n\t\tif ( 'color' in geometry.attributes ) {\n\n\t\t\tmaterials.forEach( function ( material ) {\n\n\t\t\t\tmaterial.vertexColors = true;\n\n\t\t\t} );\n\n\t\t}\n\n\t\tif ( geometry.FBX_Deformer ) {\n\n\t\t\tmodel = new SkinnedMesh( geometry, material );\n\t\t\tmodel.normalizeSkinWeights();\n\n\t\t} else {\n\n\t\t\tmodel = new Mesh( geometry, material );\n\n\t\t}\n\n\t\treturn model;\n\n\t}\n\n\tcreateCurve( relationships, geometryMap ) {\n\n\t\tconst geometry = relationships.children.reduce( function ( geo, child ) {\n\n\t\t\tif ( geometryMap.has( child.ID ) ) geo = geometryMap.get( child.ID );\n\n\t\t\treturn geo;\n\n\t\t}, null );\n\n\t\t// FBX does not list materials for Nurbs lines, so we'll just put our own in here.\n\t\tconst material = new LineBasicMaterial( {\n\t\t\tname: Loader.DEFAULT_MATERIAL_NAME,\n\t\t\tcolor: 0x3300ff,\n\t\t\tlinewidth: 1\n\t\t} );\n\t\treturn new Line( geometry, material );\n\n\t}\n\n\t// parse the model node for transform data\n\tgetTransformData( model, modelNode ) {\n\n\t\tconst transformData = {};\n\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\telse transformData.eulerOrder = 'ZYX';\n\n\t\tif ( 'Lcl_Translation' in modelNode ) transformData.translation = modelNode.Lcl_Translation.value;\n\n\t\tif ( 'PreRotation' in modelNode ) transformData.preRotation = modelNode.PreRotation.value;\n\t\tif ( 'Lcl_Rotation' in modelNode ) transformData.rotation = modelNode.Lcl_Rotation.value;\n\t\tif ( 'PostRotation' in modelNode ) transformData.postRotation = modelNode.PostRotation.value;\n\n\t\tif ( 'Lcl_Scaling' in modelNode ) transformData.scale = modelNode.Lcl_Scaling.value;\n\n\t\tif ( 'ScalingOffset' in modelNode ) transformData.scalingOffset = modelNode.ScalingOffset.value;\n\t\tif ( 'ScalingPivot' in modelNode ) transformData.scalingPivot = modelNode.ScalingPivot.value;\n\n\t\tif ( 'RotationOffset' in modelNode ) transformData.rotationOffset = modelNode.RotationOffset.value;\n\t\tif ( 'RotationPivot' in modelNode ) transformData.rotationPivot = modelNode.RotationPivot.value;\n\n\t\tmodel.userData.transformData = transformData;\n\n\t}\n\n\tsetLookAtProperties( model, modelNode ) {\n\n\t\tif ( 'LookAtProperty' in modelNode ) {\n\n\t\t\tconst children = connections.get( model.ID ).children;\n\n\t\t\tchildren.forEach( function ( child ) {\n\n\t\t\t\tif ( child.relationship === 'LookAtProperty' ) {\n\n\t\t\t\t\tconst lookAtTarget = fbxTree.Objects.Model[ child.ID ];\n\n\t\t\t\t\tif ( 'Lcl_Translation' in lookAtTarget ) {\n\n\t\t\t\t\t\tconst pos = lookAtTarget.Lcl_Translation.value;\n\n\t\t\t\t\t\t// DirectionalLight, SpotLight\n\t\t\t\t\t\tif ( model.target !== undefined ) {\n\n\t\t\t\t\t\t\tmodel.target.position.fromArray( pos );\n\t\t\t\t\t\t\tsceneGraph.add( model.target );\n\n\t\t\t\t\t\t} else { // Cameras and other Object3Ds\n\n\t\t\t\t\t\t\tmodel.lookAt( new Vector3().fromArray( pos ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tbindSkeleton( skeletons, geometryMap, modelMap ) {\n\n\t\tconst bindMatrices = this.parsePoseNodes();\n\n\t\tfor ( const ID in skeletons ) {\n\n\t\t\tconst skeleton = skeletons[ ID ];\n\n\t\t\tconst parents = connections.get( parseInt( skeleton.ID ) ).parents;\n\n\t\t\tparents.forEach( function ( parent ) {\n\n\t\t\t\tif ( geometryMap.has( parent.ID ) ) {\n\n\t\t\t\t\tconst geoID = parent.ID;\n\t\t\t\t\tconst geoRelationships = connections.get( geoID );\n\n\t\t\t\t\tgeoRelationships.parents.forEach( function ( geoConnParent ) {\n\n\t\t\t\t\t\tif ( modelMap.has( geoConnParent.ID ) ) {\n\n\t\t\t\t\t\t\tconst model = modelMap.get( geoConnParent.ID );\n\n\t\t\t\t\t\t\tmodel.bind( new Skeleton( skeleton.bones ), bindMatrices[ geoConnParent.ID ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\tparsePoseNodes() {\n\n\t\tconst bindMatrices = {};\n\n\t\tif ( 'Pose' in fbxTree.Objects ) {\n\n\t\t\tconst BindPoseNode = fbxTree.Objects.Pose;\n\n\t\t\tfor ( const nodeID in BindPoseNode ) {\n\n\t\t\t\tif ( BindPoseNode[ nodeID ].attrType === 'BindPose' && BindPoseNode[ nodeID ].NbPoseNodes > 0 ) {\n\n\t\t\t\t\tconst poseNodes = BindPoseNode[ nodeID ].PoseNode;\n\n\t\t\t\t\tif ( Array.isArray( poseNodes ) ) {\n\n\t\t\t\t\t\tposeNodes.forEach( function ( poseNode ) {\n\n\t\t\t\t\t\t\tbindMatrices[ poseNode.Node ] = new Matrix4().fromArray( poseNode.Matrix.a );\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tbindMatrices[ poseNodes.Node ] = new Matrix4().fromArray( poseNodes.Matrix.a );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn bindMatrices;\n\n\t}\n\n\taddGlobalSceneSettings() {\n\n\t\tif ( 'GlobalSettings' in fbxTree ) {\n\n\t\t\tif ( 'AmbientColor' in fbxTree.GlobalSettings ) {\n\n\t\t\t\t// Parse ambient color - if it's not set to black (default), create an ambient light\n\n\t\t\t\tconst ambientColor = fbxTree.GlobalSettings.AmbientColor.value;\n\t\t\t\tconst r = ambientColor[ 0 ];\n\t\t\t\tconst g = ambientColor[ 1 ];\n\t\t\t\tconst b = ambientColor[ 2 ];\n\n\t\t\t\tif ( r !== 0 || g !== 0 || b !== 0 ) {\n\n\t\t\t\t\tconst color = new Color( r, g, b ).convertSRGBToLinear();\n\t\t\t\t\tsceneGraph.add( new AmbientLight( color, 1 ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( 'UnitScaleFactor' in fbxTree.GlobalSettings ) {\n\n\t\t\t\tsceneGraph.userData.unitScaleFactor = fbxTree.GlobalSettings.UnitScaleFactor.value;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\n// parse Geometry data from FBXTree and return map of BufferGeometries\nclass GeometryParser {\n\n\tconstructor() {\n\n\t\tthis.negativeMaterialIndices = false;\n\n\t}\n\n\t// Parse nodes in FBXTree.Objects.Geometry\n\tparse( deformers ) {\n\n\t\tconst geometryMap = new Map();\n\n\t\tif ( 'Geometry' in fbxTree.Objects ) {\n\n\t\t\tconst geoNodes = fbxTree.Objects.Geometry;\n\n\t\t\tfor ( const nodeID in geoNodes ) {\n\n\t\t\t\tconst relationships = connections.get( parseInt( nodeID ) );\n\t\t\t\tconst geo = this.parseGeometry( relationships, geoNodes[ nodeID ], deformers );\n\n\t\t\t\tgeometryMap.set( parseInt( nodeID ), geo );\n\n\t\t\t}\n\n\t\t}\n\n\t\t// report warnings\n\n\t\tif ( this.negativeMaterialIndices === true ) {\n\n\t\t\tconsole.warn( 'THREE.FBXLoader: The FBX file contains invalid (negative) material indices. The asset might not render as expected.' );\n\n\t\t}\n\n\t\treturn geometryMap;\n\n\t}\n\n\t// Parse single node in FBXTree.Objects.Geometry\n\tparseGeometry( relationships, geoNode, deformers ) {\n\n\t\tswitch ( geoNode.attrType ) {\n\n\t\t\tcase 'Mesh':\n\t\t\t\treturn this.parseMeshGeometry( relationships, geoNode, deformers );\n\t\t\t\tbreak;\n\n\t\t\tcase 'NurbsCurve':\n\t\t\t\treturn this.parseNurbsGeometry( geoNode );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t}\n\n\t// Parse single node mesh geometry in FBXTree.Objects.Geometry\n\tparseMeshGeometry( relationships, geoNode, deformers ) {\n\n\t\tconst skeletons = deformers.skeletons;\n\t\tconst morphTargets = [];\n\n\t\tconst modelNodes = relationships.parents.map( function ( parent ) {\n\n\t\t\treturn fbxTree.Objects.Model[ parent.ID ];\n\n\t\t} );\n\n\t\t// don't create geometry if it is not associated with any models\n\t\tif ( modelNodes.length === 0 ) return;\n\n\t\tconst skeleton = relationships.children.reduce( function ( skeleton, child ) {\n\n\t\t\tif ( skeletons[ child.ID ] !== undefined ) skeleton = skeletons[ child.ID ];\n\n\t\t\treturn skeleton;\n\n\t\t}, null );\n\n\t\trelationships.children.forEach( function ( child ) {\n\n\t\t\tif ( deformers.morphTargets[ child.ID ] !== undefined ) {\n\n\t\t\t\tmorphTargets.push( deformers.morphTargets[ child.ID ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\t// Assume one model and get the preRotation from that\n\t\t// if there is more than one model associated with the geometry this may cause problems\n\t\tconst modelNode = modelNodes[ 0 ];\n\n\t\tconst transformData = {};\n\n\t\tif ( 'RotationOrder' in modelNode ) transformData.eulerOrder = getEulerOrder( modelNode.RotationOrder.value );\n\t\tif ( 'InheritType' in modelNode ) transformData.inheritType = parseInt( modelNode.InheritType.value );\n\n\t\tif ( 'GeometricTranslation' in modelNode ) transformData.translation = modelNode.GeometricTranslation.value;\n\t\tif ( 'GeometricRotation' in modelNode ) transformData.rotation = modelNode.GeometricRotation.value;\n\t\tif ( 'GeometricScaling' in modelNode ) transformData.scale = modelNode.GeometricScaling.value;\n\n\t\tconst transform = generateTransform( transformData );\n\n\t\treturn this.genGeometry( geoNode, skeleton, morphTargets, transform );\n\n\t}\n\n\t// Generate a BufferGeometry from a node in FBXTree.Objects.Geometry\n\tgenGeometry( geoNode, skeleton, morphTargets, preTransform ) {\n\n\t\tconst geo = new BufferGeometry();\n\t\tif ( geoNode.attrName ) geo.name = geoNode.attrName;\n\n\t\tconst geoInfo = this.parseGeoNode( geoNode, skeleton );\n\t\tconst buffers = this.genBuffers( geoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( buffers.vertex, 3 );\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tgeo.setAttribute( 'position', positionAttribute );\n\n\t\tif ( buffers.colors.length > 0 ) {\n\n\t\t\tgeo.setAttribute( 'color', new Float32BufferAttribute( buffers.colors, 3 ) );\n\n\t\t}\n\n\t\tif ( skeleton ) {\n\n\t\t\tgeo.setAttribute( 'skinIndex', new Uint16BufferAttribute( buffers.weightsIndices, 4 ) );\n\n\t\t\tgeo.setAttribute( 'skinWeight', new Float32BufferAttribute( buffers.vertexWeights, 4 ) );\n\n\t\t\t// used later to bind the skeleton to the model\n\t\t\tgeo.FBX_Deformer = skeleton;\n\n\t\t}\n\n\t\tif ( buffers.normal.length > 0 ) {\n\n\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( preTransform );\n\n\t\t\tconst normalAttribute = new Float32BufferAttribute( buffers.normal, 3 );\n\t\t\tnormalAttribute.applyNormalMatrix( normalMatrix );\n\n\t\t\tgeo.setAttribute( 'normal', normalAttribute );\n\n\t\t}\n\n\t\tbuffers.uvs.forEach( function ( uvBuffer, i ) {\n\n\t\t\tconst name = i === 0 ? 'uv' : `uv${ i }`;\n\n\t\t\tgeo.setAttribute( name, new Float32BufferAttribute( buffers.uvs[ i ], 2 ) );\n\n\t\t} );\n\n\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t// Convert the material indices of each vertex into rendering groups on the geometry.\n\t\t\tlet prevMaterialIndex = buffers.materialIndex[ 0 ];\n\t\t\tlet startIndex = 0;\n\n\t\t\tbuffers.materialIndex.forEach( function ( currentIndex, i ) {\n\n\t\t\t\tif ( currentIndex !== prevMaterialIndex ) {\n\n\t\t\t\t\tgeo.addGroup( startIndex, i - startIndex, prevMaterialIndex );\n\n\t\t\t\t\tprevMaterialIndex = currentIndex;\n\t\t\t\t\tstartIndex = i;\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t\t// the loop above doesn't add the last group, do that here.\n\t\t\tif ( geo.groups.length > 0 ) {\n\n\t\t\t\tconst lastGroup = geo.groups[ geo.groups.length - 1 ];\n\t\t\t\tconst lastIndex = lastGroup.start + lastGroup.count;\n\n\t\t\t\tif ( lastIndex !== buffers.materialIndex.length ) {\n\n\t\t\t\t\tgeo.addGroup( lastIndex, buffers.materialIndex.length - lastIndex, prevMaterialIndex );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// case where there are multiple materials but the whole geometry is only\n\t\t\t// using one of them\n\t\t\tif ( geo.groups.length === 0 ) {\n\n\t\t\t\tgeo.addGroup( 0, buffers.materialIndex.length, buffers.materialIndex[ 0 ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.addMorphTargets( geo, geoNode, morphTargets, preTransform );\n\n\t\treturn geo;\n\n\t}\n\n\tparseGeoNode( geoNode, skeleton ) {\n\n\t\tconst geoInfo = {};\n\n\t\tgeoInfo.vertexPositions = ( geoNode.Vertices !== undefined ) ? geoNode.Vertices.a : [];\n\t\tgeoInfo.vertexIndices = ( geoNode.PolygonVertexIndex !== undefined ) ? geoNode.PolygonVertexIndex.a : [];\n\n\t\tif ( geoNode.LayerElementColor ) {\n\n\t\t\tgeoInfo.color = this.parseVertexColors( geoNode.LayerElementColor[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementMaterial ) {\n\n\t\t\tgeoInfo.material = this.parseMaterialIndices( geoNode.LayerElementMaterial[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementNormal ) {\n\n\t\t\tgeoInfo.normal = this.parseNormals( geoNode.LayerElementNormal[ 0 ] );\n\n\t\t}\n\n\t\tif ( geoNode.LayerElementUV ) {\n\n\t\t\tgeoInfo.uv = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile ( geoNode.LayerElementUV[ i ] ) {\n\n\t\t\t\tif ( geoNode.LayerElementUV[ i ].UV ) {\n\n\t\t\t\t\tgeoInfo.uv.push( this.parseUVs( geoNode.LayerElementUV[ i ] ) );\n\n\t\t\t\t}\n\n\t\t\t\ti ++;\n\n\t\t\t}\n\n\t\t}\n\n\t\tgeoInfo.weightTable = {};\n\n\t\tif ( skeleton !== null ) {\n\n\t\t\tgeoInfo.skeleton = skeleton;\n\n\t\t\tskeleton.rawBones.forEach( function ( rawBone, i ) {\n\n\t\t\t\t// loop over the bone's vertex indices and weights\n\t\t\t\trawBone.indices.forEach( function ( index, j ) {\n\n\t\t\t\t\tif ( geoInfo.weightTable[ index ] === undefined ) geoInfo.weightTable[ index ] = [];\n\n\t\t\t\t\tgeoInfo.weightTable[ index ].push( {\n\n\t\t\t\t\t\tid: i,\n\t\t\t\t\t\tweight: rawBone.weights[ j ],\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn geoInfo;\n\n\t}\n\n\tgenBuffers( geoInfo ) {\n\n\t\tconst buffers = {\n\t\t\tvertex: [],\n\t\t\tnormal: [],\n\t\t\tcolors: [],\n\t\t\tuvs: [],\n\t\t\tmaterialIndex: [],\n\t\t\tvertexWeights: [],\n\t\t\tweightsIndices: [],\n\t\t};\n\n\t\tlet polygonIndex = 0;\n\t\tlet faceLength = 0;\n\t\tlet displayedWeightsWarning = false;\n\n\t\t// these will hold data for a single face\n\t\tlet facePositionIndexes = [];\n\t\tlet faceNormals = [];\n\t\tlet faceColors = [];\n\t\tlet faceUVs = [];\n\t\tlet faceWeights = [];\n\t\tlet faceWeightIndices = [];\n\n\t\tconst scope = this;\n\t\tgeoInfo.vertexIndices.forEach( function ( vertexIndex, polygonVertexIndex ) {\n\n\t\t\tlet materialIndex;\n\t\t\tlet endOfFace = false;\n\n\t\t\t// Face index and vertex index arrays are combined in a single array\n\t\t\t// A cube with quad faces looks like this:\n\t\t\t// PolygonVertexIndex: *24 {\n\t\t\t//  a: 0, 1, 3, -3, 2, 3, 5, -5, 4, 5, 7, -7, 6, 7, 1, -1, 1, 7, 5, -4, 6, 0, 2, -5\n\t\t\t//  }\n\t\t\t// Negative numbers mark the end of a face - first face here is 0, 1, 3, -3\n\t\t\t// to find index of last vertex bit shift the index: ^ - 1\n\t\t\tif ( vertexIndex < 0 ) {\n\n\t\t\t\tvertexIndex = vertexIndex ^ - 1; // equivalent to ( x * -1 ) - 1\n\t\t\t\tendOfFace = true;\n\n\t\t\t}\n\n\t\t\tlet weightIndices = [];\n\t\t\tlet weights = [];\n\n\t\t\tfacePositionIndexes.push( vertexIndex * 3, vertexIndex * 3 + 1, vertexIndex * 3 + 2 );\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.color );\n\n\t\t\t\tfaceColors.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tif ( geoInfo.weightTable[ vertexIndex ] !== undefined ) {\n\n\t\t\t\t\tgeoInfo.weightTable[ vertexIndex ].forEach( function ( wt ) {\n\n\t\t\t\t\t\tweights.push( wt.weight );\n\t\t\t\t\t\tweightIndices.push( wt.id );\n\n\t\t\t\t\t} );\n\n\n\t\t\t\t}\n\n\t\t\t\tif ( weights.length > 4 ) {\n\n\t\t\t\t\tif ( ! displayedWeightsWarning ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights.' );\n\t\t\t\t\t\tdisplayedWeightsWarning = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst wIndex = [ 0, 0, 0, 0 ];\n\t\t\t\t\tconst Weight = [ 0, 0, 0, 0 ];\n\n\t\t\t\t\tweights.forEach( function ( weight, weightIndex ) {\n\n\t\t\t\t\t\tlet currentWeight = weight;\n\t\t\t\t\t\tlet currentIndex = weightIndices[ weightIndex ];\n\n\t\t\t\t\t\tWeight.forEach( function ( comparedWeight, comparedWeightIndex, comparedWeightArray ) {\n\n\t\t\t\t\t\t\tif ( currentWeight > comparedWeight ) {\n\n\t\t\t\t\t\t\t\tcomparedWeightArray[ comparedWeightIndex ] = currentWeight;\n\t\t\t\t\t\t\t\tcurrentWeight = comparedWeight;\n\n\t\t\t\t\t\t\t\tconst tmp = wIndex[ comparedWeightIndex ];\n\t\t\t\t\t\t\t\twIndex[ comparedWeightIndex ] = currentIndex;\n\t\t\t\t\t\t\t\tcurrentIndex = tmp;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tweightIndices = wIndex;\n\t\t\t\t\tweights = Weight;\n\n\t\t\t\t}\n\n\t\t\t\t// if the weight array is shorter than 4 pad with 0s\n\t\t\t\twhile ( weights.length < 4 ) {\n\n\t\t\t\t\tweights.push( 0 );\n\t\t\t\t\tweightIndices.push( 0 );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0; i < 4; ++ i ) {\n\n\t\t\t\t\tfaceWeights.push( weights[ i ] );\n\t\t\t\t\tfaceWeightIndices.push( weightIndices[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.normal );\n\n\t\t\t\tfaceNormals.push( data[ 0 ], data[ 1 ], data[ 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tmaterialIndex = getData( polygonVertexIndex, polygonIndex, vertexIndex, geoInfo.material )[ 0 ];\n\n\t\t\t\tif ( materialIndex < 0 ) {\n\n\t\t\t\t\tscope.negativeMaterialIndices = true;\n\t\t\t\t\tmaterialIndex = 0; // fallback\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, i ) {\n\n\t\t\t\t\tconst data = getData( polygonVertexIndex, polygonIndex, vertexIndex, uv );\n\n\t\t\t\t\tif ( faceUVs[ i ] === undefined ) {\n\n\t\t\t\t\t\tfaceUVs[ i ] = [];\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfaceUVs[ i ].push( data[ 0 ] );\n\t\t\t\t\tfaceUVs[ i ].push( data[ 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfaceLength ++;\n\n\t\t\tif ( endOfFace ) {\n\n\t\t\t\tscope.genFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength );\n\n\t\t\t\tpolygonIndex ++;\n\t\t\t\tfaceLength = 0;\n\n\t\t\t\t// reset arrays for the next face\n\t\t\t\tfacePositionIndexes = [];\n\t\t\t\tfaceNormals = [];\n\t\t\t\tfaceColors = [];\n\t\t\t\tfaceUVs = [];\n\t\t\t\tfaceWeights = [];\n\t\t\t\tfaceWeightIndices = [];\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn buffers;\n\n\t}\n\n\t// See https://www.khronos.org/opengl/wiki/Calculating_a_Surface_Normal\n\tgetNormalNewell( vertices ) {\n\n\t\tconst normal = new Vector3( 0.0, 0.0, 0.0 );\n\n\t\tfor ( let i = 0; i < vertices.length; i ++ ) {\n\n\t\t\tconst current = vertices[ i ];\n\t\t\tconst next = vertices[ ( i + 1 ) % vertices.length ];\n\n\t\t\tnormal.x += ( current.y - next.y ) * ( current.z + next.z );\n\t\t\tnormal.y += ( current.z - next.z ) * ( current.x + next.x );\n\t\t\tnormal.z += ( current.x - next.x ) * ( current.y + next.y );\n\n\t\t}\n\n\t\tnormal.normalize();\n\n\t\treturn normal;\n\n\t}\n\n\tgetNormalTangentAndBitangent( vertices ) {\n\n\t\tconst normalVector = this.getNormalNewell( vertices );\n\t\t// Avoid up being equal or almost equal to normalVector\n\t\tconst up = Math.abs( normalVector.z ) > 0.5 ? new Vector3( 0.0, 1.0, 0.0 ) : new Vector3( 0.0, 0.0, 1.0 );\n\t\tconst tangent = up.cross( normalVector ).normalize();\n\t\tconst bitangent = normalVector.clone().cross( tangent ).normalize();\n\n\t\treturn {\n\t\t\tnormal: normalVector,\n\t\t\ttangent: tangent,\n\t\t\tbitangent: bitangent\n\t\t};\n\n\t}\n\n\tflattenVertex( vertex, normalTangent, normalBitangent ) {\n\n\t\treturn new Vector2(\n\t\t\tvertex.dot( normalTangent ),\n\t\t\tvertex.dot( normalBitangent )\n\t\t);\n\n\t}\n\n\t// Generate data for a single face in a geometry. If the face is a quad then split it into 2 tris\n\tgenFace( buffers, geoInfo, facePositionIndexes, materialIndex, faceNormals, faceColors, faceUVs, faceWeights, faceWeightIndices, faceLength ) {\n\n\t\tlet triangles;\n\n\t\tif ( faceLength > 3 ) {\n\n\t\t\t// Triangulate n-gon using earcut\n\n\t\t\tconst vertices = [];\n\n\t\t\tfor ( let i = 0; i < facePositionIndexes.length; i += 3 ) {\n\n\t\t\t\tvertices.push( new Vector3(\n\t\t\t\t\tgeoInfo.vertexPositions[ facePositionIndexes[ i ] ],\n\t\t\t\t\tgeoInfo.vertexPositions[ facePositionIndexes[ i + 1 ] ],\n\t\t\t\t\tgeoInfo.vertexPositions[ facePositionIndexes[ i + 2 ] ]\n\t\t\t\t) );\n\n\t\t\t}\n\n\t\t\tconst { tangent, bitangent } = this.getNormalTangentAndBitangent( vertices );\n\t\t\tconst triangulationInput = [];\n\n\t\t\tfor ( const vertex of vertices ) {\n\n\t\t\t\ttriangulationInput.push( this.flattenVertex( vertex, tangent, bitangent ) );\n\n\t\t\t}\n\n\t\t\ttriangles = ShapeUtils.triangulateShape( triangulationInput, [] );\n\n\t\t} else {\n\n\t\t\t// Regular triangle, skip earcut triangulation step\n\t\t\ttriangles = [[ 0, 1, 2 ]];\n\n\t\t}\n\n\t\tfor ( const [ i0, i1, i2 ] of triangles ) {\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i0 * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i0 * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i0 * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i1 * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i1 * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i1 * 3 + 2 ] ] );\n\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i2 * 3 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i2 * 3 + 1 ] ] );\n\t\t\tbuffers.vertex.push( geoInfo.vertexPositions[ facePositionIndexes[ i2 * 3 + 2 ] ] );\n\n\t\t\tif ( geoInfo.skeleton ) {\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i0 * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i0 * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i0 * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i0 * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i1 * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i1 * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i1 * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i1 * 4 + 3 ] );\n\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i2 * 4 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i2 * 4 + 1 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i2 * 4 + 2 ] );\n\t\t\t\tbuffers.vertexWeights.push( faceWeights[ i2 * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i0 * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i0 * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i0 * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i0 * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i1 * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i1 * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i1 * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i1 * 4 + 3 ] );\n\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i2 * 4 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i2 * 4 + 1 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i2 * 4 + 2 ] );\n\t\t\t\tbuffers.weightsIndices.push( faceWeightIndices[ i2 * 4 + 3 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.color ) {\n\n\t\t\t\tbuffers.colors.push( faceColors[ i0 * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i0 * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i0 * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i1 * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i1 * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i1 * 3 + 2 ] );\n\n\t\t\t\tbuffers.colors.push( faceColors[ i2 * 3 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i2 * 3 + 1 ] );\n\t\t\t\tbuffers.colors.push( faceColors[ i2 * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.material && geoInfo.material.mappingType !== 'AllSame' ) {\n\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\t\t\t\tbuffers.materialIndex.push( materialIndex );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.normal ) {\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i0 * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i0 * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i0 * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i1 * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i1 * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i1 * 3 + 2 ] );\n\n\t\t\t\tbuffers.normal.push( faceNormals[ i2 * 3 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i2 * 3 + 1 ] );\n\t\t\t\tbuffers.normal.push( faceNormals[ i2 * 3 + 2 ] );\n\n\t\t\t}\n\n\t\t\tif ( geoInfo.uv ) {\n\n\t\t\t\tgeoInfo.uv.forEach( function ( uv, j ) {\n\n\t\t\t\t\tif ( buffers.uvs[ j ] === undefined ) buffers.uvs[ j ] = [];\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i0 * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i0 * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i1 * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i1 * 2 + 1 ] );\n\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i2 * 2 ] );\n\t\t\t\t\tbuffers.uvs[ j ].push( faceUVs[ j ][ i2 * 2 + 1 ] );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\taddMorphTargets( parentGeo, parentGeoNode, morphTargets, preTransform ) {\n\n\t\tif ( morphTargets.length === 0 ) return;\n\n\t\tparentGeo.morphTargetsRelative = true;\n\n\t\tparentGeo.morphAttributes.position = [];\n\t\t// parentGeo.morphAttributes.normal = []; // not implemented\n\n\t\tconst scope = this;\n\t\tmorphTargets.forEach( function ( morphTarget ) {\n\n\t\t\tmorphTarget.rawTargets.forEach( function ( rawTarget ) {\n\n\t\t\t\tconst morphGeoNode = fbxTree.Objects.Geometry[ rawTarget.geoID ];\n\n\t\t\t\tif ( morphGeoNode !== undefined ) {\n\n\t\t\t\t\tscope.genMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, rawTarget.name );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t// a morph geometry node is similar to a standard  node, and the node is also contained\n\t// in FBXTree.Objects.Geometry, however it can only have attributes for position, normal\n\t// and a special attribute Index defining which vertices of the original geometry are affected\n\t// Normal and position attributes only have data for the vertices that are affected by the morph\n\tgenMorphGeometry( parentGeo, parentGeoNode, morphGeoNode, preTransform, name ) {\n\n\t\tconst vertexIndices = ( parentGeoNode.PolygonVertexIndex !== undefined ) ? parentGeoNode.PolygonVertexIndex.a : [];\n\n\t\tconst morphPositionsSparse = ( morphGeoNode.Vertices !== undefined ) ? morphGeoNode.Vertices.a : [];\n\t\tconst indices = ( morphGeoNode.Indexes !== undefined ) ? morphGeoNode.Indexes.a : [];\n\n\t\tconst length = parentGeo.attributes.position.count * 3;\n\t\tconst morphPositions = new Float32Array( length );\n\n\t\tfor ( let i = 0; i < indices.length; i ++ ) {\n\n\t\t\tconst morphIndex = indices[ i ] * 3;\n\n\t\t\tmorphPositions[ morphIndex ] = morphPositionsSparse[ i * 3 ];\n\t\t\tmorphPositions[ morphIndex + 1 ] = morphPositionsSparse[ i * 3 + 1 ];\n\t\t\tmorphPositions[ morphIndex + 2 ] = morphPositionsSparse[ i * 3 + 2 ];\n\n\t\t}\n\n\t\t// TODO: add morph normal support\n\t\tconst morphGeoInfo = {\n\t\t\tvertexIndices: vertexIndices,\n\t\t\tvertexPositions: morphPositions,\n\n\t\t};\n\n\t\tconst morphBuffers = this.genBuffers( morphGeoInfo );\n\n\t\tconst positionAttribute = new Float32BufferAttribute( morphBuffers.vertex, 3 );\n\t\tpositionAttribute.name = name || morphGeoNode.attrName;\n\n\t\tpositionAttribute.applyMatrix4( preTransform );\n\n\t\tparentGeo.morphAttributes.position.push( positionAttribute );\n\n\t}\n\n\t// Parse normal from FBXTree.Objects.Geometry.LayerElementNormal if it exists\n\tparseNormals( NormalNode ) {\n\n\t\tconst mappingType = NormalNode.MappingInformationType;\n\t\tconst referenceType = NormalNode.ReferenceInformationType;\n\t\tconst buffer = NormalNode.Normals.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tif ( 'NormalIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalIndex.a;\n\n\t\t\t} else if ( 'NormalsIndex' in NormalNode ) {\n\n\t\t\t\tindexBuffer = NormalNode.NormalsIndex.a;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 3,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse UVs from FBXTree.Objects.Geometry.LayerElementUV if it exists\n\tparseUVs( UVNode ) {\n\n\t\tconst mappingType = UVNode.MappingInformationType;\n\t\tconst referenceType = UVNode.ReferenceInformationType;\n\t\tconst buffer = UVNode.UV.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = UVNode.UVIndex.a;\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 2,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse Vertex Colors from FBXTree.Objects.Geometry.LayerElementColor if it exists\n\tparseVertexColors( ColorNode ) {\n\n\t\tconst mappingType = ColorNode.MappingInformationType;\n\t\tconst referenceType = ColorNode.ReferenceInformationType;\n\t\tconst buffer = ColorNode.Colors.a;\n\t\tlet indexBuffer = [];\n\t\tif ( referenceType === 'IndexToDirect' ) {\n\n\t\t\tindexBuffer = ColorNode.ColorIndex.a;\n\n\t\t}\n\n\t\tfor ( let i = 0, c = new Color(); i < buffer.length; i += 4 ) {\n\n\t\t\tc.fromArray( buffer, i ).convertSRGBToLinear().toArray( buffer, i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 4,\n\t\t\tbuffer: buffer,\n\t\t\tindices: indexBuffer,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Parse mapping and material data in FBXTree.Objects.Geometry.LayerElementMaterial if it exists\n\tparseMaterialIndices( MaterialNode ) {\n\n\t\tconst mappingType = MaterialNode.MappingInformationType;\n\t\tconst referenceType = MaterialNode.ReferenceInformationType;\n\n\t\tif ( mappingType === 'NoMappingInformation' ) {\n\n\t\t\treturn {\n\t\t\t\tdataSize: 1,\n\t\t\t\tbuffer: [ 0 ],\n\t\t\t\tindices: [ 0 ],\n\t\t\t\tmappingType: 'AllSame',\n\t\t\t\treferenceType: referenceType\n\t\t\t};\n\n\t\t}\n\n\t\tconst materialIndexBuffer = MaterialNode.Materials.a;\n\n\t\t// Since materials are stored as indices, there's a bit of a mismatch between FBX and what\n\t\t// we expect.So we create an intermediate buffer that points to the index in the buffer,\n\t\t// for conforming with the other functions we've written for other data.\n\t\tconst materialIndices = [];\n\n\t\tfor ( let i = 0; i < materialIndexBuffer.length; ++ i ) {\n\n\t\t\tmaterialIndices.push( i );\n\n\t\t}\n\n\t\treturn {\n\t\t\tdataSize: 1,\n\t\t\tbuffer: materialIndexBuffer,\n\t\t\tindices: materialIndices,\n\t\t\tmappingType: mappingType,\n\t\t\treferenceType: referenceType\n\t\t};\n\n\t}\n\n\t// Generate a NurbGeometry from a node in FBXTree.Objects.Geometry\n\tparseNurbsGeometry( geoNode ) {\n\n\t\tconst order = parseInt( geoNode.Order );\n\n\t\tif ( isNaN( order ) ) {\n\n\t\t\tconsole.error( 'THREE.FBXLoader: Invalid Order %s given for geometry ID: %s', geoNode.Order, geoNode.id );\n\t\t\treturn new BufferGeometry();\n\n\t\t}\n\n\t\tconst degree = order - 1;\n\n\t\tconst knots = geoNode.KnotVector.a;\n\t\tconst controlPoints = [];\n\t\tconst pointsValues = geoNode.Points.a;\n\n\t\tfor ( let i = 0, l = pointsValues.length; i < l; i += 4 ) {\n\n\t\t\tcontrolPoints.push( new Vector4().fromArray( pointsValues, i ) );\n\n\t\t}\n\n\t\tlet startKnot, endKnot;\n\n\t\tif ( geoNode.Form === 'Closed' ) {\n\n\t\t\tcontrolPoints.push( controlPoints[ 0 ] );\n\n\t\t} else if ( geoNode.Form === 'Periodic' ) {\n\n\t\t\tstartKnot = degree;\n\t\t\tendKnot = knots.length - 1 - startKnot;\n\n\t\t\tfor ( let i = 0; i < degree; ++ i ) {\n\n\t\t\t\tcontrolPoints.push( controlPoints[ i ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst curve = new NURBSCurve( degree, knots, controlPoints, startKnot, endKnot );\n\t\tconst points = curve.getPoints( controlPoints.length * 12 );\n\n\t\treturn new BufferGeometry().setFromPoints( points );\n\n\t}\n\n}\n\n// parse animation data from FBXTree\nclass AnimationParser {\n\n\t// take raw animation clips and turn them into three.js animation clips\n\tparse() {\n\n\t\tconst animationClips = [];\n\n\t\tconst rawClips = this.parseClips();\n\n\t\tif ( rawClips !== undefined ) {\n\n\t\t\tfor ( const key in rawClips ) {\n\n\t\t\t\tconst rawClip = rawClips[ key ];\n\n\t\t\t\tconst clip = this.addClip( rawClip );\n\n\t\t\t\tanimationClips.push( clip );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn animationClips;\n\n\t}\n\n\tparseClips() {\n\n\t\t// since the actual transformation data is stored in FBXTree.Objects.AnimationCurve,\n\t\t// if this is undefined we can safely assume there are no animations\n\t\tif ( fbxTree.Objects.AnimationCurve === undefined ) return undefined;\n\n\t\tconst curveNodesMap = this.parseAnimationCurveNodes();\n\n\t\tthis.parseAnimationCurves( curveNodesMap );\n\n\t\tconst layersMap = this.parseAnimationLayers( curveNodesMap );\n\t\tconst rawClips = this.parseAnimStacks( layersMap );\n\n\t\treturn rawClips;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurveNode\n\t// each AnimationCurveNode holds data for an animation transform for a model (e.g. left arm rotation )\n\t// and is referenced by an AnimationLayer\n\tparseAnimationCurveNodes() {\n\n\t\tconst rawCurveNodes = fbxTree.Objects.AnimationCurveNode;\n\n\t\tconst curveNodesMap = new Map();\n\n\t\tfor ( const nodeID in rawCurveNodes ) {\n\n\t\t\tconst rawCurveNode = rawCurveNodes[ nodeID ];\n\n\t\t\tif ( rawCurveNode.attrName.match( /S|R|T|DeformPercent/ ) !== null ) {\n\n\t\t\t\tconst curveNode = {\n\n\t\t\t\t\tid: rawCurveNode.id,\n\t\t\t\t\tattr: rawCurveNode.attrName,\n\t\t\t\t\tcurves: {},\n\n\t\t\t\t};\n\n\t\t\t\tcurveNodesMap.set( curveNode.id, curveNode );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn curveNodesMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationCurve and connect them up to\n\t// previously parsed AnimationCurveNodes. Each AnimationCurve holds data for a single animated\n\t// axis ( e.g. times and values of x rotation)\n\tparseAnimationCurves( curveNodesMap ) {\n\n\t\tconst rawCurves = fbxTree.Objects.AnimationCurve;\n\n\t\t// TODO: Many values are identical up to roundoff error, but won't be optimised\n\t\t// e.g. position times: [0, 0.4, 0. 8]\n\t\t// position values: [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.23538335023477e-7, 93.67518615722656, -0.9982695579528809, 7.235384487103147e-7, 93.67520904541016, -0.9982695579528809]\n\t\t// clearly, this should be optimised to\n\t\t// times: [0], positions [7.23538335023477e-7, 93.67518615722656, -0.9982695579528809]\n\t\t// this shows up in nearly every FBX file, and generally time array is length > 100\n\n\t\tfor ( const nodeID in rawCurves ) {\n\n\t\t\tconst animationCurve = {\n\n\t\t\t\tid: rawCurves[ nodeID ].id,\n\t\t\t\ttimes: rawCurves[ nodeID ].KeyTime.a.map( convertFBXTimeToSeconds ),\n\t\t\t\tvalues: rawCurves[ nodeID ].KeyValueFloat.a,\n\n\t\t\t};\n\n\t\t\tconst relationships = connections.get( animationCurve.id );\n\n\t\t\tif ( relationships !== undefined ) {\n\n\t\t\t\tconst animationCurveID = relationships.parents[ 0 ].ID;\n\t\t\t\tconst animationCurveRelationship = relationships.parents[ 0 ].relationship;\n\n\t\t\t\tif ( animationCurveRelationship.match( /X/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'x' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Y/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'y' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /Z/ ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'z' ] = animationCurve;\n\n\t\t\t\t} else if ( animationCurveRelationship.match( /DeformPercent/ ) && curveNodesMap.has( animationCurveID ) ) {\n\n\t\t\t\t\tcurveNodesMap.get( animationCurveID ).curves[ 'morph' ] = animationCurve;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationLayer. Each layers holds references\n\t// to various AnimationCurveNodes and is referenced by an AnimationStack node\n\t// note: theoretically a stack can have multiple layers, however in practice there always seems to be one per stack\n\tparseAnimationLayers( curveNodesMap ) {\n\n\t\tconst rawLayers = fbxTree.Objects.AnimationLayer;\n\n\t\tconst layersMap = new Map();\n\n\t\tfor ( const nodeID in rawLayers ) {\n\n\t\t\tconst layerCurveNodes = [];\n\n\t\t\tconst connection = connections.get( parseInt( nodeID ) );\n\n\t\t\tif ( connection !== undefined ) {\n\n\t\t\t\t// all the animationCurveNodes used in the layer\n\t\t\t\tconst children = connection.children;\n\n\t\t\t\tchildren.forEach( function ( child, i ) {\n\n\t\t\t\t\tif ( curveNodesMap.has( child.ID ) ) {\n\n\t\t\t\t\t\tconst curveNode = curveNodesMap.get( child.ID );\n\n\t\t\t\t\t\t// check that the curves are defined for at least one axis, otherwise ignore the curveNode\n\t\t\t\t\t\tif ( curveNode.curves.x !== undefined || curveNode.curves.y !== undefined || curveNode.curves.z !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst modelID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tif ( modelID !== undefined ) {\n\n\t\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID.toString() ];\n\n\t\t\t\t\t\t\t\t\tif ( rawModel === undefined ) {\n\n\t\t\t\t\t\t\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered a unused curve.', child );\n\t\t\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\t\tID: rawModel.id,\n\t\t\t\t\t\t\t\t\t\tinitialPosition: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialRotation: [ 0, 0, 0 ],\n\t\t\t\t\t\t\t\t\t\tinitialScale: [ 1, 1, 1 ],\n\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\t\tsceneGraph.traverse( function ( child ) {\n\n\t\t\t\t\t\t\t\t\t\tif ( child.ID === rawModel.id ) {\n\n\t\t\t\t\t\t\t\t\t\t\tnode.transform = child.matrix;\n\n\t\t\t\t\t\t\t\t\t\t\tif ( child.userData.transformData ) node.eulerOrder = child.userData.transformData.eulerOrder;\n\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\t\t\tif ( ! node.transform ) node.transform = new Matrix4();\n\n\t\t\t\t\t\t\t\t\t// if the animated model is pre rotated, we'll have to apply the pre rotations to every\n\t\t\t\t\t\t\t\t\t// animation value as well\n\t\t\t\t\t\t\t\t\tif ( 'PreRotation' in rawModel ) node.preRotation = rawModel.PreRotation.value;\n\t\t\t\t\t\t\t\t\tif ( 'PostRotation' in rawModel ) node.postRotation = rawModel.PostRotation.value;\n\n\t\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] ) layerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t} else if ( curveNode.curves.morph !== undefined ) {\n\n\t\t\t\t\t\t\tif ( layerCurveNodes[ i ] === undefined ) {\n\n\t\t\t\t\t\t\t\tconst deformerID = connections.get( child.ID ).parents.filter( function ( parent ) {\n\n\t\t\t\t\t\t\t\t\treturn parent.relationship !== undefined;\n\n\t\t\t\t\t\t\t\t} )[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst morpherID = connections.get( deformerID ).parents[ 0 ].ID;\n\t\t\t\t\t\t\t\tconst geoID = connections.get( morpherID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\t// assuming geometry is not used in more than one model\n\t\t\t\t\t\t\t\tconst modelID = connections.get( geoID ).parents[ 0 ].ID;\n\n\t\t\t\t\t\t\t\tconst rawModel = fbxTree.Objects.Model[ modelID ];\n\n\t\t\t\t\t\t\t\tconst node = {\n\n\t\t\t\t\t\t\t\t\tmodelName: rawModel.attrName ? PropertyBinding.sanitizeNodeName( rawModel.attrName ) : '',\n\t\t\t\t\t\t\t\t\tmorphName: fbxTree.Objects.Deformer[ deformerID ].attrName,\n\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tlayerCurveNodes[ i ] = node;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlayerCurveNodes[ i ][ curveNode.attr ] = curveNode;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\tlayersMap.set( parseInt( nodeID ), layerCurveNodes );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn layersMap;\n\n\t}\n\n\t// parse nodes in FBXTree.Objects.AnimationStack. These are the top level node in the animation\n\t// hierarchy. Each Stack node will be used to create a AnimationClip\n\tparseAnimStacks( layersMap ) {\n\n\t\tconst rawStacks = fbxTree.Objects.AnimationStack;\n\n\t\t// connect the stacks (clips) up to the layers\n\t\tconst rawClips = {};\n\n\t\tfor ( const nodeID in rawStacks ) {\n\n\t\t\tconst children = connections.get( parseInt( nodeID ) ).children;\n\n\t\t\tif ( children.length > 1 ) {\n\n\t\t\t\t// it seems like stacks will always be associated with a single layer. But just in case there are files\n\t\t\t\t// where there are multiple layers per stack, we'll display a warning\n\t\t\t\tconsole.warn( 'THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.' );\n\n\t\t\t}\n\n\t\t\tconst layer = layersMap.get( children[ 0 ].ID );\n\n\t\t\trawClips[ nodeID ] = {\n\n\t\t\t\tname: rawStacks[ nodeID ].attrName,\n\t\t\t\tlayer: layer,\n\n\t\t\t};\n\n\t\t}\n\n\t\treturn rawClips;\n\n\t}\n\n\taddClip( rawClip ) {\n\n\t\tlet tracks = [];\n\n\t\tconst scope = this;\n\t\trawClip.layer.forEach( function ( rawTracks ) {\n\n\t\t\ttracks = tracks.concat( scope.generateTracks( rawTracks ) );\n\n\t\t} );\n\n\t\treturn new AnimationClip( rawClip.name, - 1, tracks );\n\n\t}\n\n\tgenerateTracks( rawTracks ) {\n\n\t\tconst tracks = [];\n\n\t\tlet initialPosition = new Vector3();\n\t\tlet initialScale = new Vector3();\n\n\t\tif ( rawTracks.transform ) rawTracks.transform.decompose( initialPosition, new Quaternion(), initialScale );\n\n\t\tinitialPosition = initialPosition.toArray();\n\t\tinitialScale = initialScale.toArray();\n\n\t\tif ( rawTracks.T !== undefined && Object.keys( rawTracks.T.curves ).length > 0 ) {\n\n\t\t\tconst positionTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.T.curves, initialPosition, 'position' );\n\t\t\tif ( positionTrack !== undefined ) tracks.push( positionTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.R !== undefined && Object.keys( rawTracks.R.curves ).length > 0 ) {\n\n\t\t\tconst rotationTrack = this.generateRotationTrack( rawTracks.modelName, rawTracks.R.curves, rawTracks.preRotation, rawTracks.postRotation, rawTracks.eulerOrder );\n\t\t\tif ( rotationTrack !== undefined ) tracks.push( rotationTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.S !== undefined && Object.keys( rawTracks.S.curves ).length > 0 ) {\n\n\t\t\tconst scaleTrack = this.generateVectorTrack( rawTracks.modelName, rawTracks.S.curves, initialScale, 'scale' );\n\t\t\tif ( scaleTrack !== undefined ) tracks.push( scaleTrack );\n\n\t\t}\n\n\t\tif ( rawTracks.DeformPercent !== undefined ) {\n\n\t\t\tconst morphTrack = this.generateMorphTrack( rawTracks );\n\t\t\tif ( morphTrack !== undefined ) tracks.push( morphTrack );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\tgenerateVectorTrack( modelName, curves, initialValue, type ) {\n\n\t\tconst times = this.getTimesForAllAxes( curves );\n\t\tconst values = this.getKeyframeTrackValues( times, curves, initialValue );\n\n\t\treturn new VectorKeyframeTrack( modelName + '.' + type, times, values );\n\n\t}\n\n\tgenerateRotationTrack( modelName, curves, preRotation, postRotation, eulerOrder ) {\n\n\t\tlet times;\n\t\tlet values;\n\n\t\tif ( curves.x !== undefined && curves.y !== undefined && curves.z !== undefined ) {\n\n\t\t\tconst result = this.interpolateRotations( curves.x, curves.y, curves.z, eulerOrder );\n\n\t\t\ttimes = result[ 0 ];\n\t\t\tvalues = result[ 1 ];\n\n\t\t}\n\n\t\tif ( preRotation !== undefined ) {\n\n\t\t\tpreRotation = preRotation.map( MathUtils.degToRad );\n\t\t\tpreRotation.push( eulerOrder );\n\n\t\t\tpreRotation = new Euler().fromArray( preRotation );\n\t\t\tpreRotation = new Quaternion().setFromEuler( preRotation );\n\n\t\t}\n\n\t\tif ( postRotation !== undefined ) {\n\n\t\t\tpostRotation = postRotation.map( MathUtils.degToRad );\n\t\t\tpostRotation.push( eulerOrder );\n\n\t\t\tpostRotation = new Euler().fromArray( postRotation );\n\t\t\tpostRotation = new Quaternion().setFromEuler( postRotation ).invert();\n\n\t\t}\n\n\t\tconst quaternion = new Quaternion();\n\t\tconst euler = new Euler();\n\n\t\tconst quaternionValues = [];\n\n\t\tif ( ! values || ! times ) return new QuaternionKeyframeTrack( modelName + '.quaternion', [], [] );\n\n\t\tfor ( let i = 0; i < values.length; i += 3 ) {\n\n\t\t\teuler.set( values[ i ], values[ i + 1 ], values[ i + 2 ], eulerOrder );\n\t\t\tquaternion.setFromEuler( euler );\n\n\t\t\tif ( preRotation !== undefined ) quaternion.premultiply( preRotation );\n\t\t\tif ( postRotation !== undefined ) quaternion.multiply( postRotation );\n\n\t\t\t// Check unroll\n\t\t\tif ( i > 2 ) {\n\n\t\t\t\tconst prevQuat = new Quaternion().fromArray(\n\t\t\t\t\tquaternionValues,\n\t\t\t\t\t( ( i - 3 ) / 3 ) * 4\n\t\t\t\t);\n\n\t\t\t\tif ( prevQuat.dot( quaternion ) < 0 ) {\n\n\t\t\t\t\tquaternion.set( - quaternion.x, - quaternion.y, - quaternion.z, - quaternion.w );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tquaternion.toArray( quaternionValues, ( i / 3 ) * 4 );\n\n\t\t}\n\n\t\treturn new QuaternionKeyframeTrack( modelName + '.quaternion', times, quaternionValues );\n\n\t}\n\n\tgenerateMorphTrack( rawTracks ) {\n\n\t\tconst curves = rawTracks.DeformPercent.curves.morph;\n\t\tconst values = curves.values.map( function ( val ) {\n\n\t\t\treturn val / 100;\n\n\t\t} );\n\n\t\tconst morphNum = sceneGraph.getObjectByName( rawTracks.modelName ).morphTargetDictionary[ rawTracks.morphName ];\n\n\t\treturn new NumberKeyframeTrack( rawTracks.modelName + '.morphTargetInfluences[' + morphNum + ']', curves.times, values );\n\n\t}\n\n\t// For all animated objects, times are defined separately for each axis\n\t// Here we'll combine the times into one sorted array without duplicates\n\tgetTimesForAllAxes( curves ) {\n\n\t\tlet times = [];\n\n\t\t// first join together the times for each axis, if defined\n\t\tif ( curves.x !== undefined ) times = times.concat( curves.x.times );\n\t\tif ( curves.y !== undefined ) times = times.concat( curves.y.times );\n\t\tif ( curves.z !== undefined ) times = times.concat( curves.z.times );\n\n\t\t// then sort them\n\t\ttimes = times.sort( function ( a, b ) {\n\n\t\t\treturn a - b;\n\n\t\t} );\n\n\t\t// and remove duplicates\n\t\tif ( times.length > 1 ) {\n\n\t\t\tlet targetIndex = 1;\n\t\t\tlet lastValue = times[ 0 ];\n\t\t\tfor ( let i = 1; i < times.length; i ++ ) {\n\n\t\t\t\tconst currentValue = times[ i ];\n\t\t\t\tif ( currentValue !== lastValue ) {\n\n\t\t\t\t\ttimes[ targetIndex ] = currentValue;\n\t\t\t\t\tlastValue = currentValue;\n\t\t\t\t\ttargetIndex ++;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttimes = times.slice( 0, targetIndex );\n\n\t\t}\n\n\t\treturn times;\n\n\t}\n\n\tgetKeyframeTrackValues( times, curves, initialValue ) {\n\n\t\tconst prevValue = initialValue;\n\n\t\tconst values = [];\n\n\t\tlet xIndex = - 1;\n\t\tlet yIndex = - 1;\n\t\tlet zIndex = - 1;\n\n\t\ttimes.forEach( function ( time ) {\n\n\t\t\tif ( curves.x ) xIndex = curves.x.times.indexOf( time );\n\t\t\tif ( curves.y ) yIndex = curves.y.times.indexOf( time );\n\t\t\tif ( curves.z ) zIndex = curves.z.times.indexOf( time );\n\n\t\t\t// if there is an x value defined for this frame, use that\n\t\t\tif ( xIndex !== - 1 ) {\n\n\t\t\t\tconst xValue = curves.x.values[ xIndex ];\n\t\t\t\tvalues.push( xValue );\n\t\t\t\tprevValue[ 0 ] = xValue;\n\n\t\t\t} else {\n\n\t\t\t\t// otherwise use the x value from the previous frame\n\t\t\t\tvalues.push( prevValue[ 0 ] );\n\n\t\t\t}\n\n\t\t\tif ( yIndex !== - 1 ) {\n\n\t\t\t\tconst yValue = curves.y.values[ yIndex ];\n\t\t\t\tvalues.push( yValue );\n\t\t\t\tprevValue[ 1 ] = yValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 1 ] );\n\n\t\t\t}\n\n\t\t\tif ( zIndex !== - 1 ) {\n\n\t\t\t\tconst zValue = curves.z.values[ zIndex ];\n\t\t\t\tvalues.push( zValue );\n\t\t\t\tprevValue[ 2 ] = zValue;\n\n\t\t\t} else {\n\n\t\t\t\tvalues.push( prevValue[ 2 ] );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn values;\n\n\t}\n\n\t// Rotations are defined as Euler angles which can have values  of any size\n\t// These will be converted to quaternions which don't support values greater than\n\t// PI, so we'll interpolate large rotations\n\tinterpolateRotations( curvex, curvey, curvez, eulerOrder ) {\n\n\t\tconst times = [];\n\t\tconst values = [];\n\n\t\t// Add first frame\n\t\ttimes.push( curvex.times[ 0 ] );\n\t\tvalues.push( MathUtils.degToRad( curvex.values[ 0 ] ) );\n\t\tvalues.push( MathUtils.degToRad( curvey.values[ 0 ] ) );\n\t\tvalues.push( MathUtils.degToRad( curvez.values[ 0 ] ) );\n\n\t\tfor ( let i = 1; i < curvex.values.length; i ++ ) {\n\n\t\t\tconst initialValue = [\n\t\t\t\tcurvex.values[ i - 1 ],\n\t\t\t\tcurvey.values[ i - 1 ],\n\t\t\t\tcurvez.values[ i - 1 ],\n\t\t\t];\n\n\t\t\tif ( isNaN( initialValue[ 0 ] ) || isNaN( initialValue[ 1 ] ) || isNaN( initialValue[ 2 ] ) ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst initialValueRad = initialValue.map( MathUtils.degToRad );\n\n\t\t\tconst currentValue = [\n\t\t\t\tcurvex.values[ i ],\n\t\t\t\tcurvey.values[ i ],\n\t\t\t\tcurvez.values[ i ],\n\t\t\t];\n\n\t\t\tif ( isNaN( currentValue[ 0 ] ) || isNaN( currentValue[ 1 ] ) || isNaN( currentValue[ 2 ] ) ) {\n\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tconst currentValueRad = currentValue.map( MathUtils.degToRad );\n\n\t\t\tconst valuesSpan = [\n\t\t\t\tcurrentValue[ 0 ] - initialValue[ 0 ],\n\t\t\t\tcurrentValue[ 1 ] - initialValue[ 1 ],\n\t\t\t\tcurrentValue[ 2 ] - initialValue[ 2 ],\n\t\t\t];\n\n\t\t\tconst absoluteSpan = [\n\t\t\t\tMath.abs( valuesSpan[ 0 ] ),\n\t\t\t\tMath.abs( valuesSpan[ 1 ] ),\n\t\t\t\tMath.abs( valuesSpan[ 2 ] ),\n\t\t\t];\n\n\t\t\tif ( absoluteSpan[ 0 ] >= 180 || absoluteSpan[ 1 ] >= 180 || absoluteSpan[ 2 ] >= 180 ) {\n\n\t\t\t\tconst maxAbsSpan = Math.max( ...absoluteSpan );\n\n\t\t\t\tconst numSubIntervals = maxAbsSpan / 180;\n\n\t\t\t\tconst E1 = new Euler( ...initialValueRad, eulerOrder );\n\t\t\t\tconst E2 = new Euler( ...currentValueRad, eulerOrder );\n\n\t\t\t\tconst Q1 = new Quaternion().setFromEuler( E1 );\n\t\t\t\tconst Q2 = new Quaternion().setFromEuler( E2 );\n\n\t\t\t\t// Check unroll\n\t\t\t\tif ( Q1.dot( Q2 ) ) {\n\n\t\t\t\t\tQ2.set( - Q2.x, - Q2.y, - Q2.z, - Q2.w );\n\n\t\t\t\t}\n\n\t\t\t\t// Interpolate\n\t\t\t\tconst initialTime = curvex.times[ i - 1 ];\n\t\t\t\tconst timeSpan = curvex.times[ i ] - initialTime;\n\n\t\t\t\tconst Q = new Quaternion();\n\t\t\t\tconst E = new Euler();\n\t\t\t\tfor ( let t = 0; t < 1; t += 1 / numSubIntervals ) {\n\n\t\t\t\t\tQ.copy( Q1.clone().slerp( Q2.clone(), t ) );\n\n\t\t\t\t\ttimes.push( initialTime + t * timeSpan );\n\t\t\t\t\tE.setFromQuaternion( Q, eulerOrder );\n\n\t\t\t\t\tvalues.push( E.x );\n\t\t\t\t\tvalues.push( E.y );\n\t\t\t\t\tvalues.push( E.z );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\ttimes.push( curvex.times[ i ] );\n\t\t\t\tvalues.push( MathUtils.degToRad( curvex.values[ i ] ) );\n\t\t\t\tvalues.push( MathUtils.degToRad( curvey.values[ i ] ) );\n\t\t\t\tvalues.push( MathUtils.degToRad( curvez.values[ i ] ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn [ times, values ];\n\n\t}\n\n}\n\n// parse an FBX file in ASCII format\nclass TextParser {\n\n\tgetPrevNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 2 ];\n\n\t}\n\n\tgetCurrentNode() {\n\n\t\treturn this.nodeStack[ this.currentIndent - 1 ];\n\n\t}\n\n\tgetCurrentProp() {\n\n\t\treturn this.currentProp;\n\n\t}\n\n\tpushStack( node ) {\n\n\t\tthis.nodeStack.push( node );\n\t\tthis.currentIndent += 1;\n\n\t}\n\n\tpopStack() {\n\n\t\tthis.nodeStack.pop();\n\t\tthis.currentIndent -= 1;\n\n\t}\n\n\tsetCurrentProp( val, name ) {\n\n\t\tthis.currentProp = val;\n\t\tthis.currentPropName = name;\n\n\t}\n\n\tparse( text ) {\n\n\t\tthis.currentIndent = 0;\n\n\t\tthis.allNodes = new FBXTree();\n\t\tthis.nodeStack = [];\n\t\tthis.currentProp = [];\n\t\tthis.currentPropName = '';\n\n\t\tconst scope = this;\n\n\t\tconst split = text.split( /[\\r\\n]+/ );\n\n\t\tsplit.forEach( function ( line, i ) {\n\n\t\t\tconst matchComment = line.match( /^[\\s\\t]*;/ );\n\t\t\tconst matchEmpty = line.match( /^[\\s\\t]*$/ );\n\n\t\t\tif ( matchComment || matchEmpty ) return;\n\n\t\t\tconst matchBeginning = line.match( '^\\\\t{' + scope.currentIndent + '}(\\\\w+):(.*){', '' );\n\t\t\tconst matchProperty = line.match( '^\\\\t{' + ( scope.currentIndent ) + '}(\\\\w+):[\\\\s\\\\t\\\\r\\\\n](.*)' );\n\t\t\tconst matchEnd = line.match( '^\\\\t{' + ( scope.currentIndent - 1 ) + '}}' );\n\n\t\t\tif ( matchBeginning ) {\n\n\t\t\t\tscope.parseNodeBegin( line, matchBeginning );\n\n\t\t\t} else if ( matchProperty ) {\n\n\t\t\t\tscope.parseNodeProperty( line, matchProperty, split[ ++ i ] );\n\n\t\t\t} else if ( matchEnd ) {\n\n\t\t\t\tscope.popStack();\n\n\t\t\t} else if ( line.match( /^[^\\s\\t}]/ ) ) {\n\n\t\t\t\t// large arrays are split over multiple lines terminated with a ',' character\n\t\t\t\t// if this is encountered the line needs to be joined to the previous line\n\t\t\t\tscope.parseNodePropertyContinued( line );\n\n\t\t\t}\n\n\t\t} );\n\n\t\treturn this.allNodes;\n\n\t}\n\n\tparseNodeBegin( line, property ) {\n\n\t\tconst nodeName = property[ 1 ].trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\tconst nodeAttrs = property[ 2 ].split( ',' ).map( function ( attr ) {\n\n\t\t\treturn attr.trim().replace( /^\"/, '' ).replace( /\"$/, '' );\n\n\t\t} );\n\n\t\tconst node = { name: nodeName };\n\t\tconst attrs = this.parseNodeAttr( nodeAttrs );\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\t// a top node\n\t\tif ( this.currentIndent === 0 ) {\n\n\t\t\tthis.allNodes.add( nodeName, node );\n\n\t\t} else { // a subnode\n\n\t\t\t// if the subnode already exists, append it\n\t\t\tif ( nodeName in currentNode ) {\n\n\t\t\t\t// special case Pose needs PoseNodes as an array\n\t\t\t\tif ( nodeName === 'PoseNode' ) {\n\n\t\t\t\t\tcurrentNode.PoseNode.push( node );\n\n\t\t\t\t} else if ( currentNode[ nodeName ].id !== undefined ) {\n\n\t\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\t\tcurrentNode[ nodeName ][ currentNode[ nodeName ].id ] = currentNode[ nodeName ];\n\n\t\t\t\t}\n\n\t\t\t\tif ( attrs.id !== '' ) currentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( typeof attrs.id === 'number' ) {\n\n\t\t\t\tcurrentNode[ nodeName ] = {};\n\t\t\t\tcurrentNode[ nodeName ][ attrs.id ] = node;\n\n\t\t\t} else if ( nodeName !== 'Properties70' ) {\n\n\t\t\t\tif ( nodeName === 'PoseNode' )\tcurrentNode[ nodeName ] = [ node ];\n\t\t\t\telse currentNode[ nodeName ] = node;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( typeof attrs.id === 'number' ) node.id = attrs.id;\n\t\tif ( attrs.name !== '' ) node.attrName = attrs.name;\n\t\tif ( attrs.type !== '' ) node.attrType = attrs.type;\n\n\t\tthis.pushStack( node );\n\n\t}\n\n\tparseNodeAttr( attrs ) {\n\n\t\tlet id = attrs[ 0 ];\n\n\t\tif ( attrs[ 0 ] !== '' ) {\n\n\t\t\tid = parseInt( attrs[ 0 ] );\n\n\t\t\tif ( isNaN( id ) ) {\n\n\t\t\t\tid = attrs[ 0 ];\n\n\t\t\t}\n\n\t\t}\n\n\t\tlet name = '', type = '';\n\n\t\tif ( attrs.length > 1 ) {\n\n\t\t\tname = attrs[ 1 ].replace( /^(\\w+)::/, '' );\n\t\t\ttype = attrs[ 2 ];\n\n\t\t}\n\n\t\treturn { id: id, name: name, type: type };\n\n\t}\n\n\tparseNodeProperty( line, property, contentLine ) {\n\n\t\tlet propName = property[ 1 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\t\tlet propValue = property[ 2 ].replace( /^\"/, '' ).replace( /\"$/, '' ).trim();\n\n\t\t// for special case: base64 image data follows \"Content: ,\" line\n\t\t//\tContent: ,\n\t\t//\t \"/9j/4RDaRXhpZgAATU0A...\"\n\t\tif ( propName === 'Content' && propValue === ',' ) {\n\n\t\t\tpropValue = contentLine.replace( /\"/g, '' ).replace( /,$/, '' ).trim();\n\n\t\t}\n\n\t\tconst currentNode = this.getCurrentNode();\n\t\tconst parentName = currentNode.name;\n\n\t\tif ( parentName === 'Properties70' ) {\n\n\t\t\tthis.parseNodeSpecialProperty( line, propName, propValue );\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Connections\n\t\tif ( propName === 'C' ) {\n\n\t\t\tconst connProps = propValue.split( ',' ).slice( 1 );\n\t\t\tconst from = parseInt( connProps[ 0 ] );\n\t\t\tconst to = parseInt( connProps[ 1 ] );\n\n\t\t\tlet rest = propValue.split( ',' ).slice( 3 );\n\n\t\t\trest = rest.map( function ( elem ) {\n\n\t\t\t\treturn elem.trim().replace( /^\"/, '' );\n\n\t\t\t} );\n\n\t\t\tpropName = 'connections';\n\t\t\tpropValue = [ from, to ];\n\t\t\tappend( propValue, rest );\n\n\t\t\tif ( currentNode[ propName ] === undefined ) {\n\n\t\t\t\tcurrentNode[ propName ] = [];\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Node\n\t\tif ( propName === 'Node' ) currentNode.id = propValue;\n\n\t\t// connections\n\t\tif ( propName in currentNode && Array.isArray( currentNode[ propName ] ) ) {\n\n\t\t\tcurrentNode[ propName ].push( propValue );\n\n\t\t} else {\n\n\t\t\tif ( propName !== 'a' ) currentNode[ propName ] = propValue;\n\t\t\telse currentNode.a = propValue;\n\n\t\t}\n\n\t\tthis.setCurrentProp( currentNode, propName );\n\n\t\t// convert string to array, unless it ends in ',' in which case more will be added to it\n\t\tif ( propName === 'a' && propValue.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( propValue );\n\n\t\t}\n\n\t}\n\n\tparseNodePropertyContinued( line ) {\n\n\t\tconst currentNode = this.getCurrentNode();\n\n\t\tcurrentNode.a += line;\n\n\t\t// if the line doesn't end in ',' we have reached the end of the property value\n\t\t// so convert the string to an array\n\t\tif ( line.slice( - 1 ) !== ',' ) {\n\n\t\t\tcurrentNode.a = parseNumberArray( currentNode.a );\n\n\t\t}\n\n\t}\n\n\t// parse \"Property70\"\n\tparseNodeSpecialProperty( line, propName, propValue ) {\n\n\t\t// split this\n\t\t// P: \"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\",1,1,1\n\t\t// into array like below\n\t\t// [\"Lcl Scaling\", \"Lcl Scaling\", \"\", \"A\", \"1,1,1\" ]\n\t\tconst props = propValue.split( '\",' ).map( function ( prop ) {\n\n\t\t\treturn prop.trim().replace( /^\\\"/, '' ).replace( /\\s/, '_' );\n\n\t\t} );\n\n\t\tconst innerPropName = props[ 0 ];\n\t\tconst innerPropType1 = props[ 1 ];\n\t\tconst innerPropType2 = props[ 2 ];\n\t\tconst innerPropFlag = props[ 3 ];\n\t\tlet innerPropValue = props[ 4 ];\n\n\t\t// cast values where needed, otherwise leave as strings\n\t\tswitch ( innerPropType1 ) {\n\n\t\t\tcase 'int':\n\t\t\tcase 'enum':\n\t\t\tcase 'bool':\n\t\t\tcase 'ULongLong':\n\t\t\tcase 'double':\n\t\t\tcase 'Number':\n\t\t\tcase 'FieldOfView':\n\t\t\t\tinnerPropValue = parseFloat( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t\tcase 'Color':\n\t\t\tcase 'ColorRGB':\n\t\t\tcase 'Vector3D':\n\t\t\tcase 'Lcl_Translation':\n\t\t\tcase 'Lcl_Rotation':\n\t\t\tcase 'Lcl_Scaling':\n\t\t\t\tinnerPropValue = parseNumberArray( innerPropValue );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\t// CAUTION: these props must append to parent's parent\n\t\tthis.getPrevNode()[ innerPropName ] = {\n\n\t\t\t'type': innerPropType1,\n\t\t\t'type2': innerPropType2,\n\t\t\t'flag': innerPropFlag,\n\t\t\t'value': innerPropValue\n\n\t\t};\n\n\t\tthis.setCurrentProp( this.getPrevNode(), innerPropName );\n\n\t}\n\n}\n\n// Parse an FBX file in Binary format\nclass BinaryParser {\n\n\tparse( buffer ) {\n\n\t\tconst reader = new BinaryReader( buffer );\n\t\treader.skip( 23 ); // skip magic 23 bytes\n\n\t\tconst version = reader.getUint32();\n\n\t\tif ( version < 6400 ) {\n\n\t\t\tthrow new Error( 'THREE.FBXLoader: FBX version not supported, FileVersion: ' + version );\n\n\t\t}\n\n\t\tconst allNodes = new FBXTree();\n\n\t\twhile ( ! this.endOfContent( reader ) ) {\n\n\t\t\tconst node = this.parseNode( reader, version );\n\t\t\tif ( node !== null ) allNodes.add( node.name, node );\n\n\t\t}\n\n\t\treturn allNodes;\n\n\t}\n\n\t// Check if reader has reached the end of content.\n\tendOfContent( reader ) {\n\n\t\t// footer size: 160bytes + 16-byte alignment padding\n\t\t// - 16bytes: magic\n\t\t// - padding til 16-byte alignment (at least 1byte?)\n\t\t//\t(seems like some exporters embed fixed 15 or 16bytes?)\n\t\t// - 4bytes: magic\n\t\t// - 4bytes: version\n\t\t// - 120bytes: zero\n\t\t// - 16bytes: magic\n\t\tif ( reader.size() % 16 === 0 ) {\n\n\t\t\treturn ( ( reader.getOffset() + 160 + 16 ) & ~ 0xf ) >= reader.size();\n\n\t\t} else {\n\n\t\t\treturn reader.getOffset() + 160 + 16 >= reader.size();\n\n\t\t}\n\n\t}\n\n\t// recursively parse nodes until the end of the file is reached\n\tparseNode( reader, version ) {\n\n\t\tconst node = {};\n\n\t\t// The first three data sizes depends on version.\n\t\tconst endOffset = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\t\tconst numProperties = ( version >= 7500 ) ? reader.getUint64() : reader.getUint32();\n\n\t\t( version >= 7500 ) ? reader.getUint64() : reader.getUint32(); // the returned propertyListLen is not used\n\n\t\tconst nameLen = reader.getUint8();\n\t\tconst name = reader.getString( nameLen );\n\n\t\t// Regards this node as NULL-record if endOffset is zero\n\t\tif ( endOffset === 0 ) return null;\n\n\t\tconst propertyList = [];\n\n\t\tfor ( let i = 0; i < numProperties; i ++ ) {\n\n\t\t\tpropertyList.push( this.parseProperty( reader ) );\n\n\t\t}\n\n\t\t// Regards the first three elements in propertyList as id, attrName, and attrType\n\t\tconst id = propertyList.length > 0 ? propertyList[ 0 ] : '';\n\t\tconst attrName = propertyList.length > 1 ? propertyList[ 1 ] : '';\n\t\tconst attrType = propertyList.length > 2 ? propertyList[ 2 ] : '';\n\n\t\t// check if this node represents just a single property\n\t\t// like (name, 0) set or (name2, [0, 1, 2]) set of {name: 0, name2: [0, 1, 2]}\n\t\tnode.singleProperty = ( numProperties === 1 && reader.getOffset() === endOffset ) ? true : false;\n\n\t\twhile ( endOffset > reader.getOffset() ) {\n\n\t\t\tconst subNode = this.parseNode( reader, version );\n\n\t\t\tif ( subNode !== null ) this.parseSubNode( name, node, subNode );\n\n\t\t}\n\n\t\tnode.propertyList = propertyList; // raw property list used by parent\n\n\t\tif ( typeof id === 'number' ) node.id = id;\n\t\tif ( attrName !== '' ) node.attrName = attrName;\n\t\tif ( attrType !== '' ) node.attrType = attrType;\n\t\tif ( name !== '' ) node.name = name;\n\n\t\treturn node;\n\n\t}\n\n\tparseSubNode( name, node, subNode ) {\n\n\t\t// special case: child node is single property\n\t\tif ( subNode.singleProperty === true ) {\n\n\t\t\tconst value = subNode.propertyList[ 0 ];\n\n\t\t\tif ( Array.isArray( value ) ) {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t\tsubNode.a = value;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = value;\n\n\t\t\t}\n\n\t\t} else if ( name === 'Connections' && subNode.name === 'C' ) {\n\n\t\t\tconst array = [];\n\n\t\t\tsubNode.propertyList.forEach( function ( property, i ) {\n\n\t\t\t\t// first Connection is FBX type (OO, OP, etc.). We'll discard these\n\t\t\t\tif ( i !== 0 ) array.push( property );\n\n\t\t\t} );\n\n\t\t\tif ( node.connections === undefined ) {\n\n\t\t\t\tnode.connections = [];\n\n\t\t\t}\n\n\t\t\tnode.connections.push( array );\n\n\t\t} else if ( subNode.name === 'Properties70' ) {\n\n\t\t\tconst keys = Object.keys( subNode );\n\n\t\t\tkeys.forEach( function ( key ) {\n\n\t\t\t\tnode[ key ] = subNode[ key ];\n\n\t\t\t} );\n\n\t\t} else if ( name === 'Properties70' && subNode.name === 'P' ) {\n\n\t\t\tlet innerPropName = subNode.propertyList[ 0 ];\n\t\t\tlet innerPropType1 = subNode.propertyList[ 1 ];\n\t\t\tconst innerPropType2 = subNode.propertyList[ 2 ];\n\t\t\tconst innerPropFlag = subNode.propertyList[ 3 ];\n\t\t\tlet innerPropValue;\n\n\t\t\tif ( innerPropName.indexOf( 'Lcl ' ) === 0 ) innerPropName = innerPropName.replace( 'Lcl ', 'Lcl_' );\n\t\t\tif ( innerPropType1.indexOf( 'Lcl ' ) === 0 ) innerPropType1 = innerPropType1.replace( 'Lcl ', 'Lcl_' );\n\n\t\t\tif ( innerPropType1 === 'Color' || innerPropType1 === 'ColorRGB' || innerPropType1 === 'Vector' || innerPropType1 === 'Vector3D' || innerPropType1.indexOf( 'Lcl_' ) === 0 ) {\n\n\t\t\t\tinnerPropValue = [\n\t\t\t\t\tsubNode.propertyList[ 4 ],\n\t\t\t\t\tsubNode.propertyList[ 5 ],\n\t\t\t\t\tsubNode.propertyList[ 6 ]\n\t\t\t\t];\n\n\t\t\t} else {\n\n\t\t\t\tinnerPropValue = subNode.propertyList[ 4 ];\n\n\t\t\t}\n\n\t\t\t// this will be copied to parent, see above\n\t\t\tnode[ innerPropName ] = {\n\n\t\t\t\t'type': innerPropType1,\n\t\t\t\t'type2': innerPropType2,\n\t\t\t\t'flag': innerPropFlag,\n\t\t\t\t'value': innerPropValue\n\n\t\t\t};\n\n\t\t} else if ( node[ subNode.name ] === undefined ) {\n\n\t\t\tif ( typeof subNode.id === 'number' ) {\n\n\t\t\t\tnode[ subNode.name ] = {};\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t} else {\n\n\t\t\t\tnode[ subNode.name ] = subNode;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tif ( subNode.name === 'PoseNode' ) {\n\n\t\t\t\tif ( ! Array.isArray( node[ subNode.name ] ) ) {\n\n\t\t\t\t\tnode[ subNode.name ] = [ node[ subNode.name ] ];\n\n\t\t\t\t}\n\n\t\t\t\tnode[ subNode.name ].push( subNode );\n\n\t\t\t} else if ( node[ subNode.name ][ subNode.id ] === undefined ) {\n\n\t\t\t\tnode[ subNode.name ][ subNode.id ] = subNode;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tparseProperty( reader ) {\n\n\t\tconst type = reader.getString( 1 );\n\t\tlet length;\n\n\t\tswitch ( type ) {\n\n\t\t\tcase 'C':\n\t\t\t\treturn reader.getBoolean();\n\n\t\t\tcase 'D':\n\t\t\t\treturn reader.getFloat64();\n\n\t\t\tcase 'F':\n\t\t\t\treturn reader.getFloat32();\n\n\t\t\tcase 'I':\n\t\t\t\treturn reader.getInt32();\n\n\t\t\tcase 'L':\n\t\t\t\treturn reader.getInt64();\n\n\t\t\tcase 'R':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getArrayBuffer( length );\n\n\t\t\tcase 'S':\n\t\t\t\tlength = reader.getUint32();\n\t\t\t\treturn reader.getString( length );\n\n\t\t\tcase 'Y':\n\t\t\t\treturn reader.getInt16();\n\n\t\t\tcase 'b':\n\t\t\tcase 'c':\n\t\t\tcase 'd':\n\t\t\tcase 'f':\n\t\t\tcase 'i':\n\t\t\tcase 'l':\n\n\t\t\t\tconst arrayLength = reader.getUint32();\n\t\t\t\tconst encoding = reader.getUint32(); // 0: non-compressed, 1: compressed\n\t\t\t\tconst compressedLength = reader.getUint32();\n\n\t\t\t\tif ( encoding === 0 ) {\n\n\t\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tcase 'c':\n\t\t\t\t\t\t\treturn reader.getBooleanArray( arrayLength );\n\n\t\t\t\t\t\tcase 'd':\n\t\t\t\t\t\t\treturn reader.getFloat64Array( arrayLength );\n\n\t\t\t\t\t\tcase 'f':\n\t\t\t\t\t\t\treturn reader.getFloat32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\treturn reader.getInt32Array( arrayLength );\n\n\t\t\t\t\t\tcase 'l':\n\t\t\t\t\t\t\treturn reader.getInt64Array( arrayLength );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tconst data = fflate.unzlibSync( new Uint8Array( reader.getArrayBuffer( compressedLength ) ) );\n\t\t\t\tconst reader2 = new BinaryReader( data.buffer );\n\n\t\t\t\tswitch ( type ) {\n\n\t\t\t\t\tcase 'b':\n\t\t\t\t\tcase 'c':\n\t\t\t\t\t\treturn reader2.getBooleanArray( arrayLength );\n\n\t\t\t\t\tcase 'd':\n\t\t\t\t\t\treturn reader2.getFloat64Array( arrayLength );\n\n\t\t\t\t\tcase 'f':\n\t\t\t\t\t\treturn reader2.getFloat32Array( arrayLength );\n\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\treturn reader2.getInt32Array( arrayLength );\n\n\t\t\t\t\tcase 'l':\n\t\t\t\t\t\treturn reader2.getInt64Array( arrayLength );\n\n\t\t\t\t}\n\n\t\t\t\tbreak; // cannot happen but is required by the DeepScan\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.FBXLoader: Unknown property type ' + type );\n\n\t\t}\n\n\t}\n\n}\n\nclass BinaryReader {\n\n\tconstructor( buffer, littleEndian ) {\n\n\t\tthis.dv = new DataView( buffer );\n\t\tthis.offset = 0;\n\t\tthis.littleEndian = ( littleEndian !== undefined ) ? littleEndian : true;\n\t\tthis._textDecoder = new TextDecoder();\n\n\t}\n\n\tgetOffset() {\n\n\t\treturn this.offset;\n\n\t}\n\n\tsize() {\n\n\t\treturn this.dv.buffer.byteLength;\n\n\t}\n\n\tskip( length ) {\n\n\t\tthis.offset += length;\n\n\t}\n\n\t// seems like true/false representation depends on exporter.\n\t// true: 1 or 'Y'(=0x59), false: 0 or 'T'(=0x54)\n\t// then sees LSB.\n\tgetBoolean() {\n\n\t\treturn ( this.getUint8() & 1 ) === 1;\n\n\t}\n\n\tgetBooleanArray( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getBoolean() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint8() {\n\n\t\tconst value = this.dv.getUint8( this.offset );\n\t\tthis.offset += 1;\n\t\treturn value;\n\n\t}\n\n\tgetInt16() {\n\n\t\tconst value = this.dv.getInt16( this.offset, this.littleEndian );\n\t\tthis.offset += 2;\n\t\treturn value;\n\n\t}\n\n\tgetInt32() {\n\n\t\tconst value = this.dv.getInt32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetInt32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetUint32() {\n\n\t\tconst value = this.dv.getUint32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\t// JavaScript doesn't support 64-bit integer so calculate this here\n\t// 1 << 32 will return 1 so using multiply operation instead here.\n\t// There's a possibility that this method returns wrong value if the value\n\t// is out of the range between Number.MAX_SAFE_INTEGER and Number.MIN_SAFE_INTEGER.\n\t// TODO: safely handle 64-bit integer\n\tgetInt64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\t// calculate negative value\n\t\tif ( high & 0x80000000 ) {\n\n\t\t\thigh = ~ high & 0xFFFFFFFF;\n\t\t\tlow = ~ low & 0xFFFFFFFF;\n\n\t\t\tif ( low === 0xFFFFFFFF ) high = ( high + 1 ) & 0xFFFFFFFF;\n\n\t\t\tlow = ( low + 1 ) & 0xFFFFFFFF;\n\n\t\t\treturn - ( high * 0x100000000 + low );\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetInt64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getInt64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\t// Note: see getInt64() comment\n\tgetUint64() {\n\n\t\tlet low, high;\n\n\t\tif ( this.littleEndian ) {\n\n\t\t\tlow = this.getUint32();\n\t\t\thigh = this.getUint32();\n\n\t\t} else {\n\n\t\t\thigh = this.getUint32();\n\t\t\tlow = this.getUint32();\n\n\t\t}\n\n\t\treturn high * 0x100000000 + low;\n\n\t}\n\n\tgetFloat32() {\n\n\t\tconst value = this.dv.getFloat32( this.offset, this.littleEndian );\n\t\tthis.offset += 4;\n\t\treturn value;\n\n\t}\n\n\tgetFloat32Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat32() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetFloat64() {\n\n\t\tconst value = this.dv.getFloat64( this.offset, this.littleEndian );\n\t\tthis.offset += 8;\n\t\treturn value;\n\n\t}\n\n\tgetFloat64Array( size ) {\n\n\t\tconst a = [];\n\n\t\tfor ( let i = 0; i < size; i ++ ) {\n\n\t\t\ta.push( this.getFloat64() );\n\n\t\t}\n\n\t\treturn a;\n\n\t}\n\n\tgetArrayBuffer( size ) {\n\n\t\tconst value = this.dv.buffer.slice( this.offset, this.offset + size );\n\t\tthis.offset += size;\n\t\treturn value;\n\n\t}\n\n\tgetString( size ) {\n\n\t\tconst start = this.offset;\n\t\tlet a = new Uint8Array( this.dv.buffer, start, size );\n\n\t\tthis.skip( size );\n\n\t\tconst nullByte = a.indexOf( 0 );\n\t\tif ( nullByte >= 0 ) a = new Uint8Array( this.dv.buffer, start, nullByte );\n\n\t\treturn this._textDecoder.decode( a );\n\n\t}\n\n}\n\n// FBXTree holds a representation of the FBX data, returned by the TextParser ( FBX ASCII format)\n// and BinaryParser( FBX Binary format)\nclass FBXTree {\n\n\tadd( key, val ) {\n\n\t\tthis[ key ] = val;\n\n\t}\n\n}\n\n// ************** UTILITY FUNCTIONS **************\n\nfunction isFbxFormatBinary( buffer ) {\n\n\tconst CORRECT = 'Kaydara\\u0020FBX\\u0020Binary\\u0020\\u0020\\0';\n\n\treturn buffer.byteLength >= CORRECT.length && CORRECT === convertArrayBufferToString( buffer, 0, CORRECT.length );\n\n}\n\nfunction isFbxFormatASCII( text ) {\n\n\tconst CORRECT = [ 'K', 'a', 'y', 'd', 'a', 'r', 'a', '\\\\', 'F', 'B', 'X', '\\\\', 'B', 'i', 'n', 'a', 'r', 'y', '\\\\', '\\\\' ];\n\n\tlet cursor = 0;\n\n\tfunction read( offset ) {\n\n\t\tconst result = text[ offset - 1 ];\n\t\ttext = text.slice( cursor + offset );\n\t\tcursor ++;\n\t\treturn result;\n\n\t}\n\n\tfor ( let i = 0; i < CORRECT.length; ++ i ) {\n\n\t\tconst num = read( 1 );\n\t\tif ( num === CORRECT[ i ] ) {\n\n\t\t\treturn false;\n\n\t\t}\n\n\t}\n\n\treturn true;\n\n}\n\nfunction getFbxVersion( text ) {\n\n\tconst versionRegExp = /FBXVersion: (\\d+)/;\n\tconst match = text.match( versionRegExp );\n\n\tif ( match ) {\n\n\t\tconst version = parseInt( match[ 1 ] );\n\t\treturn version;\n\n\t}\n\n\tthrow new Error( 'THREE.FBXLoader: Cannot find the version number for the file given.' );\n\n}\n\n// Converts FBX ticks into real time seconds.\nfunction convertFBXTimeToSeconds( time ) {\n\n\treturn time / 46186158000;\n\n}\n\nconst dataArray = [];\n\n// extracts the data from the correct position in the FBX array based on indexing type\nfunction getData( polygonVertexIndex, polygonIndex, vertexIndex, infoObject ) {\n\n\tlet index;\n\n\tswitch ( infoObject.mappingType ) {\n\n\t\tcase 'ByPolygonVertex' :\n\t\t\tindex = polygonVertexIndex;\n\t\t\tbreak;\n\t\tcase 'ByPolygon' :\n\t\t\tindex = polygonIndex;\n\t\t\tbreak;\n\t\tcase 'ByVertice' :\n\t\t\tindex = vertexIndex;\n\t\t\tbreak;\n\t\tcase 'AllSame' :\n\t\t\tindex = infoObject.indices[ 0 ];\n\t\t\tbreak;\n\t\tdefault :\n\t\t\tconsole.warn( 'THREE.FBXLoader: unknown attribute mapping type ' + infoObject.mappingType );\n\n\t}\n\n\tif ( infoObject.referenceType === 'IndexToDirect' ) index = infoObject.indices[ index ];\n\n\tconst from = index * infoObject.dataSize;\n\tconst to = from + infoObject.dataSize;\n\n\treturn slice( dataArray, infoObject.buffer, from, to );\n\n}\n\nconst tempEuler = new Euler();\nconst tempVec = new Vector3();\n\n// generate transformation from FBX transform data\n// ref: https://help.autodesk.com/view/FBX/2017/ENU/?guid=__files_GUID_10CDD63C_79C1_4F2D_BB28_AD2BE65A02ED_htm\n// ref: http://docs.autodesk.com/FBX/2014/ENU/FBX-SDK-Documentation/index.html?url=cpp_ref/_transformations_2main_8cxx-example.html,topicNumber=cpp_ref__transformations_2main_8cxx_example_htmlfc10a1e1-b18d-4e72-9dc0-70d0f1959f5e\nfunction generateTransform( transformData ) {\n\n\tconst lTranslationM = new Matrix4();\n\tconst lPreRotationM = new Matrix4();\n\tconst lRotationM = new Matrix4();\n\tconst lPostRotationM = new Matrix4();\n\n\tconst lScalingM = new Matrix4();\n\tconst lScalingPivotM = new Matrix4();\n\tconst lScalingOffsetM = new Matrix4();\n\tconst lRotationOffsetM = new Matrix4();\n\tconst lRotationPivotM = new Matrix4();\n\n\tconst lParentGX = new Matrix4();\n\tconst lParentLX = new Matrix4();\n\tconst lGlobalT = new Matrix4();\n\n\tconst inheritType = ( transformData.inheritType ) ? transformData.inheritType : 0;\n\n\tif ( transformData.translation ) lTranslationM.setPosition( tempVec.fromArray( transformData.translation ) );\n\n\tif ( transformData.preRotation ) {\n\n\t\tconst array = transformData.preRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder || Euler.DEFAULT_ORDER );\n\t\tlPreRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.rotation ) {\n\n\t\tconst array = transformData.rotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder || Euler.DEFAULT_ORDER );\n\t\tlRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\n\t}\n\n\tif ( transformData.postRotation ) {\n\n\t\tconst array = transformData.postRotation.map( MathUtils.degToRad );\n\t\tarray.push( transformData.eulerOrder || Euler.DEFAULT_ORDER );\n\t\tlPostRotationM.makeRotationFromEuler( tempEuler.fromArray( array ) );\n\t\tlPostRotationM.invert();\n\n\t}\n\n\tif ( transformData.scale ) lScalingM.scale( tempVec.fromArray( transformData.scale ) );\n\n\t// Pivots and offsets\n\tif ( transformData.scalingOffset ) lScalingOffsetM.setPosition( tempVec.fromArray( transformData.scalingOffset ) );\n\tif ( transformData.scalingPivot ) lScalingPivotM.setPosition( tempVec.fromArray( transformData.scalingPivot ) );\n\tif ( transformData.rotationOffset ) lRotationOffsetM.setPosition( tempVec.fromArray( transformData.rotationOffset ) );\n\tif ( transformData.rotationPivot ) lRotationPivotM.setPosition( tempVec.fromArray( transformData.rotationPivot ) );\n\n\t// parent transform\n\tif ( transformData.parentMatrixWorld ) {\n\n\t\tlParentLX.copy( transformData.parentMatrix );\n\t\tlParentGX.copy( transformData.parentMatrixWorld );\n\n\t}\n\n\tconst lLRM = lPreRotationM.clone().multiply( lRotationM ).multiply( lPostRotationM );\n\t// Global Rotation\n\tconst lParentGRM = new Matrix4();\n\tlParentGRM.extractRotation( lParentGX );\n\n\t// Global Shear*Scaling\n\tconst lParentTM = new Matrix4();\n\tlParentTM.copyPosition( lParentGX );\n\n\tconst lParentGRSM = lParentTM.clone().invert().multiply( lParentGX );\n\tconst lParentGSM = lParentGRM.clone().invert().multiply( lParentGRSM );\n\tconst lLSM = lScalingM;\n\n\tconst lGlobalRS = new Matrix4();\n\n\tif ( inheritType === 0 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM ).multiply( lLSM );\n\n\t} else if ( inheritType === 1 ) {\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lParentGSM ).multiply( lLRM ).multiply( lLSM );\n\n\t} else {\n\n\t\tconst lParentLSM = new Matrix4().scale( new Vector3().setFromMatrixScale( lParentLX ) );\n\t\tconst lParentLSM_inv = lParentLSM.clone().invert();\n\t\tconst lParentGSM_noLocal = lParentGSM.clone().multiply( lParentLSM_inv );\n\n\t\tlGlobalRS.copy( lParentGRM ).multiply( lLRM ).multiply( lParentGSM_noLocal ).multiply( lLSM );\n\n\t}\n\n\tconst lRotationPivotM_inv = lRotationPivotM.clone().invert();\n\tconst lScalingPivotM_inv = lScalingPivotM.clone().invert();\n\t// Calculate the local transform matrix\n\tlet lTransform = lTranslationM.clone().multiply( lRotationOffsetM ).multiply( lRotationPivotM ).multiply( lPreRotationM ).multiply( lRotationM ).multiply( lPostRotationM ).multiply( lRotationPivotM_inv ).multiply( lScalingOffsetM ).multiply( lScalingPivotM ).multiply( lScalingM ).multiply( lScalingPivotM_inv );\n\n\tconst lLocalTWithAllPivotAndOffsetInfo = new Matrix4().copyPosition( lTransform );\n\n\tconst lGlobalTranslation = lParentGX.clone().multiply( lLocalTWithAllPivotAndOffsetInfo );\n\tlGlobalT.copyPosition( lGlobalTranslation );\n\n\tlTransform = lGlobalT.clone().multiply( lGlobalRS );\n\n\t// from global to local\n\tlTransform.premultiply( lParentGX.invert() );\n\n\treturn lTransform;\n\n}\n\n// Returns the three.js intrinsic Euler order corresponding to FBX extrinsic Euler order\n// ref: http://help.autodesk.com/view/FBX/2017/ENU/?guid=__cpp_ref_class_fbx_euler_html\nfunction getEulerOrder( order ) {\n\n\torder = order || 0;\n\n\tconst enums = [\n\t\t'ZYX', // -> XYZ extrinsic\n\t\t'YZX', // -> XZY extrinsic\n\t\t'XZY', // -> YZX extrinsic\n\t\t'ZXY', // -> YXZ extrinsic\n\t\t'YXZ', // -> ZXY extrinsic\n\t\t'XYZ', // -> ZYX extrinsic\n\t\t//'SphericXYZ', // not possible to support\n\t];\n\n\tif ( order === 6 ) {\n\n\t\tconsole.warn( 'THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.' );\n\t\treturn enums[ 0 ];\n\n\t}\n\n\treturn enums[ order ];\n\n}\n\n// Parses comma separated list of numbers and returns them an array.\n// Used internally by the TextParser\nfunction parseNumberArray( value ) {\n\n\tconst array = value.split( ',' ).map( function ( val ) {\n\n\t\treturn parseFloat( val );\n\n\t} );\n\n\treturn array;\n\n}\n\nfunction convertArrayBufferToString( buffer, from, to ) {\n\n\tif ( from === undefined ) from = 0;\n\tif ( to === undefined ) to = buffer.byteLength;\n\n\treturn new TextDecoder().decode( new Uint8Array( buffer, from, to ) );\n\n}\n\nfunction append( a, b ) {\n\n\tfor ( let i = 0, j = a.length, l = b.length; i < l; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n}\n\nfunction slice( a, b, from, to ) {\n\n\tfor ( let i = from, j = 0; i < to; i ++, j ++ ) {\n\n\t\ta[ j ] = b[ i ];\n\n\t}\n\n\treturn a;\n\n}\n\n\nexport { FBXLoader };\n","import { FBXLoader } from 'three/addons/loaders/FBXLoader.js';\nTHREE.FBXLoader = FBXLoader;\n\n/**\n * fbx-model\n *\n * Loader for FBX format.\n */\nAFRAME.registerComponent('fbx-model', {\n  schema: {\n    src:         { type: 'asset' },\n    crossorigin: { default: '' }\n  },\n\n  init: function () {\n    this.model = null;\n  },\n\n  update: function () {\n    const data = this.data;\n    if (!data.src) return;\n\n    this.remove();\n    const loader = new THREE.FBXLoader();\n    if (data.crossorigin) loader.setCrossOrigin(data.crossorigin);\n    loader.load(data.src, this.load.bind(this));\n  },\n\n  load: function (model) {\n    this.model = model;\n    this.el.setObject3D('mesh', model);\n    this.el.emit('model-loaded', {format: 'fbx', model: model});\n  },\n\n  remove: function () {\n    if (this.model) this.el.removeObject3D('mesh');\n  }\n});\n","const fetchScript = require('../../lib/fetch-script')();\n\nconst LOADER_SRC = 'https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js';\n\nconst loadLoader = (function () {\n  let promise;\n  return function () {\n    promise = promise || fetchScript(LOADER_SRC);\n    return promise;\n  };\n}());\n\n/**\n * Legacy loader for glTF 1.0 models.\n * Asynchronously loads THREE.GLTFLoader from jsdelivr.\n */\nmodule.exports = AFRAME.registerComponent('gltf-model-legacy', {\n  schema: {type: 'model'},\n\n  init: function () {\n    this.model = null;\n    this.loader = null;\n    this.loaderPromise = loadLoader().then(() => {\n      this.loader = new THREE.GLTFLoader();\n      this.loader.setCrossOrigin('Anonymous');\n    });\n  },\n\n  update: function () {\n    const self = this;\n    const el = this.el;\n    const src = this.data;\n\n    if (!src) { return; }\n\n    this.remove();\n\n    this.loaderPromise.then(() => {\n      this.loader.load(src, function gltfLoaded (gltfModel) {\n        self.model = gltfModel.scene;\n        self.model.animations = gltfModel.animations;\n        el.setObject3D('mesh', self.model);\n        el.emit('model-loaded', {format: 'gltf', model: self.model});\n      });\n    });\n  },\n\n  remove: function () {\n    if (!this.model) { return; }\n    this.el.removeObject3D('mesh');\n  }\n});\n","require('./animation-mixer');\nrequire('./collada-model-legacy');\nrequire('./fbx-model');\nrequire('./gltf-model-legacy');\nrequire('./object-model');\n","/**\n * object-model\n *\n * Loader for THREE.js JSON format. Somewhat confusingly, there are two different THREE.js formats,\n * both having the .json extension. This loader supports only THREE.ObjectLoader, which typically\n * includes multiple meshes or an entire scene.\n *\n * Check the console for errors, if in doubt. You may need to use `json-model` or\n * `blend-character-model` for some .js and .json files.\n *\n * See: https://clara.io/learn/user-guide/data_exchange/threejs_export\n */\nmodule.exports = AFRAME.registerComponent('object-model', {\n  schema: {\n    src:         { type: 'asset' },\n    crossorigin: { default: '' }\n  },\n\n  init: function () {\n    this.model = null;\n  },\n\n  update: function () {\n    let loader;\n    const data = this.data;\n    if (!data.src) return;\n\n    this.remove();\n    loader = new THREE.ObjectLoader();\n    if (data.crossorigin) loader.setCrossOrigin(data.crossorigin);\n    loader.load(data.src, (object) => {\n\n      // Enable skinning, if applicable.\n      object.traverse((o) => {\n        if (o instanceof THREE.SkinnedMesh && o.material) {\n          o.material.skinning = !!((o.geometry && o.geometry.bones) || []).length;\n        }\n      });\n\n      this.load(object);\n    });\n  },\n\n  load: function (model) {\n    this.model = model;\n    this.el.setObject3D('mesh', model);\n    this.el.emit('model-loaded', {format: 'json', model: model});\n  },\n\n  remove: function () {\n    if (this.model) this.el.removeObject3D('mesh');\n  }\n});\n","module.exports = AFRAME.registerComponent('checkpoint', {\n  schema: {\n    offset: {default: {x: 0, y: 0, z: 0}, type: 'vec3'}\n  },\n\n  init: function () {\n    this.active = false;\n    this.targetEl = null;\n    this.fire = this.fire.bind(this);\n    this.offset = new THREE.Vector3();\n  },\n\n  update: function () {\n    this.offset.copy(this.data.offset);\n  },\n\n  play: function () { this.el.addEventListener('click', this.fire); },\n  pause: function () { this.el.removeEventListener('click', this.fire); },\n  remove: function () { this.pause(); },\n\n  fire: function () {\n    const targetEl = this.el.sceneEl.querySelector('[checkpoint-controls]');\n    if (!targetEl) {\n      throw new Error('No `checkpoint-controls` component found.');\n    }\n    targetEl.components['checkpoint-controls'].setCheckpoint(this.el);\n  },\n\n  getOffset: function () {\n    return this.offset.copy(this.data.offset);\n  }\n});\n","/**\n * @param  {Array<THREE.Material>|THREE.Material} material\n * @return {Array<THREE.Material>}\n */\nfunction ensureMaterialArray (material) {\n  if (!material) {\n    return [];\n  } else if (Array.isArray(material)) {\n    return material;\n  } else if (material.materials) {\n    return material.materials;\n  } else {\n    return [material];\n  }\n}\n\n/**\n * @param  {THREE.Object3D} mesh\n * @param  {Array<string>} materialNames\n * @param  {THREE.Texture} envMap\n * @param  {number} reflectivity  [description]\n */\nfunction applyEnvMap (mesh, materialNames, envMap, reflectivity) {\n  if (!mesh) return;\n\n  materialNames = materialNames || [];\n\n  mesh.traverse((node) => {\n\n    if (!node.isMesh) return;\n\n    const meshMaterials = ensureMaterialArray(node.material);\n\n    meshMaterials.forEach((material) => {\n\n      if (material && !('envMap' in material)) return;\n      if (materialNames.length && materialNames.indexOf(material.name) === -1) return;\n\n      material.envMap = envMap;\n      material.reflectivity = reflectivity;\n      material.needsUpdate = true;\n\n    });\n\n  });\n}\n\n/**\n * Specifies an envMap on an entity, without replacing any existing material\n * properties.\n */\nmodule.exports = AFRAME.registerComponent('cube-env-map', {\n  multiple: true,\n\n  schema: {\n    path: {default: ''},\n    extension: {default: 'jpg', oneOf: ['jpg', 'png']},\n    enableBackground: {default: false},\n    reflectivity: {default: 1, min: 0, max: 1},\n    materials: {default: []}\n  },\n\n  init: function () {\n    const data = this.data;\n\n    this.texture = new THREE.CubeTextureLoader().load([\n      data.path + 'posx.' + data.extension, data.path + 'negx.' + data.extension,\n      data.path + 'posy.' + data.extension, data.path + 'negy.' + data.extension,\n      data.path + 'posz.' + data.extension, data.path + 'negz.' + data.extension\n    ]);\n    this.texture.format = THREE.RGBAFormat;\n\n    this.object3dsetHandler = () => {\n      const mesh = this.el.getObject3D('mesh');\n      const data = this.data;\n      applyEnvMap(mesh, data.materials, this.texture, data.reflectivity);\n    };\n\n    this.object3dsetHandler();\n    this.el.addEventListener('object3dset', this.object3dsetHandler);\n    \n  },\n\n  update: function (oldData) {\n    const data = this.data;\n    const mesh = this.el.getObject3D('mesh');\n\n    let addedMaterialNames = [];\n    let removedMaterialNames = [];\n\n    if (data.materials.length) {\n      if (oldData.materials) {\n        addedMaterialNames = data.materials.filter((name) => !oldData.materials.includes(name));\n        removedMaterialNames = oldData.materials.filter((name) => !data.materials.includes(name));\n      } else {\n        addedMaterialNames = data.materials;\n      }\n    }\n    if (addedMaterialNames.length) {\n      applyEnvMap(mesh, addedMaterialNames, this.texture, data.reflectivity);\n    }\n    if (removedMaterialNames.length) {\n      applyEnvMap(mesh, removedMaterialNames, null, 1);\n    }\n\n    if (oldData.materials && data.reflectivity !== oldData.reflectivity) {\n      const maintainedMaterialNames = data.materials\n        .filter((name) => oldData.materials.includes(name));\n      if (maintainedMaterialNames.length) {\n        applyEnvMap(mesh, maintainedMaterialNames, this.texture, data.reflectivity);\n      }\n    }\n\n    if (this.data.enableBackground && !oldData.enableBackground) {\n      this.setBackground(this.texture);\n    } else if (!this.data.enableBackground && oldData.enableBackground) {\n      this.setBackground(null);\n    }\n  },\n\n  remove: function () {\n    this.el.removeEventListener('object3dset', this.object3dsetHandler);\n    const mesh = this.el.getObject3D('mesh');\n    const data = this.data;\n\n    applyEnvMap(mesh, data.materials, null, 1);\n    if (data.enableBackground) this.setBackground(null);\n  },\n\n  setBackground: function (texture) {\n    this.el.sceneEl.object3D.background = texture;\n  }\n});","/* global CANNON */\n\n/**\n * Based on aframe/examples/showcase/tracked-controls.\n *\n * Handles events coming from the hand-controls.\n * Determines if the entity is grabbed or released.\n * Updates its position to move along the controller.\n */\nmodule.exports = AFRAME.registerComponent('grab', {\n  init: function () {\n    this.system = this.el.sceneEl.systems.physics;\n\n    this.GRABBED_STATE = 'grabbed';\n\n    this.grabbing = false;\n    this.hitEl =      /** @type {AFRAME.Element}    */ null;\n    this.physics =    /** @type {AFRAME.System}     */ this.el.sceneEl.systems.physics;\n    this.constraint = /** @type {CANNON.Constraint} */ null;\n\n    // Bind event handlers\n    this.onHit = this.onHit.bind(this);\n    this.onGripOpen = this.onGripOpen.bind(this);\n    this.onGripClose = this.onGripClose.bind(this);\n  },\n\n  play: function () {\n    const el = this.el;\n    el.addEventListener('hit', this.onHit);\n    el.addEventListener('gripdown', this.onGripClose);\n    el.addEventListener('gripup', this.onGripOpen);\n    el.addEventListener('trackpaddown', this.onGripClose);\n    el.addEventListener('trackpadup', this.onGripOpen);\n    el.addEventListener('triggerdown', this.onGripClose);\n    el.addEventListener('triggerup', this.onGripOpen);\n  },\n\n  pause: function () {\n    const el = this.el;\n    el.removeEventListener('hit', this.onHit);\n    el.removeEventListener('gripdown', this.onGripClose);\n    el.removeEventListener('gripup', this.onGripOpen);\n    el.removeEventListener('trackpaddown', this.onGripClose);\n    el.removeEventListener('trackpadup', this.onGripOpen);\n    el.removeEventListener('triggerdown', this.onGripClose);\n    el.removeEventListener('triggerup', this.onGripOpen);\n  },\n\n  onGripClose: function () {\n    this.grabbing = true;\n  },\n\n  onGripOpen: function () {\n    const hitEl = this.hitEl;\n    this.grabbing = false;\n    if (!hitEl) { return; }\n    hitEl.removeState(this.GRABBED_STATE);\n    this.hitEl = undefined;\n    this.system.removeConstraint(this.constraint);\n    this.constraint = null;\n  },\n\n  onHit: function (evt) {\n    const hitEl = evt.detail.el;\n    // If the element is already grabbed (it could be grabbed by another controller).\n    // If the hand is not grabbing the element does not stick.\n    // If we're already grabbing something you can't grab again.\n    if (hitEl.is(this.GRABBED_STATE) || !this.grabbing || this.hitEl) { return; }\n    hitEl.addState(this.GRABBED_STATE);\n    this.hitEl = hitEl;\n    this.constraint = new CANNON.LockConstraint(this.el.body, hitEl.body);\n    this.system.addConstraint(this.constraint);\n  }\n});\n","require('./checkpoint');\nrequire('./cube-env-map');\nrequire('./grab');\nrequire('./normal-material');\nrequire('./sphere-collider');\n","/**\n * Recursively applies a MeshNormalMaterial to the entity, such that\n * face colors are determined by their orientation. Helpful for\n * debugging geometry\n */\nmodule.exports = AFRAME.registerComponent('normal-material', {\n  init: function () {\n    this.material = new THREE.MeshNormalMaterial({flatShading: true});\n    this.applyMaterial = this.applyMaterial.bind(this);\n    this.el.addEventListener('object3dset', this.applyMaterial);\n    this.applyMaterial();\n  },\n\n  remove: function () {\n    this.el.removeEventListener('object3dset', this.applyMaterial);\n  },\n\n  applyMaterial: function () {\n    this.el.object3D.traverse((node) => {\n      if (node.isMesh) node.material = this.material;\n    });\n  }\n});\n","/**\n * Based on aframe/examples/showcase/tracked-controls.\n *\n * Implement bounding sphere collision detection for entities with a mesh.\n * Sets the specified state on the intersected entities.\n *\n * @property {string} objects - Selector of the entities to test for collision.\n * @property {string} state - State to set on collided entities.\n *\n */\nmodule.exports = AFRAME.registerComponent('sphere-collider', {\n  schema: {\n    enabled: {default: true},\n    interval: {default: 80},\n    objects: {default: ''},\n    state: {default: 'collided'},\n    radius: {default: 0.05},\n    watch: {default: true}\n  },\n\n  init: function () {\n    /** @type {MutationObserver} */\n    this.observer = null;\n    /** @type {Array<Element>} Elements to watch for collisions. */\n    this.els = [];\n    /** @type {Array<Element>} Elements currently in collision state. */\n    this.collisions = [];\n    this.prevCheckTime = undefined;\n\n    this.eventDetail = {};\n    this.handleHit = this.handleHit.bind(this);\n    this.handleHitEnd = this.handleHitEnd.bind(this);\n  },\n\n  play: function () {\n    const sceneEl = this.el.sceneEl;\n\n    if (this.data.watch) {\n      this.observer = new MutationObserver(this.update.bind(this, null));\n      this.observer.observe(sceneEl, {childList: true, subtree: true});\n    }\n  },\n\n  pause: function () {\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n  },\n\n  /**\n   * Update list of entities to test for collision.\n   */\n  update: function () {\n    const data = this.data;\n    let objectEls;\n\n    // Push entities into list of els to intersect.\n    if (data.objects) {\n      objectEls = this.el.sceneEl.querySelectorAll(data.objects);\n    } else {\n      // If objects not defined, intersect with everything.\n      objectEls = this.el.sceneEl.children;\n    }\n    // Convert from NodeList to Array\n    this.els = Array.prototype.slice.call(objectEls);\n  },\n\n  tick: (function () {\n    const position = new THREE.Vector3(),\n        meshPosition = new THREE.Vector3(),\n        colliderScale = new THREE.Vector3(),\n        size = new THREE.Vector3(),\n        box = new THREE.Box3(),\n        collisions = [],\n        distanceMap = new Map();\n    return function (time) {\n      if (!this.data.enabled) { return; }\n\n      // Only check for intersection if interval time has passed.\n      const prevCheckTime = this.prevCheckTime;\n      if (prevCheckTime && (time - prevCheckTime < this.data.interval)) { return; }\n      // Update check time.\n      this.prevCheckTime = time;\n\n      const el = this.el,\n          data = this.data,\n          mesh = el.getObject3D('mesh');\n      let colliderRadius;\n\n      if (!mesh) { return; }\n\n      collisions.length = 0;\n      distanceMap.clear();\n      el.object3D.getWorldPosition(position);\n      el.object3D.getWorldScale(colliderScale);\n      colliderRadius = data.radius * scaleFactor(colliderScale);\n      // Update collision list.\n      this.els.forEach(intersect);\n\n      // Emit events and add collision states, in order of distance.\n      collisions\n        .sort((a, b) => distanceMap.get(a) > distanceMap.get(b) ? 1 : -1)\n        .forEach(this.handleHit);\n\n      // Remove collision state from other elements.\n      this.collisions\n        .filter((el) => !distanceMap.has(el))\n        .forEach(this.handleHitEnd);\n\n      // Store new collisions\n      copyArray(this.collisions, collisions);\n\n      // Bounding sphere collision detection\n      function intersect (el) {\n        let radius, mesh, distance, extent;\n\n        if (!el.isEntity) { return; }\n\n        mesh = el.getObject3D('mesh');\n\n        if (!mesh) { return; }\n\n        box.setFromObject(mesh).getSize(size);\n        extent = Math.max(size.x, size.y, size.z) / 2;\n        radius = Math.sqrt(2 * extent * extent);\n        box.getCenter(meshPosition);\n\n        if (!radius) { return; }\n\n        distance = position.distanceTo(meshPosition);\n        if (distance < radius + colliderRadius) {\n          collisions.push(el);\n          distanceMap.set(el, distance);\n        }\n      }\n      // use max of scale factors to maintain bounding sphere collision\n      function scaleFactor (scaleVec) {\n        return Math.max(scaleVec.x, scaleVec.y, scaleVec.z);\n      }\n    };\n  })(),\n\n  handleHit: function (targetEl) {\n    targetEl.emit('hit');\n    targetEl.addState(this.data.state);\n    this.eventDetail.el = targetEl;\n    this.el.emit('hit', this.eventDetail);\n  },\n  handleHitEnd: function (targetEl) {\n    targetEl.emit('hitend');\n    targetEl.removeState(this.data.state);\n    this.eventDetail.el = targetEl;\n    this.el.emit('hitend', this.eventDetail);\n  }\n});\n\nfunction copyArray (dest, source) {\n  dest.length = 0;\n  for (let i = 0; i < source.length; i++) { dest[i] = source[i]; }\n}\n","require('./nav-mesh');\nrequire('./nav-agent');\nrequire('./system');\n","module.exports = AFRAME.registerComponent('nav-agent', {\n  schema: {\n    destination: {type: 'vec3'},\n    active: {default: false},\n    speed: {default: 2}\n  },\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.system.addAgent(this);\n    this.group = null;\n    this.path = [];\n    this.raycaster = new THREE.Raycaster();\n  },\n  remove: function () {\n    this.system.removeAgent(this);\n  },\n  update: function () {\n    this.path.length = 0;\n  },\n  updateNavLocation: function () {\n    this.group = null;\n    this.path = [];\n  },\n  tick: (function () {\n    const vDest = new THREE.Vector3();\n    const vDelta = new THREE.Vector3();\n    const vNext = new THREE.Vector3();\n\n    return function (t, dt) {\n      const el = this.el;\n      const data = this.data;\n      const raycaster = this.raycaster;\n      const speed = data.speed * dt / 1000;\n\n      if (!data.active) return;\n\n      // Use PatrolJS pathfinding system to get shortest path to target.\n      if (!this.path.length) {\n        const position = this.el.object3D.position;\n        this.group = this.group || this.system.getGroup(position);\n        this.path = this.system.getPath(position, vDest.copy(data.destination), this.group) || [];\n        el.emit('navigation-start');\n      }\n\n      // If no path is found, exit.\n      if (!this.path.length) {\n        console.warn('[nav] Unable to find path to %o.', data.destination);\n        this.el.setAttribute('nav-agent', {active: false});\n        el.emit('navigation-end');\n        return;\n      }\n\n      // Current segment is a vector from current position to next waypoint.\n      const vCurrent = el.object3D.position;\n      const vWaypoint = this.path[0];\n      vDelta.subVectors(vWaypoint, vCurrent);\n\n      const distance = vDelta.length();\n      let gazeTarget;\n\n      if (distance < speed) {\n        // If <1 step from current waypoint, discard it and move toward next.\n        this.path.shift();\n\n        // After discarding the last waypoint, exit pathfinding.\n        if (!this.path.length) {\n          this.el.setAttribute('nav-agent', {active: false});\n          el.emit('navigation-end');\n          return;\n        }\n\n        vNext.copy(vCurrent);\n        gazeTarget = this.path[0];\n      } else {\n        // If still far away from next waypoint, find next position for\n        // the current frame.\n        vNext.copy(vDelta.setLength(speed)).add(vCurrent);\n        gazeTarget = vWaypoint;\n      }\n\n      // Look at the next waypoint.\n      gazeTarget.y = vCurrent.y;\n      el.object3D.lookAt(gazeTarget);\n\n      // Raycast against the nav mesh, to keep the agent moving along the\n      // ground, not traveling in a straight line from higher to lower waypoints.\n      raycaster.ray.origin.copy(vNext);\n      raycaster.ray.origin.y += 1.5;\n      raycaster.ray.direction = {x:0, y:-1, z:0};\n      const intersections = raycaster.intersectObject(this.system.getNavMesh());\n\n      if (!intersections.length) {\n        // Raycasting failed. Step toward the waypoint and hope for the best.\n        vCurrent.copy(vNext);\n      } else {\n        // Re-project next position onto nav mesh.\n        vDelta.subVectors(intersections[0].point, vCurrent);\n        vCurrent.add(vDelta.setLength(speed));\n      }\n\n    };\n  }())\n});\n","/**\n * nav-mesh\n *\n * Waits for a mesh to be loaded on the current entity, then sets it as the\n * nav mesh in the pathfinding system.\n */\nmodule.exports = AFRAME.registerComponent('nav-mesh', {\n  schema: {\n    nodeName: {type: 'string'}\n  },\n\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.hasLoadedNavMesh = false;\n    this.nodeName = this.data.nodeName;\n    this.el.addEventListener('object3dset', this.loadNavMesh.bind(this));\n  },\n\n  play: function () {\n    if (!this.hasLoadedNavMesh) this.loadNavMesh();\n  },\n\n  loadNavMesh: function () {\n    var self = this;\n    const object = this.el.getObject3D('mesh');\n    const scene = this.el.sceneEl.object3D;\n\n    if (!object) return;\n\n    let navMesh;\n    object.traverse((node) => {\n      if (node.isMesh &&\n          (!self.nodeName || node.name === self.nodeName)) navMesh = node;\n    });\n\n    if (!navMesh) return;\n\n    const navMeshGeometry = navMesh.geometry.clone();\n    navMesh.updateWorldMatrix(true, false);\n    navMeshGeometry.applyMatrix4(navMesh.matrixWorld);\n    this.system.setNavMeshGeometry(navMeshGeometry);\n    this.hasLoadedNavMesh = true;\n  }\n});\n","const { Pathfinding } = require('three-pathfinding');\n\nconst pathfinder = new Pathfinding();\nconst ZONE = 'level';\n\n/**\n * nav\n *\n * Pathfinding system, using PatrolJS.\n */\nmodule.exports = AFRAME.registerSystem('nav', {\n  init: function () {\n    this.navMesh = null;\n    this.agents = new Set();\n  },\n\n  /**\n   * @param {THREE.Geometry} geometry\n   */\n  setNavMeshGeometry: function (geometry) {\n    this.navMesh = new THREE.Mesh(geometry);\n    pathfinder.setZoneData(ZONE, Pathfinding.createZone(geometry));\n    Array.from(this.agents).forEach((agent) => agent.updateNavLocation());\n  },\n\n  /**\n   * @return {THREE.Mesh}\n   */\n  getNavMesh: function () {\n    return this.navMesh;\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  addAgent: function (ctrl) {\n    this.agents.add(ctrl);\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  removeAgent: function (ctrl) {\n    this.agents.delete(ctrl);\n  },\n\n  /**\n   * @param  {THREE.Vector3} start\n   * @param  {THREE.Vector3} end\n   * @param  {number} groupID\n   * @return {Array<THREE.Vector3>}\n   */\n  getPath: function (start, end, groupID) {\n    return this.navMesh\n      ? pathfinder.findPath(start, end, ZONE, groupID)\n      : null;\n  },\n\n  /**\n   * @param {THREE.Vector3} position\n   * @return {number}\n   */\n  getGroup: function (position) {\n    return this.navMesh\n      ? pathfinder.getGroup(ZONE, position)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} position\n   * @param  {number} groupID\n   * @return {Node}\n   */\n  getNode: function (position, groupID) {\n    return this.navMesh\n      ? pathfinder.getClosestNode(position, ZONE, groupID, true)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} start Starting position.\n   * @param  {THREE.Vector3} end Desired ending position.\n   * @param  {number} groupID\n   * @param  {Node} node\n   * @param  {THREE.Vector3} endTarget (Output) Adjusted step end position.\n   * @return {Node} Current node, after step is taken.\n   */\n  clampStep: function (start, end, groupID, node, endTarget) {\n    if (!this.navMesh) {\n      endTarget.copy(end);\n      return null;\n    } else if (!node) {\n      endTarget.copy(end);\n      return this.getNode(end, groupID);\n    }\n    return pathfinder.clampStep(start, end, node, ZONE, groupID, endTarget);\n  }\n});\n","/**\n * Flat grid.\n *\n * Defaults to 75x75.\n */\nmodule.exports = AFRAME.registerPrimitive('a-grid', {\n  defaultComponents: {\n    geometry: {\n      primitive: 'plane',\n      width: 75,\n      height: 75\n    },\n    rotation: {x: -90, y: 0, z: 0},\n    material: {\n      src: 'url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)',\n      repeat: '75 75'\n    }\n  },\n  mappings: {\n    width: 'geometry.width',\n    height: 'geometry.height',\n    src: 'material.src'\n  }\n});\n","/**\n * Flat-shaded ocean primitive.\n *\n * Based on a Codrops tutorial:\n * http://tympanus.net/codrops/2016/04/26/the-aviator-animating-basic-3d-scene-threejs/\n */\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-ocean', {\n  defaultComponents: {\n    ocean: {},\n    rotation: {x: -90, y: 0, z: 0}\n  },\n  mappings: {\n    width: 'ocean.width',\n    depth: 'ocean.depth',\n    density: 'ocean.density',\n    amplitude: 'ocean.amplitude',\n    amplitudeVariance: 'ocean.amplitudeVariance',\n    speed: 'ocean.speed',\n    speedVariance: 'ocean.speedVariance',\n    color: 'ocean.color',\n    opacity: 'ocean.opacity'\n  }\n});\n\nmodule.exports.Component = AFRAME.registerComponent('ocean', {\n  schema: {\n    // Dimensions of the ocean area.\n    width: {default: 10, min: 0},\n    depth: {default: 10, min: 0},\n\n    // Density of waves.\n    density: {default: 10},\n\n    // Wave amplitude and variance.\n    amplitude: {default: 0.1},\n    amplitudeVariance: {default: 0.3},\n\n    // Wave speed and variance.\n    speed: {default: 1},\n    speedVariance: {default: 2},\n\n    // Material.\n    color: {default: '#7AD2F7', type: 'color'},\n    opacity: {default: 0.8}\n  },\n\n  /**\n   * Use play() instead of init(), because component mappings – unavailable as dependencies – are\n   * not guaranteed to have parsed when this component is initialized.\n   */\n  play: function () {\n    const el = this.el;\n    const data = this.data;\n    let material = el.components.material;\n\n    const geometry = new THREE.PlaneGeometry(data.width, data.depth, data.density, data.density);\n    this.waves = [];\n    const posAttribute = geometry.getAttribute('position');\n    for (let i = 0; i < posAttribute.count; i++) {\n      this.waves.push({\n        z: posAttribute.getZ(i),\n        ang: Math.random() * Math.PI * 2,\n        amp: data.amplitude + Math.random() * data.amplitudeVariance,\n        speed: (data.speed + Math.random() * data.speedVariance) / 1000 // radians / frame\n      });\n    }\n\n    if (!material) {\n      material = {};\n      material.material = new THREE.MeshPhongMaterial({\n        color: data.color,\n        transparent: data.opacity < 1,\n        opacity: data.opacity,\n        flatShading: true,\n      });\n    }\n\n    this.mesh = new THREE.Mesh(geometry, material.material);\n    el.setObject3D('mesh', this.mesh);\n  },\n\n  remove: function () {\n    this.el.removeObject3D('mesh');\n  },\n\n  tick: function (t, dt) {\n    if (!dt) return;\n\n    const posAttribute = this.mesh.geometry.getAttribute('position');\n    for (let i = 0; i < posAttribute.count; i++){\n      const vprops = this.waves[i];\n      const value = vprops.z + Math.sin(vprops.ang) * vprops.amp;\n      posAttribute.setZ(i, value);\n      vprops.ang += vprops.speed * dt;\n    }\n    posAttribute.needsUpdate = true;\n  }\n});\n","/**\n * Tube following a custom path.\n *\n * Usage:\n *\n * ```html\n * <a-tube path=\"5 0 5, 5 0 -5, -5 0 -5\" radius=\"0.5\"></a-tube>\n * ```\n */\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-tube', {\n  defaultComponents: {\n    tube:           {},\n  },\n  mappings: {\n    path:           'tube.path',\n    segments:       'tube.segments',\n    radius:         'tube.radius',\n    'radial-segments': 'tube.radialSegments',\n    closed:         'tube.closed'\n  }\n});\n\nmodule.exports.Component = AFRAME.registerComponent('tube', {\n  schema: {\n    path:           {default: []},\n    segments:       {default: 64},\n    radius:         {default: 1},\n    radialSegments: {default: 8},\n    closed:         {default: false}\n  },\n\n  init: function () {\n    const el = this.el,\n        data = this.data;\n    let material = el.components.material;\n\n    if (!data.path.length) {\n      console.error('[a-tube] `path` property expected but not found.');\n      return;\n    }\n\n    const curve = new THREE.CatmullRomCurve3(data.path.map(function (point) {\n      point = point.split(' ');\n      return new THREE.Vector3(Number(point[0]), Number(point[1]), Number(point[2]));\n    }));\n    const geometry = new THREE.TubeGeometry(\n      curve, data.segments, data.radius, data.radialSegments, data.closed\n    );\n\n    if (!material) {\n      material = {};\n      material.material = new THREE.MeshPhongMaterial();\n    }\n\n    this.mesh = new THREE.Mesh(geometry, material.material);\n    this.el.setObject3D('mesh', this.mesh);\n  },\n\n  update: function (prevData) {\n    if (!Object.keys(prevData).length) return;\n\n    this.remove();\n    this.init();\n  },\n\n  remove: function () {\n    if (this.mesh) this.el.removeObject3D('mesh');\n  }\n});\n","require('./a-grid');\nrequire('./a-ocean');\nrequire('./a-tube');\n","module.exports = __WEBPACK_EXTERNAL_MODULE__824__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","require('./src/controls');\nrequire('./src/loaders');\nrequire('./src/misc');\nrequire('./src/pathfinding');\nrequire('./src/primitives');\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__824__","THREE","ColladaLoader","manager","this","undefined","DefaultLoadingManager","prototype","constructor","crossOrigin","load","url","onLoad","onProgress","onError","scope","path","LoaderUtils","extractUrlBase","loader","FileLoader","setPath","text","parse","value","setResourcePath","resourcePath","options","convertUpAxis","console","warn","setCrossOrigin","getElementsByTagName","xml","name","array","childNodes","l","length","child","nodeName","push","parseStrings","parts","trim","split","Array","parseFloats","parseFloat","parseInts","parseInt","parseId","substring","isEmpty","object","Object","keys","parseAssetUnit","hasAttribute","getAttribute","parseAssetUpAxis","textContent","parseLibrary","libraryName","parser","library","elements","buildLibrary","data","builder","build","getBuild","parseAnimationSampler","inputs","nodeType","id","semantic","parseAnimationChannel","shift","sid","arraySyntax","indexOf","memberSyntax","member","indices","replace","sampler","buildAnimation","tracks","channels","samplers","sources","target","hasOwnProperty","channel","inputId","INPUT","outputId","OUTPUT","createKeyframeTracks","buildAnimationChannel","getAnimation","animations","inputSource","outputSource","time","stride","il","j","jl","node","nodes","object3D","getNode","transform","transforms","defaultMatrix","matrix","clone","transpose","index","keyframes","sort","b","transformAnimationData","prepareAnimationData","uuid","position","Vector3","scale","quaternion","Quaternion","animation","times","positionData","quaternionData","scaleData","keyframe","fromArray","decompose","x","y","z","w","VectorKeyframeTrack","QuaternionKeyframeTrack","property","defaultValue","empty","prev","next","getPrev","getNext","interpolate","createMissingKeyframes","key","buildAnimationClip","duration","end","start","animationTracks","AnimationClip","getAnimationClip","clips","parseSkin","bindShapeMatrix","parseSource","joints","parseJoints","vertexWeights","parseVertexWeights","offset","vcount","v","buildController","geometry","geometries","skin","weights","jointOffset","JOINT","weightOffset","WEIGHT","jointSource","inverseSource","INV_BIND_MATRIX","jointCount","vertexSkinData","skinIndex","skinWeight","weight","descending","d","bindMatrix","Matrix4","identity","boneInverse","buildSkin","skinIndices","skinWeights","buildImage","init_from","getImage","images","parseEffectProfileCOMMON","surfaces","parseEffectNewparam","technique","parseEffectTechnique","extra","parseEffectExtra","parseEffectSurface","parseEffectSampler","source","type","parameters","parseEffectParameters","parseEffectParameter","opaque","parseEffectParameterTexture","parseEffectParameterTextureExtra","parseEffectParameterTextureExtraTechnique","toUpperCase","parseEffectExtraTechnique","buildEffect","buildMaterial","material","effect","effects","profile","MeshPhongMaterial","MeshLambertMaterial","MeshBasicMaterial","getTexture","textureObject","image","extension","slice","lastIndexOf","toLowerCase","tgaLoader","textureLoader","getTextureLoader","texture","wrapS","wrapU","RepeatWrapping","ClampToEdgeWrapping","wrapT","wrapV","set","offsetU","offsetV","repeat","repeatU","repeatV","parameter","color","map","specular","specularMap","normalMap","lightMap","float","shininess","emissive","emissiveMap","transparent","transparency","opacity","double_sided","side","DoubleSide","getMaterial","materials","parseCameraOptics","parseCameraTechnique","parseCameraParameters","buildCamera","camera","optics","PerspectiveCamera","yfov","aspect_ratio","znear","zfar","ymag","xmag","aspectRatio","OrthographicCamera","getCamera","cameras","parseLightTechnique","parseLightParameters","Color","falloffAngle","f","distance","Math","sqrt","buildLight","light","DirectionalLight","PointLight","SpotLight","AmbientLight","copy","getLight","lights","accessor","parseGeometryVertices","parseGeometryPrimitive","primitive","count","hasUV","inputname","max","p","checkUVCoordinates","primitives","uvsNeedsFix","buildGeometry","vertices","groupedPrimitives","groupPrimitives","primitiveType","buildGeometryType","normal","uv","uv2","BufferGeometry","materialKeys","g","vc","addGroup","input","prevLength","buildGeometryData","addAttribute","Float32BufferAttribute","pushVector","sourceStride","sourceArray","c","k","kl","getGeometry","buildKinematicsModel","parseKinematicsTechniqueCommon","parseKinematicsJoint","links","parseKinematicsLink","parseKinematicsJointParameter","axis","limits","min","static","zeroPosition","middlePosition","attachments","parseKinematicsAttachment","parseKinematicsTransform","joint","pop","obj","angle","MathUtils","degToRad","parsePhysicsRigidBody","parsePhysicsTechniqueCommon","inertia","mass","parseKinematicsBindJointAxis","param","tmpJointIndex","jointIndex","substr","buildKinematicsScene","buildTransformList","collada","querySelector","vector","parseNode","instanceCameras","instanceControllers","instanceLights","instanceGeometries","instanceNodes","parseNodeInstance","multiply","makeTranslation","makeRotationAxis","log","hasNode","skeletons","instances","instance","symbol","buildSkeleton","boneData","sortedBoneData","skeleton","buildBoneHierarchy","visualScenes","children","error","bone","processed","bones","boneInverses","Skeleton","traverse","isBone","buildNode","objects","instanceCamera","controller","controllers","newObjects","buildObjects","isSkinnedMesh","bind","normalizeSkinWeights","instanceLight","Bone","Group","add","fallbackMaterial","resolveMaterialBinding","instanceMaterials","LineBasicMaterial","skinning","attributes","LineSegments","Line","SkinnedMesh","Mesh","buildVisualScene","group","getVisualScene","scene","Scene","DOMParser","parseFromString","version","asset","unit","upAxis","TextureLoader","TGALoader","kinematics","kinematicsModels","physicsModels","kinematicsScenes","mesh","element","setAttribute","prepareNodes","rigidBodies","bindJointAxis","setupAnimations","kinematicsModelId","kinematicsSceneId","visualSceneId","kinematicsModel","kinematicsScene","getKinematicsScene","visualScene","jointMap","targetElement","parentVisualElement","parentElement","connect","m0","getJointValue","jointData","setJointValue","visualElement","visualElementName","setupKinematics","parseScene","setFromEuler","Euler","PI","multiplyScalar","assign","FACE_1","FACE_2","FACE_3","FACE_4","L_SHOULDER_1","R_SHOULDER_1","L_SHOULDER_2","R_SHOULDER_2","SELECT","START","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT","VENDOR","details","pressed","removeScript","script","document","getElementById","parent","parentNode","removeChild","e","settings","Promise","resolve","reject","timeout","scriptId","Date","now","ceil","random","createElement","async","src","createScript","timeoutId","setTimeout","Error","disableTimeout","clearTimeout","addEventListener","ok","firstScript","insertBefore","appendScript","fetchScriptInternal","global","nativeKeyboardEvent","KeyboardEvent","TypeError","DOM_KEY_LOCATION_STANDARD","DOM_KEY_LOCATION_LEFT","DOM_KEY_LOCATION_RIGHT","DOM_KEY_LOCATION_NUMPAD","STANDARD","window","LEFT","RIGHT","NUMPAD","contains","s","ss","String","os","navigator","platform","userAgent","browser","vendor","browser_os","mergeIf","baseTable","select","table","forEach","keyCode","keyCodeToInfoTable","code","keyCap","location","keyIdentifierTable","locationTable","codeToKeyTable","ShiftLeft","ShiftRight","ControlLeft","ControlRight","AltLeft","AltRight","OSLeft","OSRight","NumpadEnter","Space","Digit0","shiftKey","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","NumpadMultiply","NumpadAdd","NumpadComma","NumpadSubtract","NumpadDecimal","NumpadDivide","Semicolon","Equal","Comma","Minus","Period","Slash","Backquote","BracketLeft","Backslash","BracketRight","Quote","IntlBackslash","o","r","keyFixTable","Esc","Nonconvert","Left","Up","Right","Down","Del","Menu","MediaNextTrack","MediaPreviousTrack","SelectMedia","HalfWidth","FullWidth","RomanCharacters","Crsel","Exsel","Zoom","codeTable","item","nativeLocation","_","keyInfoForEvent","event","which","keyInfo","keyLocation","keyIdentifier","entry","defineProperty","get","desc","getOwnPropertyDescriptor","call","queryKeyCap","locale","identifyKey","t","n","m","enumerable","Symbol","toStringTag","__esModule","create","default","Map","has","attachEvent","removeEventListener","detachEvent","preventDefault","match","changedTouches","h","pageXOffset","documentElement","body","scrollLeft","pageYOffset","scrollTop","u","top","right","bottom","left","style","charAt","PointerEvent","MSPointerEvent","O","move","on","_handlers_","off","splice","trigger","config","defaults","bindEvt","_domHandlers_","apply","arguments","unbindEvt","T","identifier","frontPosition","collection","size","threshold","fadeTime","dataOnly","restJoystick","restOpacity","mode","zone","lockX","lockY","shape","buildEl","stylize","el","ui","show","hide","addToDom","remove","removeFromDom","destroy","setPosition","resetDirection","computeDirection","back","front","className","appendChild","display","zIndex","width","height","marginLeft","marginTop","background","applyStyles","removeTimeout","showTimeout","restTimeout","restCallback","direction","radian","force","P","E","nipples","idles","actives","ids","pressureIntervals","multitouch","maxNumberOfNipples","catchDistance","dynamicPage","follow","getComputedStyle","parentIsFlex","updateBox","prepareNipples","bindings","begin","processOnMove","processOnEnd","touchAction","msTouchAction","createNipple","getIdentifier","scroll","box","getBoundingClientRect","bindNipple","onDestroyed","pressureFn","clearInterval","setInterval","pressure","webkitForce","onstart","processOnStart","values","touches","findIndex","bindDocument","pageX","pageY","getOrCreate","removeIdentifier","test","isNaN","buttons","atan2","cos","sin","I","D","degree","raw","unbindDocument","collections","prepareCollections","every","createCollection","bindCollection","binded","pointerId","latest","onmove","onAny","onend","oncancel","_found_","roundNumber","pow","round","sample","floor","distanceToSquared","isPointInPoly","isVectorInPolygon","vertexIds","triarea2","vequal","mergeVertices","Number","EPSILON","getIndex","log10","getX","getY","getZ","Float32Array","itemSize","normalized","setIndex","content","scoreFunction","sinkDown","bubbleUp","rescoreElement","portals","stringPull","zones","createZone","buildZone","_buildNavigationMesh","_buildPolygonGroups","groups","neighbours","_getSharedVerticesInOrder","divideScalar","centroid","_buildPolygonsFromGeometry","_spreadGroupId","Set","polygons","_buildPolygonNeighbours","includes","fromBufferAttribute","from","setZoneData","getRandomNode","getClosestNode","Infinity","findPath","init","cost","visited","closed","cleanUp","heap","search","reverse","heuristic","getGroup","setFromCoplanarPoints","abs","distanceToPoint","clampStep","projectPoint","closestPointToPoint","PLAYER","convertSRGBToLinear","getHex","TARGET","PATH","WAYPOINT","CLAMPED_STEP","CLOSEST_NODE","super","_playerMarker","_targetMarker","_nodeMarker","_stepMarker","_pathMarker","_pathLineMaterial","linewidth","_pathPointMaterial","_pathPointGeometry","_markers","visible","concat","setXYZ","setPlayerPosition","setTargetPosition","setNodePosition","setStepPosition","reset","AFRAME","registerComponent","schema","enabled","oneOf","animateSpeed","active","checkpoint","isNavMeshConstrained","targetPosition","play","pause","setCheckpoint","emit","sync","distanceTo","components","updateNavLocation","isVelocityActive","getVelocity","setLength","getWorldPosition","getOffset","sub","GamepadButton","GamepadButtonEvent","JOYSTICK_EPS","Hand","rotationSensitivity","sceneEl","system","systems","prevTime","performance","rotation","pitch","Object3D","yaw","_lookVector","Vector2","_moveVector","_dpadVector","addBehavior","update","tick","dt","updateButtonState","updateRotation","isConnected","dpad","joystick","getDpad","getJoystick","inputX","inputY","getVelocityDelta","dVelocity","isRotationActive","lookVector","gamepad","getGamepad","_xrGamepads","_empty","handPreference","proxyControls","proxyGamepad","xrController","xrGamepad","handedness","navGamepads","getGamepads","navGamepad","hand","getButton","getAxis","axes","mapping","connected","getID","debug","localKeys","listeners","keydown","onKeyDown","keyup","onKeyUp","blur","onBlur","onContextMenu","getKeys","ArrowUp","ArrowLeft","ArrowDown","ArrowRight","attachEventListeners","removeEventListeners","utils","shouldCaptureKeyEvent","isPressed","isProxied","getKeyboard","COMPONENT_SUFFIX","dependencies","controls","speed","fly","constrainToNavMesh","velocityCtrl","velocity","heading","eventDetail","navGroup","navNode","hasLoaded","injectControls","prevData","nav","addAgent","removeAgent","clampedEnd","updateVelocityCtrl","updateVelocity","lengthSq","control","vector2","getPositionDelta","cameraEl","premultiply","applyQuaternion","factor","moveJoystickEnabled","lookJoystickEnabled","sideMargin","bottomMargin","moveJoystickPosition","lookJoystickPosition","lookControls","pitchObject","yawObject","rigRotation","moveData","lookData","moving","rotating","oldData","removeMoveJoystick","removeLookJoystick","createMoveJoystick","createLookJoystick","initLeftZone","leftZone","initRightZone","rightZone","moveJoystick","evt","lookJoystick","reverseEnabled","bindMethods","addEventListeners","canvasEl","canvas","onTouchStart","onTouchEnd","vrModeUI","cardboardModeEnabled","onEnterVR","xrSession","enableNegX","enablePosX","enableNegZ","enablePosZ","zVel","xVel","onAxisMove","isMoving","canRecordAxis","startingAxisData","handleSwipeAxis","handleTouchAxis","axisData","detail","velX","velZ","absChangeZ","LoopMode","once","LoopOnce","LoopRepeat","pingpong","LoopPingPong","regExpEscape","clip","useRegExp","clampWhenFinished","crossFadeDuration","loop","repetitions","timeScale","startAt","model","mixer","activeActions","getObject3D","AnimationMixer","action","loopDelta","stopAllAction","changes","diff","stopAction","playAction","setDuration","setLoop","setEffectiveTimeScale","fadeOut","stop","re","RegExp","join","clipAction","fadeIn","Component","rendererSystem","renderer","colladaModel","isMesh","applyColorCorrection","setObject3D","format","removeObject3D","durl","URL","createObjectURL","Blob","revokeObjectURL","encodeURI","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","_a","fl","revfl","_b","fd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","bits","bits16","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","pos","bt","lm","dm","lbt","dbt","tbts","subarray","flrm","fdrm","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","lms","dms","lpos","sym","dsym","slc","et","td","TextDecoder","decode","stream","findSpan","U","low","high","mid","calcKoverI","nom","denom","NURBSCurve","Curve","knots","controlPoints","startKnot","endKnot","point","Vector4","getPoint","optionalTarget","hpoint","span","N","saved","rv","lv","temp","calcBasisFunctions","C","Nj","wNj","getTangent","tangent","ders","nd","Pders","du","CK","nders","zeroArr","ndu","s1","s2","rk","pk","j2","calcBasisFunctionDerivatives","Pw","calcBSplineDerivatives","Aders","wders","calcRationalCurveDerivatives","normalize","fbxTree","connections","sceneGraph","FBXLoader","Loader","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","buffer","itemError","FBXBuffer","CORRECT","byteLength","convertArrayBufferToString","isFbxFormatBinary","BinaryParser","FBXText","cursor","read","result","isFbxFormatASCII","getFbxVersion","TextParser","FBXTreeParser","parseConnections","parseImages","textures","parseTextures","parseMaterials","deformers","parseDeformers","geometryMap","GeometryParser","connectionMap","Connections","rawConnection","fromID","toID","relationship","parents","parentRelationship","ID","childRelationship","blobs","Objects","videoNodes","Video","nodeID","videoNode","RelativeFilename","Filename","arrayBufferContent","Content","ArrayBuffer","base64Content","parseImage","filename","fileName","getHandler","textureMap","textureNodes","Texture","parseTexture","textureNode","loadTexture","attrName","wrapModeU","WrapModeU","wrapModeV","WrapModeV","valueU","valueV","Scaling","Translation","currentPath","FileName","materialMap","materialNodes","Material","parseMaterial","materialNode","ShadingModel","parseParameters","setValues","BumpFactor","bumpScale","Diffuse","DiffuseColor","DisplacementFactor","displacementScale","Emissive","EmissiveColor","EmissiveFactor","emissiveIntensity","Opacity","ReflectionFactor","reflectivity","Shininess","Specular","SpecularColor","bumpMap","aoMap","colorSpace","SRGBColorSpace","displacementMap","envMap","EquirectangularReflectionMapping","alphaMap","LayeredTexture","morphTargets","DeformerNodes","Deformer","deformerNode","relationships","attrType","parseSkeleton","geometryID","morphTarget","rawTargets","parseMorphTargets","deformerNodes","rawBones","boneNode","rawBone","transformLink","TransformLink","Indexes","Weights","rawMorphTargets","morphTargetNode","rawMorphTarget","initialWeight","DeformPercent","fullWeights","FullWeights","geoID","filter","modelMap","parseModels","modelNodes","Model","modelNode","setLookAtProperties","connection","bindSkeleton","addGlobalSceneSettings","userData","transformData","parentMatrix","parentMatrixWorld","matrixWorld","generateTransform","applyMatrix4","updateWorldMatrix","AnimationParser","isGroup","createCamera","createLight","createMesh","createCurve","PropertyBinding","sanitizeNodeName","originalName","getTransformData","subBone","cameraAttribute","attr","NodeAttribute","CameraProjectionType","nearClippingPlane","NearPlane","farClippingPlane","FarPlane","innerWidth","innerHeight","AspectWidth","AspectHeight","aspect","fov","FieldOfView","focalLength","FocalLength","setFocalLength","lightAttribute","LightType","intensity","Intensity","CastLightOnObject","FarAttenuationEnd","EnableFarAttenuation","decay","InnerAngle","penumbra","OuterAngle","CastShadows","castShadow","DEFAULT_MATERIAL_NAME","vertexColors","FBX_Deformer","reduce","geo","inheritType","InheritType","eulerOrder","getEulerOrder","RotationOrder","translation","Lcl_Translation","preRotation","PreRotation","Lcl_Rotation","postRotation","PostRotation","Lcl_Scaling","scalingOffset","ScalingOffset","scalingPivot","ScalingPivot","rotationOffset","RotationOffset","rotationPivot","RotationPivot","lookAtTarget","lookAt","bindMatrices","parsePoseNodes","geoConnParent","BindPoseNode","Pose","NbPoseNodes","poseNodes","PoseNode","isArray","poseNode","Node","Matrix","GlobalSettings","ambientColor","AmbientColor","unitScaleFactor","UnitScaleFactor","negativeMaterialIndices","geoNodes","Geometry","parseGeometry","geoNode","parseMeshGeometry","parseNurbsGeometry","GeometricTranslation","GeometricRotation","GeometricScaling","genGeometry","preTransform","geoInfo","parseGeoNode","buffers","genBuffers","positionAttribute","vertex","colors","Uint16BufferAttribute","weightsIndices","normalMatrix","Matrix3","getNormalMatrix","normalAttribute","applyNormalMatrix","uvs","uvBuffer","mappingType","prevMaterialIndex","materialIndex","startIndex","currentIndex","lastGroup","lastIndex","addMorphTargets","vertexPositions","Vertices","vertexIndices","PolygonVertexIndex","LayerElementColor","parseVertexColors","LayerElementMaterial","parseMaterialIndices","LayerElementNormal","parseNormals","LayerElementUV","UV","parseUVs","weightTable","polygonIndex","faceLength","displayedWeightsWarning","facePositionIndexes","faceNormals","faceColors","faceUVs","faceWeights","faceWeightIndices","vertexIndex","polygonVertexIndex","endOfFace","weightIndices","getData","wt","wIndex","Weight","weightIndex","currentWeight","comparedWeight","comparedWeightIndex","comparedWeightArray","tmp","genFace","getNormalNewell","current","getNormalTangentAndBitangent","normalVector","cross","bitangent","flattenVertex","normalTangent","normalBitangent","dot","triangles","triangulationInput","ShapeUtils","triangulateShape","i0","i1","i2","parentGeo","parentGeoNode","morphTargetsRelative","morphAttributes","rawTarget","morphGeoNode","genMorphGeometry","morphPositionsSparse","morphPositions","morphIndex","morphGeoInfo","morphBuffers","NormalNode","MappingInformationType","referenceType","ReferenceInformationType","Normals","indexBuffer","NormalIndex","NormalsIndex","dataSize","UVNode","UVIndex","ColorNode","Colors","ColorIndex","toArray","MaterialNode","materialIndexBuffer","Materials","materialIndices","order","Order","KnotVector","pointsValues","Points","Form","points","getPoints","setFromPoints","animationClips","rawClips","parseClips","rawClip","addClip","AnimationCurve","curveNodesMap","parseAnimationCurveNodes","parseAnimationCurves","layersMap","parseAnimationLayers","parseAnimStacks","rawCurveNodes","AnimationCurveNode","rawCurveNode","curveNode","curves","rawCurves","animationCurve","KeyTime","convertFBXTimeToSeconds","KeyValueFloat","animationCurveID","animationCurveRelationship","rawLayers","AnimationLayer","layerCurveNodes","modelID","rawModel","toString","modelName","initialPosition","initialRotation","initialScale","morph","deformerID","morpherID","morphName","rawStacks","AnimationStack","layer","rawTracks","generateTracks","positionTrack","generateVectorTrack","R","rotationTrack","generateRotationTrack","S","scaleTrack","morphTrack","generateMorphTrack","initialValue","getTimesForAllAxes","getKeyframeTrackValues","interpolateRotations","invert","euler","quaternionValues","val","morphNum","getObjectByName","morphTargetDictionary","NumberKeyframeTrack","targetIndex","lastValue","currentValue","prevValue","xIndex","yIndex","xValue","yValue","zValue","curvex","curvey","curvez","initialValueRad","currentValueRad","valuesSpan","absoluteSpan","numSubIntervals","E1","E2","Q1","Q2","initialTime","timeSpan","Q","slerp","setFromQuaternion","getPrevNode","nodeStack","currentIndent","getCurrentNode","getCurrentProp","currentProp","pushStack","popStack","setCurrentProp","currentPropName","allNodes","FBXTree","line","matchComment","matchEmpty","matchBeginning","matchProperty","matchEnd","parseNodeBegin","parseNodeProperty","parseNodePropertyContinued","nodeAttrs","attrs","parseNodeAttr","currentNode","contentLine","propName","propValue","connProps","to","rest","elem","append","parseNumberArray","parseNodeSpecialProperty","props","prop","innerPropName","innerPropType1","innerPropType2","innerPropFlag","innerPropValue","reader","BinaryReader","skip","getUint32","endOfContent","endOffset","getUint64","numProperties","nameLen","getUint8","getString","propertyList","parseProperty","singleProperty","subNode","parseSubNode","getBoolean","getFloat64","getFloat32","getInt32","getInt64","getArrayBuffer","getInt16","arrayLength","encoding","compressedLength","getBooleanArray","getFloat64Array","getFloat32Array","getInt32Array","getInt64Array","out","zlv","reader2","littleEndian","dv","DataView","_textDecoder","nullByte","dataArray","infoObject","tempEuler","tempVec","lTranslationM","lPreRotationM","lRotationM","lPostRotationM","lScalingM","lScalingPivotM","lScalingOffsetM","lRotationOffsetM","lRotationPivotM","lParentGX","lParentLX","lGlobalT","DEFAULT_ORDER","makeRotationFromEuler","lLRM","lParentGRM","extractRotation","lParentTM","copyPosition","lParentGRSM","lParentGSM","lLSM","lGlobalRS","lParentLSM_inv","setFromMatrixScale","lParentGSM_noLocal","lRotationPivotM_inv","lScalingPivotM_inv","lTransform","lLocalTWithAllPivotAndOffsetInfo","lGlobalTranslation","enums","crossorigin","fetchScript","loadLoader","promise","loaderPromise","then","GLTFLoader","gltfModel","ObjectLoader","targetEl","fire","applyEnvMap","materialNames","needsUpdate","multiple","enableBackground","CubeTextureLoader","RGBAFormat","object3dsetHandler","addedMaterialNames","removedMaterialNames","maintainedMaterialNames","setBackground","physics","GRABBED_STATE","grabbing","hitEl","constraint","onHit","onGripOpen","onGripClose","removeState","removeConstraint","is","addState","CANNON","LockConstraint","addConstraint","MeshNormalMaterial","flatShading","applyMaterial","interval","state","radius","watch","observer","els","collisions","prevCheckTime","handleHit","handleHitEnd","MutationObserver","observe","childList","subtree","disconnect","objectEls","querySelectorAll","meshPosition","colliderScale","Box3","distanceMap","colliderRadius","scaleVec","clear","getWorldScale","extent","isEntity","setFromObject","getSize","getCenter","dest","copyArray","destination","raycaster","Raycaster","vDest","vDelta","vNext","getPath","vCurrent","vWaypoint","gazeTarget","subVectors","ray","origin","intersections","intersectObject","getNavMesh","hasLoadedNavMesh","loadNavMesh","navMesh","navMeshGeometry","setNavMeshGeometry","Pathfinding","pathfinder","ZONE","registerSystem","agents","agent","ctrl","delete","groupID","endTarget","registerPrimitive","defaultComponents","mappings","Primitive","ocean","depth","density","amplitude","amplitudeVariance","speedVariance","PlaneGeometry","waves","posAttribute","ang","amp","vprops","setZ","tube","segments","radialSegments","curve","CatmullRomCurve3","TubeGeometry","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","definition"],"sourceRoot":""}