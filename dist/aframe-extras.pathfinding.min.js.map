{"version":3,"file":"aframe-extras.pathfinding.min.js","mappings":"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","sources":["webpack://aframe-extras/webpack/universalModuleDefinition","webpack://aframe-extras/external umd \"THREE\"","webpack://aframe-extras/./src/pathfinding/nav-mesh.js","webpack://aframe-extras/./src/pathfinding/nav-agent.js","webpack://aframe-extras/webpack/bootstrap","webpack://aframe-extras/./node_modules/three-pathfinding/dist/three-pathfinding.module.js","webpack://aframe-extras/./src/pathfinding/system.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"THREE\")) : factory(root[\"THREE\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__612__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__612__;","/**\n * nav-mesh\n *\n * Waits for a mesh to be loaded on the current entity, then sets it as the\n * nav mesh in the pathfinding system.\n */\nAFRAME.registerComponent('nav-mesh', {\n  schema: {\n    nodeName: {type: 'string'}\n  },\n\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.hasLoadedNavMesh = false;\n    this.nodeName = this.data.nodeName;\n    this.el.addEventListener('object3dset', this.loadNavMesh.bind(this));\n  },\n\n  play: function () {\n    if (!this.hasLoadedNavMesh) this.loadNavMesh();\n  },\n\n  loadNavMesh: function () {\n    var self = this;\n    const object = this.el.getObject3D('mesh');\n    const scene = this.el.sceneEl.object3D;\n\n    if (!object) return;\n\n    let navMesh;\n    object.traverse((node) => {\n      if (node.isMesh &&\n          (!self.nodeName || node.name === self.nodeName)) navMesh = node;\n    });\n\n    if (!navMesh) return;\n\n    const navMeshGeometry = navMesh.geometry.clone();\n    navMesh.updateWorldMatrix(true, false);\n    navMeshGeometry.applyMatrix4(navMesh.matrixWorld);\n    this.system.setNavMeshGeometry(navMeshGeometry);\n    this.hasLoadedNavMesh = true;\n  }\n});\n","AFRAME.registerComponent('nav-agent', {\n  schema: {\n    destination: {type: 'vec3'},\n    active: {default: false},\n    speed: {default: 2}\n  },\n  init: function () {\n    this.system = this.el.sceneEl.systems.nav;\n    this.system.addAgent(this);\n    this.group = null;\n    this.path = [];\n    this.raycaster = new THREE.Raycaster();\n  },\n  remove: function () {\n    this.system.removeAgent(this);\n  },\n  update: function () {\n    this.path.length = 0;\n  },\n  updateNavLocation: function () {\n    this.group = null;\n    this.path = [];\n  },\n  tick: (function () {\n    const vDest = new THREE.Vector3();\n    const vDelta = new THREE.Vector3();\n    const vNext = new THREE.Vector3();\n\n    return function (t, dt) {\n      const el = this.el;\n      const data = this.data;\n      const raycaster = this.raycaster;\n      const speed = data.speed * dt / 1000;\n\n      if (!data.active) return;\n\n      // Use PatrolJS pathfinding system to get shortest path to target.\n      if (!this.path.length) {\n        const position = this.el.object3D.position;\n        this.group = this.group || this.system.getGroup(position);\n        this.path = this.system.getPath(position, vDest.copy(data.destination), this.group) || [];\n        el.emit('navigation-start');\n      }\n\n      // If no path is found, exit.\n      if (!this.path.length) {\n        console.warn('[nav] Unable to find path to %o.', data.destination);\n        this.el.setAttribute('nav-agent', {active: false});\n        el.emit('navigation-end');\n        return;\n      }\n\n      // Current segment is a vector from current position to next waypoint.\n      const vCurrent = el.object3D.position;\n      const vWaypoint = this.path[0];\n      vDelta.subVectors(vWaypoint, vCurrent);\n\n      const distance = vDelta.length();\n      let gazeTarget;\n\n      if (distance < speed) {\n        // If <1 step from current waypoint, discard it and move toward next.\n        this.path.shift();\n\n        // After discarding the last waypoint, exit pathfinding.\n        if (!this.path.length) {\n          this.el.setAttribute('nav-agent', {active: false});\n          el.emit('navigation-end');\n          return;\n        }\n\n        vNext.copy(vCurrent);\n        gazeTarget = this.path[0];\n      } else {\n        // If still far away from next waypoint, find next position for\n        // the current frame.\n        vNext.copy(vDelta.setLength(speed)).add(vCurrent);\n        gazeTarget = vWaypoint;\n      }\n\n      // Look at the next waypoint.\n      gazeTarget.y = vCurrent.y;\n      el.object3D.lookAt(gazeTarget);\n\n      // Raycast against the nav mesh, to keep the agent moving along the\n      // ground, not traveling in a straight line from higher to lower waypoints.\n      raycaster.ray.origin.copy(vNext);\n      raycaster.ray.origin.y += 1.5;\n      raycaster.ray.direction = {x:0, y:-1, z:0};\n      const intersections = raycaster.intersectObject(this.system.getNavMesh());\n\n      if (!intersections.length) {\n        // Raycasting failed. Step toward the waypoint and hope for the best.\n        vCurrent.copy(vNext);\n      } else {\n        // Re-project next position onto nav mesh.\n        vDelta.subVectors(intersections[0].point, vCurrent);\n        vCurrent.add(vDelta.setLength(speed));\n      }\n\n    };\n  }())\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import{BufferAttribute as t,BufferGeometry as e,Vector3 as s,Plane as r,Triangle as n,Object3D as o,Mesh as i,SphereGeometry as h,MeshBasicMaterial as c,BoxGeometry as a,LineBasicMaterial as u,Line as l}from\"three\";class d{static roundNumber(t,e){const s=Math.pow(10,e);return Math.round(t*s)/s}static sample(t){return t[Math.floor(Math.random()*t.length)]}static distanceToSquared(t,e){var s=t.x-e.x,r=t.y-e.y,n=t.z-e.z;return s*s+r*r+n*n}static isPointInPoly(t,e){for(var s=!1,r=-1,n=t.length,o=n-1;++r<n;o=r)(t[r].z<=e.z&&e.z<t[o].z||t[o].z<=e.z&&e.z<t[r].z)&&e.x<(t[o].x-t[r].x)*(e.z-t[r].z)/(t[o].z-t[r].z)+t[r].x&&(s=!s);return s}static isVectorInPolygon(t,e,s){var r=1e5,n=-1e5,o=[];return e.vertexIds.forEach(t=>{r=Math.min(s[t].y,r),n=Math.max(s[t].y,n),o.push(s[t])}),!!(t.y<n+.5&&t.y>r-.5&&this.isPointInPoly(o,t))}static triarea2(t,e,s){return(s.x-t.x)*(e.z-t.z)-(e.x-t.x)*(s.z-t.z)}static vequal(t,e){return this.distanceToSquared(t,e)<1e-5}static mergeVertices(s,r=1e-4){r=Math.max(r,Number.EPSILON);for(var n={},o=s.getIndex(),i=s.getAttribute(\"position\"),h=o?o.count:i.count,c=0,a=[],u=[],l=Math.log10(1/r),d=Math.pow(10,l),p=0;p<h;p++){var g=o?o.getX(p):p,f=\"\";f+=~~(i.getX(g)*d)+\",\",f+=~~(i.getY(g)*d)+\",\",(f+=~~(i.getZ(g)*d)+\",\")in n?a.push(n[f]):(u.push(i.getX(g)),u.push(i.getY(g)),u.push(i.getZ(g)),n[f]=c,a.push(c),c++)}const v=new t(new Float32Array(u),i.itemSize,i.normalized),b=new e;return b.setAttribute(\"position\",v),b.setIndex(a),b}}class p{constructor(t){this.content=[],this.scoreFunction=t}push(t){this.content.push(t),this.sinkDown(this.content.length-1)}pop(){const t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t}remove(t){const e=this.content.indexOf(t),s=this.content.pop();e!==this.content.length-1&&(this.content[e]=s,this.scoreFunction(s)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))}size(){return this.content.length}rescoreElement(t){this.sinkDown(this.content.indexOf(t))}sinkDown(t){const e=this.content[t];for(;t>0;){const s=(t+1>>1)-1,r=this.content[s];if(!(this.scoreFunction(e)<this.scoreFunction(r)))break;this.content[s]=e,this.content[t]=r,t=s}}bubbleUp(t){const e=this.content.length,s=this.content[t],r=this.scoreFunction(s);for(;;){const n=t+1<<1,o=n-1;let i,h=null;if(o<e&&(i=this.scoreFunction(this.content[o]),i<r&&(h=o)),n<e&&this.scoreFunction(this.content[n])<(null===h?r:i)&&(h=n),null===h)break;this.content[t]=this.content[h],this.content[h]=s,t=h}}}class g{constructor(){this.portals=[]}push(t,e){void 0===e&&(e=t),this.portals.push({left:t,right:e})}stringPull(){const t=this.portals,e=[];let s,r,n,o=0,i=0,h=0;s=t[0].left,r=t[0].left,n=t[0].right,e.push(s);for(let c=1;c<t.length;c++){const a=t[c].left,u=t[c].right;if(d.triarea2(s,n,u)<=0){if(!(d.vequal(s,n)||d.triarea2(s,r,u)>0)){e.push(r),s=r,o=i,r=s,n=s,i=o,h=o,c=o;continue}n=u,h=c}if(d.triarea2(s,r,a)>=0){if(!(d.vequal(s,r)||d.triarea2(s,n,a)<0)){e.push(n),s=n,o=h,r=s,n=s,i=o,h=o,c=o;continue}r=a,i=c}}return 0!==e.length&&d.vequal(e[e.length-1],t[t.length-1].left)||e.push(t[t.length-1].left),this.path=e,e}}class f{constructor(){this.zones={}}static createZone(t,e=1e-4){return class{static buildZone(t,e){const r=this._buildNavigationMesh(t,e),n={};r.vertices.forEach(t=>{t.x=d.roundNumber(t.x,2),t.y=d.roundNumber(t.y,2),t.z=d.roundNumber(t.z,2)}),n.vertices=r.vertices;const o=this._buildPolygonGroups(r);return n.groups=new Array(o.length),o.forEach((t,e)=>{const r=new Map;t.forEach((t,e)=>{r.set(t,e)});const o=new Array(t.length);t.forEach((t,e)=>{const i=[];t.neighbours.forEach(t=>i.push(r.get(t)));const h=[];t.neighbours.forEach(e=>h.push(this._getSharedVerticesInOrder(t,e)));const c=new s(0,0,0);c.add(n.vertices[t.vertexIds[0]]),c.add(n.vertices[t.vertexIds[1]]),c.add(n.vertices[t.vertexIds[2]]),c.divideScalar(3),c.x=d.roundNumber(c.x,2),c.y=d.roundNumber(c.y,2),c.z=d.roundNumber(c.z,2),o[e]={id:e,neighbours:i,vertexIds:t.vertexIds,centroid:c,portals:h}}),n.groups[e]=o}),n}static _buildNavigationMesh(t,e){return t=d.mergeVertices(t,e),this._buildPolygonsFromGeometry(t)}static _spreadGroupId(t){let e=new Set([t]);for(;e.size>0;){const s=e;e=new Set,s.forEach(s=>{s.group=t.group,s.neighbours.forEach(t=>{void 0===t.group&&e.add(t)})})}}static _buildPolygonGroups(t){const e=[];return t.polygons.forEach(t=>{void 0!==t.group?e[t.group].push(t):(t.group=e.length,this._spreadGroupId(t),e.push([t]))}),e}static _buildPolygonNeighbours(t,e){const s=new Set,r=e[t.vertexIds[1]],n=e[t.vertexIds[2]];return e[t.vertexIds[0]].forEach(e=>{e!==t&&(r.includes(e)||n.includes(e))&&s.add(e)}),r.forEach(e=>{e!==t&&n.includes(e)&&s.add(e)}),s}static _buildPolygonsFromGeometry(t){const e=[],r=[],n=t.attributes.position,o=t.index,i=[];for(let t=0;t<n.count;t++)r.push((new s).fromBufferAttribute(n,t)),i[t]=[];for(let s=0;s<t.index.count;s+=3){const t=o.getX(s),r=o.getX(s+1),n=o.getX(s+2),h={vertexIds:[t,r,n],neighbours:null};e.push(h),i[t].push(h),i[r].push(h),i[n].push(h)}return e.forEach(t=>{t.neighbours=this._buildPolygonNeighbours(t,i)}),{polygons:e,vertices:r}}static _getSharedVerticesInOrder(t,e){const s=t.vertexIds,r=s[0],n=s[1],o=s[2],i=e.vertexIds,h=i.includes(r),c=i.includes(n),a=i.includes(o);return h&&c&&a?Array.from(s):h&&c?[r,n]:c&&a?[n,o]:h&&a?[o,r]:(console.warn(\"Error processing navigation mesh neighbors; neighbors with <2 shared vertices found.\"),[])}}.buildZone(t,e)}setZoneData(t,e){this.zones[t]=e}getRandomNode(t,e,r,n){if(!this.zones[t])return new s;r=r||null,n=n||0;const o=[];return this.zones[t].groups[e].forEach(t=>{r&&n?d.distanceToSquared(r,t.centroid)<n*n&&o.push(t.centroid):o.push(t.centroid)}),d.sample(o)||new s}getClosestNode(t,e,s,r=!1){const n=this.zones[e].vertices;let o=null,i=Infinity;return this.zones[e].groups[s].forEach(e=>{const s=d.distanceToSquared(e.centroid,t);s<i&&(!r||d.isVectorInPolygon(t,e,n))&&(o=e,i=s)}),o}findPath(t,e,r,n){const o=this.zones[r].groups[n],i=this.zones[r].vertices,h=this.getClosestNode(t,r,n,!0),c=this.getClosestNode(e,r,n,!0);if(!h||!c)return null;const a=class{static init(t){for(let e=0;e<t.length;e++){const s=t[e];s.f=0,s.g=0,s.h=0,s.cost=1,s.visited=!1,s.closed=!1,s.parent=null}}static cleanUp(t){for(let e=0;e<t.length;e++){const s=t[e];delete s.f,delete s.g,delete s.h,delete s.cost,delete s.visited,delete s.closed,delete s.parent}}static heap(){return new p(function(t){return t.f})}static search(t,e,s){this.init(t);const r=this.heap();for(r.push(e);r.size()>0;){const e=r.pop();if(e===s){let t=e;const s=[];for(;t.parent;)s.push(t),t=t.parent;return this.cleanUp(s),s.reverse()}e.closed=!0;const n=this.neighbours(t,e);for(let t=0,o=n.length;t<o;t++){const o=n[t];if(o.closed)continue;const i=e.g+o.cost,h=o.visited;if(!h||i<o.g){if(o.visited=!0,o.parent=e,!o.centroid||!s.centroid)throw new Error(\"Unexpected state\");o.h=o.h||this.heuristic(o.centroid,s.centroid),o.g=i,o.f=o.g+o.h,h?r.rescoreElement(o):r.push(o)}}}return[]}static heuristic(t,e){return d.distanceToSquared(t,e)}static neighbours(t,e){const s=[];for(let r=0;r<e.neighbours.length;r++)s.push(t[e.neighbours[r]]);return s}}.search(o,h,c),u=function(t,e){for(var s=0;s<t.neighbours.length;s++)if(t.neighbours[s]===e.id)return t.portals[s]},l=new g;l.push(t);for(let t=0;t<a.length;t++){const e=a[t],s=a[t+1];if(s){const t=u(e,s);l.push(i[t[0]],i[t[1]])}}l.push(e),l.stringPull();const f=l.path.map(t=>new s(t.x,t.y,t.z));return f.shift(),f}}f.prototype.getGroup=function(){const t=new r;return function(e,s,r=!1){if(!this.zones[e])return null;let n=null,o=Math.pow(50,2);const i=this.zones[e];for(let e=0;e<i.groups.length;e++){const h=i.groups[e];for(const c of h){if(r&&(t.setFromCoplanarPoints(i.vertices[c.vertexIds[0]],i.vertices[c.vertexIds[1]],i.vertices[c.vertexIds[2]]),Math.abs(t.distanceToPoint(s))<.01)&&d.isPointInPoly([i.vertices[c.vertexIds[0]],i.vertices[c.vertexIds[1]],i.vertices[c.vertexIds[2]]],s))return e;const h=d.distanceToSquared(c.centroid,s);h<o&&(n=e,o=h)}}return n}}(),f.prototype.clampStep=function(){const t=new s,e=new r,o=new n,i=new s;let h,c,a=new s;return function(s,r,n,u,l,d){const p=this.zones[u].vertices,g=this.zones[u].groups[l],f=[n],v={};v[n.id]=0,h=void 0,a.set(0,0,0),c=Infinity,e.setFromCoplanarPoints(p[n.vertexIds[0]],p[n.vertexIds[1]],p[n.vertexIds[2]]),e.projectPoint(r,t),i.copy(t);for(let e=f.pop();e;e=f.pop()){o.set(p[e.vertexIds[0]],p[e.vertexIds[1]],p[e.vertexIds[2]]),o.closestPointToPoint(i,t),t.distanceToSquared(i)<c&&(h=e,a.copy(t),c=t.distanceToSquared(i));const s=v[e.id];if(!(s>2))for(let t=0;t<e.neighbours.length;t++){const r=g[e.neighbours[t]];r.id in v||(f.push(r),v[r.id]=s+1)}}return d.copy(a),h}}();class v extends o{constructor(){super(),this._playerMarker=new i(new h(.25,32,32),new c({color:15631215})),this._targetMarker=new i(new a(.3,.3,.3),new c({color:14469912})),this._nodeMarker=new i(new a(.1,.8,.1),new c({color:4417387})),this._stepMarker=new i(new a(.1,1,.1),new c({color:14472114})),this._pathMarker=new o,this._pathLineMaterial=new u({color:41903,linewidth:2}),this._pathPointMaterial=new c({color:41903}),this._pathPointGeometry=new h(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(t=>{t.visible=!1,this.add(t)})}setPath(s){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);s=[this._playerMarker.position].concat(s);const r=new e;r.setAttribute(\"position\",new t(new Float32Array(3*s.length),3));for(let t=0;t<s.length;t++)r.attributes.position.setXYZ(t,s[t].x,s[t].y+.2,s[t].z);this._pathMarker.add(new l(r,this._pathLineMaterial));for(let t=0;t<s.length-1;t++){const e=new i(this._pathPointGeometry,this._pathPointMaterial);e.position.copy(s[t]),e.position.y+=.2,this._pathMarker.add(e)}return this._pathMarker.visible=!0,this}setPlayerPosition(t){return this._playerMarker.position.copy(t),this._playerMarker.visible=!0,this}setTargetPosition(t){return this._targetMarker.position.copy(t),this._targetMarker.visible=!0,this}setNodePosition(t){return this._nodeMarker.position.copy(t),this._nodeMarker.visible=!0,this}setStepPosition(t){return this._stepMarker.position.copy(t),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(t=>{t.visible=!1}),this}}export{f as Pathfinding,v as PathfindingHelper};\n//# sourceMappingURL=three-pathfinding.module.js.map\n","import { Pathfinding } from 'three-pathfinding';\n\nconst pathfinder = new Pathfinding();\nconst ZONE = 'level';\n\n/**\n * nav\n *\n * Pathfinding system, using PatrolJS.\n */\nAFRAME.registerSystem('nav', {\n  init: function () {\n    this.navMesh = null;\n    this.agents = new Set();\n  },\n\n  /**\n   * @param {THREE.Geometry} geometry\n   */\n  setNavMeshGeometry: function (geometry) {\n    this.navMesh = new THREE.Mesh(geometry);\n    pathfinder.setZoneData(ZONE, Pathfinding.createZone(geometry));\n    Array.from(this.agents).forEach((agent) => agent.updateNavLocation());\n  },\n\n  /**\n   * @return {THREE.Mesh}\n   */\n  getNavMesh: function () {\n    return this.navMesh;\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  addAgent: function (ctrl) {\n    this.agents.add(ctrl);\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  removeAgent: function (ctrl) {\n    this.agents.delete(ctrl);\n  },\n\n  /**\n   * @param  {THREE.Vector3} start\n   * @param  {THREE.Vector3} end\n   * @param  {number} groupID\n   * @return {Array<THREE.Vector3>}\n   */\n  getPath: function (start, end, groupID) {\n    return this.navMesh\n      ? pathfinder.findPath(start, end, ZONE, groupID)\n      : null;\n  },\n\n  /**\n   * @param {THREE.Vector3} position\n   * @return {number}\n   */\n  getGroup: function (position) {\n    return this.navMesh\n      ? pathfinder.getGroup(ZONE, position)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} position\n   * @param  {number} groupID\n   * @return {Node}\n   */\n  getNode: function (position, groupID) {\n    return this.navMesh\n      ? pathfinder.getClosestNode(position, ZONE, groupID, true)\n      : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} start Starting position.\n   * @param  {THREE.Vector3} end Desired ending position.\n   * @param  {number} groupID\n   * @param  {Node} node\n   * @param  {THREE.Vector3} endTarget (Output) Adjusted step end position.\n   * @return {Node} Current node, after step is taken.\n   */\n  clampStep: function (start, end, groupID, node, endTarget) {\n    if (!this.navMesh) {\n      endTarget.copy(end);\n      return null;\n    } else if (!node) {\n      endTarget.copy(end);\n      return this.getNode(end, groupID);\n    }\n    return pathfinder.clampStep(start, end, node, ZONE, groupID, endTarget);\n  }\n});\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__612__","AFRAME","registerComponent","schema","nodeName","type","init","this","system","el","sceneEl","systems","nav","hasLoadedNavMesh","data","addEventListener","loadNavMesh","bind","play","object","getObject3D","object3D","navMesh","traverse","node","isMesh","name","navMeshGeometry","geometry","clone","updateWorldMatrix","applyMatrix4","matrixWorld","setNavMeshGeometry","destination","active","default","speed","addAgent","group","path","raycaster","THREE","Raycaster","remove","removeAgent","update","length","updateNavLocation","tick","vDest","Vector3","vDelta","vNext","t","dt","position","getGroup","getPath","copy","emit","console","warn","setAttribute","vCurrent","vWaypoint","gazeTarget","subVectors","shift","setLength","add","y","lookAt","ray","origin","direction","x","z","intersections","intersectObject","getNavMesh","point","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","roundNumber","e","s","Math","pow","round","sample","floor","random","distanceToSquared","r","n","isPointInPoly","o","isVectorInPolygon","vertexIds","forEach","min","max","push","triarea2","vequal","mergeVertices","Number","EPSILON","getIndex","getAttribute","h","count","c","u","l","log10","p","g","getX","f","getY","getZ","v","Float32Array","itemSize","normalized","b","setIndex","constructor","content","scoreFunction","sinkDown","pop","bubbleUp","indexOf","size","rescoreElement","portals","left","right","stringPull","zones","createZone","buildZone","_buildNavigationMesh","vertices","_buildPolygonGroups","groups","Array","Map","set","neighbours","get","_getSharedVerticesInOrder","divideScalar","id","centroid","_buildPolygonsFromGeometry","_spreadGroupId","Set","polygons","_buildPolygonNeighbours","includes","attributes","index","fromBufferAttribute","from","setZoneData","getRandomNode","getClosestNode","Infinity","findPath","cost","visited","closed","parent","cleanUp","heap","search","reverse","Error","heuristic","map","prototype","setFromCoplanarPoints","abs","distanceToPoint","clampStep","projectPoint","closestPointToPoint","pathfinder","ZONE","registerSystem","agents","Mesh","agent","ctrl","delete","start","end","groupID","getNode","endTarget"],"sourceRoot":""}